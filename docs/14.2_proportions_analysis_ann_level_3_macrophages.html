<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jovana Maksimovic" />

<meta name="date" content="2024-09-10" />

<title>Inflammation of Paediatric Pulmonary Diseases</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">paed-inflammation-CITEseq</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Inflammation of Paediatric Pulmonary
Diseases</h1>
<h3 class="subtitle">Cell type proportions analysis - macrophage
labels</h3>
<h4 class="author">Jovana Maksimovic</h4>
<h4 class="date">September 10, 2024</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-09-10
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>paed-inflammation-CITEseq/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20240216code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20240216)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20240216code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20240216)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsatlassianpetermacorgaubitbucketscmospaedinflammationciteseqtree5b48b0e9fb52320947a237341286681079478484targetblank5b48b0ea">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/tree/5b48b0e9fb52320947a237341286681079478484" target="_blank">5b48b0e</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsatlassianpetermacorgaubitbucketscmospaedinflammationciteseqtree5b48b0e9fb52320947a237341286681079478484targetblank5b48b0ea"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/tree/5b48b0e9fb52320947a237341286681079478484" target="_blank">5b48b0e</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/figure/
    Ignored:    data/C133_Neeland_batch1/
    Ignored:    data/C133_Neeland_merged/
    Ignored:    renv/library/
    Ignored:    renv/staging/

Untracked files:
    Untracked:  analysis/13.0_DGE_analysis_macro-alveolar_cells_CF-only-samples_OLD.Rmd
    Untracked:  analysis/13.1_DGE_analysis_macro-alveolar_cells_CF-vs-control-samples_OLD.Rmd
    Untracked:  analysis/13.3_DGE_analysis_macro-monocyte-derived_CF-only-samples_OLD.Rmd
    Untracked:  analysis/13.4_DGE_analysis_macro-monocyte-derived_CF-vs-control-samples_OLD.Rmd
    Untracked:  analysis/15.0_integrate_all_cells.Rmd

Unstaged changes:
    Modified:   analysis/09.0_integrate_cluster_macro_cells.Rmd
    Modified:   analysis/11.0_manual_annotations_t_cells_decontx.Rmd
    Modified:   analysis/12.0_manual_annotations_other_cells.Rmd
    Deleted:    analysis/14.0_proportions_analysis_broad.Rmd
    Deleted:    analysis/14.1_proportions_analysis_fine.Rmd
    Deleted:    analysis/14.2_proportions_analysis_macrophages.Rmd
    Modified:   data/cluster_annotations/T-NK_ambientRNAremoval_21.03.24.xlsx
    Modified:   data/cluster_annotations/others_ambientRNAremoval_21.03.24.xlsx
    Modified:   data/cluster_annotations/seurat_markers_TNK_cells.rds
    Modified:   data/cluster_annotations/seurat_markers_other_cells.rds

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/14.2_proportions_analysis_ann_level_3_macrophages.Rmd</code>)
and HTML
(<code>docs/14.2_proportions_analysis_ann_level_3_macrophages.html</code>)
files. If you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/5b48b0e9fb52320947a237341286681079478484/analysis/14.2_proportions_analysis_ann_level_3_macrophages.Rmd" target="_blank">5b48b0e</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-09-10
</td>
<td>
wflow_publish("analysis/14.2_proportions_analysis_ann_level_3_macrophages.Rmd")
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="load-libraries" class="section level1">
<h1>Load libraries</h1>
<pre class="r"><code>suppressPackageStartupMessages({
  library(SingleCellExperiment)
  library(edgeR)
  library(tidyverse)
  library(ggplot2)
  library(Seurat)
  library(glmGamPoi)
  library(dittoSeq)
  library(clustree)
  library(AnnotationDbi)
  library(org.Hs.eg.db)
  library(glue)
  library(speckle)
  library(patchwork)
  library(paletteer)
  library(tidyHeatmap)
  library(here)
})

set.seed(42)
options(scipen=999)
options(future.globals.maxSize = 6500 * 1024^2)</code></pre>
</div>
<div id="load-data" class="section level1">
<h1>Load Data</h1>
<pre class="r"><code>file &lt;- here(&quot;data&quot;,
            &quot;C133_Neeland_merged&quot;,
            glue(&quot;C133_Neeland_full_clean_macrophages_annotated_diet.SEU.rds&quot;))

seu &lt;- readRDS(file)
seu</code></pre>
<pre><code>An object of class Seurat 
21568 features across 165209 samples within 1 assay 
Active assay: RNA (21568 features, 0 variable features)</code></pre>
</div>
<div id="analyse-cell-type-proportions" class="section level1">
<h1>Analyse Cell type proportions</h1>
<pre class="r"><code># Differences in cell type proportions
props &lt;- getTransformedProps(clusters = seu$ann_level_3,
                             sample = seu$sample.id, transform=&quot;asin&quot;)
props$Proportions %&gt;% knitr::kable()</code></pre>
<table>
<colgroup>
<col width="4%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="1%" />
<col width="1%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sample_1.1</th>
<th align="right">sample_15.1</th>
<th align="right">sample_16.1</th>
<th align="right">sample_17.1</th>
<th align="right">sample_18.1</th>
<th align="right">sample_19.1</th>
<th align="right">sample_2.1</th>
<th align="right">sample_20.1</th>
<th align="right">sample_21.1</th>
<th align="right">sample_22.1</th>
<th align="right">sample_23.1</th>
<th align="right">sample_24.1</th>
<th align="right">sample_25.1</th>
<th align="right">sample_26.1</th>
<th align="right">sample_27.1</th>
<th align="right">sample_28.1</th>
<th align="right">sample_29.1</th>
<th align="right">sample_3.1</th>
<th align="right">sample_30.1</th>
<th align="right">sample_31.1</th>
<th align="right">sample_32.1</th>
<th align="right">sample_33.1</th>
<th align="right">sample_34.1</th>
<th align="right">sample_34.2</th>
<th align="right">sample_34.3</th>
<th align="right">sample_35.1</th>
<th align="right">sample_35.2</th>
<th align="right">sample_36.1</th>
<th align="right">sample_36.2</th>
<th align="right">sample_37.1</th>
<th align="right">sample_37.2</th>
<th align="right">sample_37.3</th>
<th align="right">sample_38.1</th>
<th align="right">sample_38.2</th>
<th align="right">sample_38.3</th>
<th align="right">sample_39.1</th>
<th align="right">sample_39.2</th>
<th align="right">sample_4.1</th>
<th align="right">sample_40.1</th>
<th align="right">sample_41.1</th>
<th align="right">sample_42.1</th>
<th align="right">sample_43.1</th>
<th align="right">sample_5.1</th>
<th align="right">sample_6.1</th>
<th align="right">sample_7.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-alveolar</td>
<td align="right">0.4750594</td>
<td align="right">0.3657272</td>
<td align="right">0.2234348</td>
<td align="right">0.2772310</td>
<td align="right">0.3252813</td>
<td align="right">0.5249291</td>
<td align="right">0.2832045</td>
<td align="right">0.2779856</td>
<td align="right">0.3101203</td>
<td align="right">0.2744355</td>
<td align="right">0.0458716</td>
<td align="right">0.3651142</td>
<td align="right">0.2920383</td>
<td align="right">0.4566441</td>
<td align="right">0.3492996</td>
<td align="right">0.3700948</td>
<td align="right">0.2007401</td>
<td align="right">0.3678344</td>
<td align="right">0.0897690</td>
<td align="right">0.1948441</td>
<td align="right">0.3414193</td>
<td align="right">0.1957774</td>
<td align="right">0.1299001</td>
<td align="right">0.2399031</td>
<td align="right">0.2225579</td>
<td align="right">0.4291600</td>
<td align="right">0.3967425</td>
<td align="right">0.5215483</td>
<td align="right">0.3704100</td>
<td align="right">0.2633531</td>
<td align="right">0.4786416</td>
<td align="right">0.3373068</td>
<td align="right">0.4354883</td>
<td align="right">0.3365323</td>
<td align="right">0.3201247</td>
<td align="right">0.2666667</td>
<td align="right">0.2914300</td>
<td align="right">0.0884395</td>
<td align="right">0.3238696</td>
<td align="right">0.3059867</td>
<td align="right">0.3034502</td>
<td align="right">0.2702652</td>
<td align="right">0.4068059</td>
<td align="right">0.2751848</td>
<td align="right">0.3496872</td>
</tr>
<tr class="even">
<td align="left">macro-APOC2+</td>
<td align="right">0.0109264</td>
<td align="right">0.0651118</td>
<td align="right">0.1585296</td>
<td align="right">0.1371391</td>
<td align="right">0.0198544</td>
<td align="right">0.1236319</td>
<td align="right">0.0955727</td>
<td align="right">0.1273043</td>
<td align="right">0.0854212</td>
<td align="right">0.0868313</td>
<td align="right">0.0000000</td>
<td align="right">0.0002580</td>
<td align="right">0.1261976</td>
<td align="right">0.0467342</td>
<td align="right">0.0329869</td>
<td align="right">0.1250182</td>
<td align="right">0.0888067</td>
<td align="right">0.1756142</td>
<td align="right">0.0429043</td>
<td align="right">0.1804556</td>
<td align="right">0.1162201</td>
<td align="right">0.1199616</td>
<td align="right">0.1345119</td>
<td align="right">0.2617124</td>
<td align="right">0.2832326</td>
<td align="right">0.0205997</td>
<td align="right">0.0200459</td>
<td align="right">0.0670391</td>
<td align="right">0.0745098</td>
<td align="right">0.0318991</td>
<td align="right">0.0685604</td>
<td align="right">0.0463576</td>
<td align="right">0.1048143</td>
<td align="right">0.1081254</td>
<td align="right">0.1050757</td>
<td align="right">0.0848200</td>
<td align="right">0.0903459</td>
<td align="right">0.0362209</td>
<td align="right">0.0835962</td>
<td align="right">0.0082357</td>
<td align="right">0.0108078</td>
<td align="right">0.0045455</td>
<td align="right">0.1941222</td>
<td align="right">0.0767440</td>
<td align="right">0.0922360</td>
</tr>
<tr class="odd">
<td align="left">macro-CCL</td>
<td align="right">0.0361045</td>
<td align="right">0.0285066</td>
<td align="right">0.0134980</td>
<td align="right">0.0469160</td>
<td align="right">0.0488087</td>
<td align="right">0.0137819</td>
<td align="right">0.0597330</td>
<td align="right">0.0212396</td>
<td align="right">0.0658907</td>
<td align="right">0.0289438</td>
<td align="right">0.0550459</td>
<td align="right">0.0273513</td>
<td align="right">0.0181698</td>
<td align="right">0.0230856</td>
<td align="right">0.0162675</td>
<td align="right">0.0207148</td>
<td align="right">0.1091582</td>
<td align="right">0.0639217</td>
<td align="right">0.1141914</td>
<td align="right">0.0449640</td>
<td align="right">0.0380159</td>
<td align="right">0.0527831</td>
<td align="right">0.0860876</td>
<td align="right">0.0129241</td>
<td align="right">0.0312185</td>
<td align="right">0.0183108</td>
<td align="right">0.0478179</td>
<td align="right">0.0179569</td>
<td align="right">0.0278075</td>
<td align="right">0.1331602</td>
<td align="right">0.0388723</td>
<td align="right">0.1249448</td>
<td align="right">0.0093535</td>
<td align="right">0.0287908</td>
<td align="right">0.0258237</td>
<td align="right">0.0860720</td>
<td align="right">0.0753743</td>
<td align="right">0.4633263</td>
<td align="right">0.0988433</td>
<td align="right">0.2169781</td>
<td align="right">0.0267424</td>
<td align="right">0.1350379</td>
<td align="right">0.0201083</td>
<td align="right">0.0344234</td>
<td align="right">0.0344658</td>
</tr>
<tr class="even">
<td align="left">macro-CCL18</td>
<td align="right">0.1453682</td>
<td align="right">0.0664075</td>
<td align="right">0.0709362</td>
<td align="right">0.0318241</td>
<td align="right">0.1358372</td>
<td align="right">0.0506688</td>
<td align="right">0.0548138</td>
<td align="right">0.1180871</td>
<td align="right">0.0307753</td>
<td align="right">0.0162146</td>
<td align="right">0.0091743</td>
<td align="right">0.0704425</td>
<td align="right">0.0716881</td>
<td align="right">0.0185811</td>
<td align="right">0.0329869</td>
<td align="right">0.0229030</td>
<td align="right">0.0471785</td>
<td align="right">0.0363967</td>
<td align="right">0.1881188</td>
<td align="right">0.0281775</td>
<td align="right">0.1028240</td>
<td align="right">0.0556622</td>
<td align="right">0.1614143</td>
<td align="right">0.1090468</td>
<td align="right">0.0757805</td>
<td align="right">0.0444038</td>
<td align="right">0.0281896</td>
<td align="right">0.0458899</td>
<td align="right">0.1547237</td>
<td align="right">0.1283383</td>
<td align="right">0.1114908</td>
<td align="right">0.1086093</td>
<td align="right">0.0503439</td>
<td align="right">0.0153551</td>
<td align="right">0.0347284</td>
<td align="right">0.0694836</td>
<td align="right">0.0433660</td>
<td align="right">0.0167522</td>
<td align="right">0.0525762</td>
<td align="right">0.1042129</td>
<td align="right">0.0529306</td>
<td align="right">0.0543561</td>
<td align="right">0.0487239</td>
<td align="right">0.0798826</td>
<td align="right">0.0497976</td>
</tr>
<tr class="odd">
<td align="left">macro-IFI27</td>
<td align="right">0.0370546</td>
<td align="right">0.1127308</td>
<td align="right">0.1748995</td>
<td align="right">0.1466535</td>
<td align="right">0.0415288</td>
<td align="right">0.0664775</td>
<td align="right">0.0660576</td>
<td align="right">0.1297088</td>
<td align="right">0.1110673</td>
<td align="right">0.0971359</td>
<td align="right">0.0000000</td>
<td align="right">0.1559799</td>
<td align="right">0.0835811</td>
<td align="right">0.1216216</td>
<td align="right">0.2227745</td>
<td align="right">0.0850474</td>
<td align="right">0.0638298</td>
<td align="right">0.1037307</td>
<td align="right">0.0554455</td>
<td align="right">0.1366906</td>
<td align="right">0.0615496</td>
<td align="right">0.0556622</td>
<td align="right">0.0253651</td>
<td align="right">0.0678514</td>
<td align="right">0.0518630</td>
<td align="right">0.1210803</td>
<td align="right">0.1229902</td>
<td align="right">0.0243416</td>
<td align="right">0.0377897</td>
<td align="right">0.0541543</td>
<td align="right">0.0337463</td>
<td align="right">0.0189845</td>
<td align="right">0.1155433</td>
<td align="right">0.1666667</td>
<td align="right">0.0756901</td>
<td align="right">0.0475743</td>
<td align="right">0.1040268</td>
<td align="right">0.0937217</td>
<td align="right">0.0541535</td>
<td align="right">0.0538486</td>
<td align="right">0.1806845</td>
<td align="right">0.2045455</td>
<td align="right">0.0193349</td>
<td align="right">0.1701934</td>
<td align="right">0.2012756</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27+APOC2+</td>
<td align="right">0.0009501</td>
<td align="right">0.0119857</td>
<td align="right">0.0953475</td>
<td align="right">0.0626640</td>
<td align="right">0.0043018</td>
<td align="right">0.0218889</td>
<td align="right">0.0281096</td>
<td align="right">0.0454181</td>
<td align="right">0.0327481</td>
<td align="right">0.0259130</td>
<td align="right">0.0000000</td>
<td align="right">0.0003870</td>
<td align="right">0.0419557</td>
<td align="right">0.0118243</td>
<td align="right">0.0140081</td>
<td align="right">0.0288840</td>
<td align="right">0.0379278</td>
<td align="right">0.0586897</td>
<td align="right">0.0455446</td>
<td align="right">0.0977218</td>
<td align="right">0.0177408</td>
<td align="right">0.0374280</td>
<td align="right">0.0299769</td>
<td align="right">0.0379645</td>
<td align="right">0.0362538</td>
<td align="right">0.0059510</td>
<td align="right">0.0060555</td>
<td align="right">0.0027933</td>
<td align="right">0.0057041</td>
<td align="right">0.0126113</td>
<td align="right">0.0044853</td>
<td align="right">0.0035320</td>
<td align="right">0.0231087</td>
<td align="right">0.0489443</td>
<td align="right">0.0276046</td>
<td align="right">0.0169014</td>
<td align="right">0.0294269</td>
<td align="right">0.0437670</td>
<td align="right">0.0089380</td>
<td align="right">0.0003168</td>
<td align="right">0.0018013</td>
<td align="right">0.0022727</td>
<td align="right">0.0108275</td>
<td align="right">0.0459654</td>
<td align="right">0.0482031</td>
</tr>
<tr class="odd">
<td align="left">macro-IFI27+CCL18+</td>
<td align="right">0.0114014</td>
<td align="right">0.0077745</td>
<td align="right">0.0376221</td>
<td align="right">0.0104987</td>
<td align="right">0.0095963</td>
<td align="right">0.0020268</td>
<td align="right">0.0063247</td>
<td align="right">0.0253807</td>
<td align="right">0.0023673</td>
<td align="right">0.0010608</td>
<td align="right">0.0000000</td>
<td align="right">0.0145788</td>
<td align="right">0.0095804</td>
<td align="right">0.0011261</td>
<td align="right">0.0112969</td>
<td align="right">0.0029176</td>
<td align="right">0.0037003</td>
<td align="right">0.0050045</td>
<td align="right">0.1425743</td>
<td align="right">0.0065947</td>
<td align="right">0.0126720</td>
<td align="right">0.0076775</td>
<td align="right">0.0215219</td>
<td align="right">0.0105008</td>
<td align="right">0.0060423</td>
<td align="right">0.0080110</td>
<td align="right">0.0043850</td>
<td align="right">0.0019952</td>
<td align="right">0.0092692</td>
<td align="right">0.0181751</td>
<td align="right">0.0057668</td>
<td align="right">0.0039735</td>
<td align="right">0.0137552</td>
<td align="right">0.0047985</td>
<td align="right">0.0035619</td>
<td align="right">0.0059468</td>
<td align="right">0.0121322</td>
<td align="right">0.0086025</td>
<td align="right">0.0026288</td>
<td align="right">0.0142540</td>
<td align="right">0.0213385</td>
<td align="right">0.0227273</td>
<td align="right">0.0015468</td>
<td align="right">0.0346259</td>
<td align="right">0.0202379</td>
</tr>
<tr class="even">
<td align="left">macro-IFN</td>
<td align="right">0.0114014</td>
<td align="right">0.0145773</td>
<td align="right">0.0134980</td>
<td align="right">0.0065617</td>
<td align="right">0.0090999</td>
<td align="right">0.0060803</td>
<td align="right">0.0063247</td>
<td align="right">0.0040075</td>
<td align="right">0.0130203</td>
<td align="right">0.0122746</td>
<td align="right">0.0000000</td>
<td align="right">0.0167720</td>
<td align="right">0.0105715</td>
<td align="right">0.0191441</td>
<td align="right">0.0108450</td>
<td align="right">0.0086069</td>
<td align="right">0.0129510</td>
<td align="right">0.0113740</td>
<td align="right">0.0099010</td>
<td align="right">0.0239808</td>
<td align="right">0.0170167</td>
<td align="right">0.0038388</td>
<td align="right">0.0146042</td>
<td align="right">0.0121163</td>
<td align="right">0.0123364</td>
<td align="right">0.0144198</td>
<td align="right">0.0110670</td>
<td align="right">0.0063847</td>
<td align="right">0.0049911</td>
<td align="right">0.0096439</td>
<td align="right">0.0102520</td>
<td align="right">0.0154525</td>
<td align="right">0.0178817</td>
<td align="right">0.0339091</td>
<td align="right">0.0258237</td>
<td align="right">0.0172144</td>
<td align="right">0.0172948</td>
<td align="right">0.0033203</td>
<td align="right">0.0157729</td>
<td align="right">0.0326259</td>
<td align="right">0.0230012</td>
<td align="right">0.0195076</td>
<td align="right">0.0038670</td>
<td align="right">0.0054672</td>
<td align="right">0.0042929</td>
</tr>
<tr class="odd">
<td align="left">macro-IGF1</td>
<td align="right">0.0047506</td>
<td align="right">0.0874636</td>
<td align="right">0.0290063</td>
<td align="right">0.0272310</td>
<td align="right">0.0799140</td>
<td align="right">0.0141873</td>
<td align="right">0.0238932</td>
<td align="right">0.0545017</td>
<td align="right">0.0420201</td>
<td align="right">0.1160782</td>
<td align="right">0.0000000</td>
<td align="right">0.0458005</td>
<td align="right">0.0697060</td>
<td align="right">0.0996622</td>
<td align="right">0.0488025</td>
<td align="right">0.0414296</td>
<td align="right">0.0277521</td>
<td align="right">0.0195632</td>
<td align="right">0.0085809</td>
<td align="right">0.0629496</td>
<td align="right">0.0467053</td>
<td align="right">0.0095969</td>
<td align="right">0.0084550</td>
<td align="right">0.0306947</td>
<td align="right">0.0760322</td>
<td align="right">0.0771344</td>
<td align="right">0.1160994</td>
<td align="right">0.0327215</td>
<td align="right">0.0185383</td>
<td align="right">0.0103858</td>
<td align="right">0.0226399</td>
<td align="right">0.0088300</td>
<td align="right">0.0486933</td>
<td align="right">0.0665387</td>
<td align="right">0.0814782</td>
<td align="right">0.0278560</td>
<td align="right">0.0281363</td>
<td align="right">0.0090552</td>
<td align="right">0.1035752</td>
<td align="right">0.0402281</td>
<td align="right">0.1292781</td>
<td align="right">0.0797348</td>
<td align="right">0.0232019</td>
<td align="right">0.0173129</td>
<td align="right">0.0099350</td>
</tr>
<tr class="even">
<td align="left">macro-interstitial</td>
<td align="right">0.0118765</td>
<td align="right">0.0330418</td>
<td align="right">0.0031591</td>
<td align="right">0.0249344</td>
<td align="right">0.0072799</td>
<td align="right">0.0077017</td>
<td align="right">0.0182713</td>
<td align="right">0.0044082</td>
<td align="right">0.0339317</td>
<td align="right">0.0045461</td>
<td align="right">0.7706422</td>
<td align="right">0.0130306</td>
<td align="right">0.0082590</td>
<td align="right">0.0242117</td>
<td align="right">0.0162675</td>
<td align="right">0.0051058</td>
<td align="right">0.1110083</td>
<td align="right">0.0045496</td>
<td align="right">0.0217822</td>
<td align="right">0.0191847</td>
<td align="right">0.0021723</td>
<td align="right">0.1986564</td>
<td align="right">0.1813989</td>
<td align="right">0.0767367</td>
<td align="right">0.0324773</td>
<td align="right">0.0082399</td>
<td align="right">0.0077260</td>
<td align="right">0.0554669</td>
<td align="right">0.0313725</td>
<td align="right">0.0459941</td>
<td align="right">0.0175139</td>
<td align="right">0.1094923</td>
<td align="right">0.0027510</td>
<td align="right">0.0063980</td>
<td align="right">0.0160285</td>
<td align="right">0.0691706</td>
<td align="right">0.0627259</td>
<td align="right">0.0107154</td>
<td align="right">0.0315457</td>
<td align="right">0.0310421</td>
<td align="right">0.0052653</td>
<td align="right">0.0068182</td>
<td align="right">0.0092807</td>
<td align="right">0.0045560</td>
<td align="right">0.0034343</td>
</tr>
<tr class="odd">
<td align="left">macro-lipid</td>
<td align="right">0.0418052</td>
<td align="right">0.0382248</td>
<td align="right">0.0163699</td>
<td align="right">0.0423228</td>
<td align="right">0.1767042</td>
<td align="right">0.0194568</td>
<td align="right">0.1742797</td>
<td align="right">0.0081485</td>
<td align="right">0.0658907</td>
<td align="right">0.1786634</td>
<td align="right">0.0091743</td>
<td align="right">0.0708296</td>
<td align="right">0.0723489</td>
<td align="right">0.0506757</td>
<td align="right">0.0750113</td>
<td align="right">0.0762947</td>
<td align="right">0.1119334</td>
<td align="right">0.0113740</td>
<td align="right">0.0118812</td>
<td align="right">0.0263789</td>
<td align="right">0.0557567</td>
<td align="right">0.0527831</td>
<td align="right">0.0322829</td>
<td align="right">0.0185784</td>
<td align="right">0.0317221</td>
<td align="right">0.0391394</td>
<td align="right">0.1016914</td>
<td align="right">0.0311253</td>
<td align="right">0.0245989</td>
<td align="right">0.1275964</td>
<td align="right">0.0258437</td>
<td align="right">0.1125828</td>
<td align="right">0.0211829</td>
<td align="right">0.0409469</td>
<td align="right">0.0943900</td>
<td align="right">0.1276995</td>
<td align="right">0.0862158</td>
<td align="right">0.0123755</td>
<td align="right">0.0289169</td>
<td align="right">0.0627178</td>
<td align="right">0.0780103</td>
<td align="right">0.0257576</td>
<td align="right">0.0177881</td>
<td align="right">0.0750228</td>
<td align="right">0.0073593</td>
</tr>
<tr class="even">
<td align="left">macro-lipid-APOC2+</td>
<td align="right">0.0004751</td>
<td align="right">0.0058309</td>
<td align="right">0.0097645</td>
<td align="right">0.0252625</td>
<td align="right">0.0105890</td>
<td align="right">0.0052696</td>
<td align="right">0.0393535</td>
<td align="right">0.0050761</td>
<td align="right">0.0213060</td>
<td align="right">0.0371268</td>
<td align="right">0.0000000</td>
<td align="right">0.0001290</td>
<td align="right">0.0363396</td>
<td align="right">0.0033784</td>
<td align="right">0.0031631</td>
<td align="right">0.0268417</td>
<td align="right">0.0518039</td>
<td align="right">0.0054595</td>
<td align="right">0.0079208</td>
<td align="right">0.0221823</td>
<td align="right">0.0202752</td>
<td align="right">0.0374280</td>
<td align="right">0.0837817</td>
<td align="right">0.0193861</td>
<td align="right">0.0324773</td>
<td align="right">0.0020600</td>
<td align="right">0.0045939</td>
<td align="right">0.0043895</td>
<td align="right">0.0046346</td>
<td align="right">0.0252226</td>
<td align="right">0.0057668</td>
<td align="right">0.0229581</td>
<td align="right">0.0038514</td>
<td align="right">0.0057582</td>
<td align="right">0.0213713</td>
<td align="right">0.0519562</td>
<td align="right">0.0309757</td>
<td align="right">0.0123755</td>
<td align="right">0.0094637</td>
<td align="right">0.0031676</td>
<td align="right">0.0013856</td>
<td align="right">0.0003788</td>
<td align="right">0.0100541</td>
<td align="right">0.0231852</td>
<td align="right">0.0023304</td>
</tr>
<tr class="odd">
<td align="left">macro-monocyte-derived</td>
<td align="right">0.1292162</td>
<td align="right">0.0631681</td>
<td align="right">0.0789776</td>
<td align="right">0.0492126</td>
<td align="right">0.0342488</td>
<td align="right">0.0328334</td>
<td align="right">0.0288124</td>
<td align="right">0.0435480</td>
<td align="right">0.0952851</td>
<td align="right">0.0403091</td>
<td align="right">0.1100917</td>
<td align="right">0.1385628</td>
<td align="right">0.0630988</td>
<td align="right">0.0534910</td>
<td align="right">0.0402169</td>
<td align="right">0.1296864</td>
<td align="right">0.0832562</td>
<td align="right">0.0618744</td>
<td align="right">0.2158416</td>
<td align="right">0.0557554</td>
<td align="right">0.0774801</td>
<td align="right">0.1007678</td>
<td align="right">0.0284397</td>
<td align="right">0.0387722</td>
<td align="right">0.0347432</td>
<td align="right">0.1215381</td>
<td align="right">0.0703696</td>
<td align="right">0.0913807</td>
<td align="right">0.1433155</td>
<td align="right">0.0778932</td>
<td align="right">0.0931226</td>
<td align="right">0.0569536</td>
<td align="right">0.0679505</td>
<td align="right">0.0697377</td>
<td align="right">0.0828139</td>
<td align="right">0.0666667</td>
<td align="right">0.0562726</td>
<td align="right">0.1696348</td>
<td align="right">0.1493165</td>
<td align="right">0.0424454</td>
<td align="right">0.0644312</td>
<td align="right">0.0825758</td>
<td align="right">0.1337974</td>
<td align="right">0.0725929</td>
<td align="right">0.0983687</td>
</tr>
<tr class="even">
<td align="left">macro-MT</td>
<td align="right">0.0190024</td>
<td align="right">0.0168448</td>
<td align="right">0.0103389</td>
<td align="right">0.0252625</td>
<td align="right">0.0190271</td>
<td align="right">0.0372923</td>
<td align="right">0.0421644</td>
<td align="right">0.0617152</td>
<td align="right">0.0341290</td>
<td align="right">0.0315199</td>
<td align="right">0.0000000</td>
<td align="right">0.0130306</td>
<td align="right">0.0247770</td>
<td align="right">0.0185811</td>
<td align="right">0.0533213</td>
<td align="right">0.0138585</td>
<td align="right">0.0083256</td>
<td align="right">0.0191083</td>
<td align="right">0.0105611</td>
<td align="right">0.0263789</td>
<td align="right">0.0231716</td>
<td align="right">0.0239923</td>
<td align="right">0.0138355</td>
<td align="right">0.0040388</td>
<td align="right">0.0239174</td>
<td align="right">0.0189975</td>
<td align="right">0.0187931</td>
<td align="right">0.0319234</td>
<td align="right">0.0281640</td>
<td align="right">0.0181751</td>
<td align="right">0.0237078</td>
<td align="right">0.0123620</td>
<td align="right">0.0181568</td>
<td align="right">0.0127959</td>
<td align="right">0.0133571</td>
<td align="right">0.0178404</td>
<td align="right">0.0260712</td>
<td align="right">0.0075460</td>
<td align="right">0.0215563</td>
<td align="right">0.0202724</td>
<td align="right">0.0597201</td>
<td align="right">0.0361742</td>
<td align="right">0.0409899</td>
<td align="right">0.0188316</td>
<td align="right">0.0134920</td>
</tr>
<tr class="odd">
<td align="left">macro-proliferating-G2M</td>
<td align="right">0.0109264</td>
<td align="right">0.0181406</td>
<td align="right">0.0068926</td>
<td align="right">0.0219816</td>
<td align="right">0.0198544</td>
<td align="right">0.0226996</td>
<td align="right">0.0168658</td>
<td align="right">0.0189687</td>
<td align="right">0.0126258</td>
<td align="right">0.0081831</td>
<td align="right">0.0000000</td>
<td align="right">0.0247710</td>
<td align="right">0.0181698</td>
<td align="right">0.0112613</td>
<td align="right">0.0293719</td>
<td align="right">0.0103574</td>
<td align="right">0.0101758</td>
<td align="right">0.0150136</td>
<td align="right">0.0112211</td>
<td align="right">0.0191847</td>
<td align="right">0.0184649</td>
<td align="right">0.0239923</td>
<td align="right">0.0184473</td>
<td align="right">0.0153473</td>
<td align="right">0.0156093</td>
<td align="right">0.0274662</td>
<td align="right">0.0127375</td>
<td align="right">0.0207502</td>
<td align="right">0.0210339</td>
<td align="right">0.0129822</td>
<td align="right">0.0196497</td>
<td align="right">0.0048565</td>
<td align="right">0.0242091</td>
<td align="right">0.0153551</td>
<td align="right">0.0227070</td>
<td align="right">0.0115806</td>
<td align="right">0.0105834</td>
<td align="right">0.0049804</td>
<td align="right">0.0057834</td>
<td align="right">0.0177384</td>
<td align="right">0.0076209</td>
<td align="right">0.0140152</td>
<td align="right">0.0193349</td>
<td align="right">0.0139719</td>
<td align="right">0.0116522</td>
</tr>
<tr class="even">
<td align="left">macro-proliferating-S</td>
<td align="right">0.0304038</td>
<td align="right">0.0398445</td>
<td align="right">0.0272832</td>
<td align="right">0.0465879</td>
<td align="right">0.0309398</td>
<td align="right">0.0356709</td>
<td align="right">0.0323261</td>
<td align="right">0.0292546</td>
<td align="right">0.0232788</td>
<td align="right">0.0174269</td>
<td align="right">0.0000000</td>
<td align="right">0.0220617</td>
<td align="right">0.0393129</td>
<td align="right">0.0236486</td>
<td align="right">0.0253050</td>
<td align="right">0.0128373</td>
<td align="right">0.0185014</td>
<td align="right">0.0227480</td>
<td align="right">0.0165017</td>
<td align="right">0.0383693</td>
<td align="right">0.0293266</td>
<td align="right">0.0143954</td>
<td align="right">0.0284397</td>
<td align="right">0.0371567</td>
<td align="right">0.0284491</td>
<td align="right">0.0357061</td>
<td align="right">0.0223429</td>
<td align="right">0.0331205</td>
<td align="right">0.0338681</td>
<td align="right">0.0211424</td>
<td align="right">0.0288338</td>
<td align="right">0.0057395</td>
<td align="right">0.0360385</td>
<td align="right">0.0271913</td>
<td align="right">0.0365093</td>
<td align="right">0.0203443</td>
<td align="right">0.0209086</td>
<td align="right">0.0090552</td>
<td align="right">0.0063091</td>
<td align="right">0.0389610</td>
<td align="right">0.0250797</td>
<td align="right">0.0295455</td>
<td align="right">0.0185615</td>
<td align="right">0.0263238</td>
<td align="right">0.0268613</td>
</tr>
<tr class="odd">
<td align="left">macro-T</td>
<td align="right">0.0232779</td>
<td align="right">0.0246194</td>
<td align="right">0.0304423</td>
<td align="right">0.0177165</td>
<td align="right">0.0271343</td>
<td align="right">0.0154033</td>
<td align="right">0.0238932</td>
<td align="right">0.0252471</td>
<td align="right">0.0201223</td>
<td align="right">0.0233369</td>
<td align="right">0.0000000</td>
<td align="right">0.0209005</td>
<td align="right">0.0142055</td>
<td align="right">0.0163288</td>
<td align="right">0.0180750</td>
<td align="right">0.0194019</td>
<td align="right">0.0129510</td>
<td align="right">0.0177434</td>
<td align="right">0.0072607</td>
<td align="right">0.0161871</td>
<td align="right">0.0191890</td>
<td align="right">0.0095969</td>
<td align="right">0.0015373</td>
<td align="right">0.0072698</td>
<td align="right">0.0052870</td>
<td align="right">0.0077821</td>
<td align="right">0.0083525</td>
<td align="right">0.0111732</td>
<td align="right">0.0092692</td>
<td align="right">0.0092730</td>
<td align="right">0.0111064</td>
<td align="right">0.0070640</td>
<td align="right">0.0068776</td>
<td align="right">0.0121561</td>
<td align="right">0.0129118</td>
<td align="right">0.0122066</td>
<td align="right">0.0147135</td>
<td align="right">0.0101117</td>
<td align="right">0.0031546</td>
<td align="right">0.0069686</td>
<td align="right">0.0084523</td>
<td align="right">0.0117424</td>
<td align="right">0.0216551</td>
<td align="right">0.0257163</td>
<td align="right">0.0263707</td>
</tr>
</tbody>
</table>
<div id="cell-type-proportions-by-sample" class="section level2">
<h2>Cell type proportions by sample</h2>
<pre class="r"><code>props$Proportions %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity,
                             Group,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
  distinct()-&gt; dat

ggplot(dat, aes(x = sample, y = Freq, fill = clusters)) +
  geom_bar(stat = &quot;identity&quot;, color = &quot;black&quot;, size = 0.1) +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1),
        legend.text = element_text(size = 8),
        legend.position = &quot;bottom&quot;) +
  labs(y = &quot;Proportion&quot;, fill = &quot;Cell Label&quot;) +
  scale_fill_paletteer_d(&quot;Polychrome::glasbey&quot;, direction = -1) +
  facet_grid(~Group, scales = &quot;free_x&quot;, space = &quot;free_x&quot;)</code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-5-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="no.-cells-per-sample" class="section level2">
<h2>No. cells per sample</h2>
<pre class="r"><code>props$Counts %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity, 
                             Group,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
  distinct() -&gt; dat

ggplot(dat, aes(x = sample, y = Freq, fill = Disease)) +
  geom_bar(stat = &quot;identity&quot;) +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1),
        legend.text = element_text(size = 8),
        legend.position = &quot;bottom&quot;) +
  labs(y = &quot;No. cells&quot;, fill = &quot;Disease&quot;) +
  facet_grid(~Group, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  geom_hline(yintercept = 1000, linetype = &quot;dashed&quot;)</code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>Remove sample with too few cells.</p>
<pre class="r"><code>seu &lt;- subset(seu, cells = which(!seu$sample.id %in% c(&quot;sample_23.1&quot;)))

# Differences in cell type proportions
props &lt;- getTransformedProps(clusters = seu$ann_level_3,
                             sample = seu$sample.id, transform=&quot;asin&quot;)
props$Proportions %&gt;% knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="4%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sample_1.1</th>
<th align="right">sample_15.1</th>
<th align="right">sample_16.1</th>
<th align="right">sample_17.1</th>
<th align="right">sample_18.1</th>
<th align="right">sample_19.1</th>
<th align="right">sample_2.1</th>
<th align="right">sample_20.1</th>
<th align="right">sample_21.1</th>
<th align="right">sample_22.1</th>
<th align="right">sample_24.1</th>
<th align="right">sample_25.1</th>
<th align="right">sample_26.1</th>
<th align="right">sample_27.1</th>
<th align="right">sample_28.1</th>
<th align="right">sample_29.1</th>
<th align="right">sample_3.1</th>
<th align="right">sample_30.1</th>
<th align="right">sample_31.1</th>
<th align="right">sample_32.1</th>
<th align="right">sample_33.1</th>
<th align="right">sample_34.1</th>
<th align="right">sample_34.2</th>
<th align="right">sample_34.3</th>
<th align="right">sample_35.1</th>
<th align="right">sample_35.2</th>
<th align="right">sample_36.1</th>
<th align="right">sample_36.2</th>
<th align="right">sample_37.1</th>
<th align="right">sample_37.2</th>
<th align="right">sample_37.3</th>
<th align="right">sample_38.1</th>
<th align="right">sample_38.2</th>
<th align="right">sample_38.3</th>
<th align="right">sample_39.1</th>
<th align="right">sample_39.2</th>
<th align="right">sample_4.1</th>
<th align="right">sample_40.1</th>
<th align="right">sample_41.1</th>
<th align="right">sample_42.1</th>
<th align="right">sample_43.1</th>
<th align="right">sample_5.1</th>
<th align="right">sample_6.1</th>
<th align="right">sample_7.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-alveolar</td>
<td align="right">0.4750594</td>
<td align="right">0.3657272</td>
<td align="right">0.2234348</td>
<td align="right">0.2772310</td>
<td align="right">0.3252813</td>
<td align="right">0.5249291</td>
<td align="right">0.2832045</td>
<td align="right">0.2779856</td>
<td align="right">0.3101203</td>
<td align="right">0.2744355</td>
<td align="right">0.3651142</td>
<td align="right">0.2920383</td>
<td align="right">0.4566441</td>
<td align="right">0.3492996</td>
<td align="right">0.3700948</td>
<td align="right">0.2007401</td>
<td align="right">0.3678344</td>
<td align="right">0.0897690</td>
<td align="right">0.1948441</td>
<td align="right">0.3414193</td>
<td align="right">0.1957774</td>
<td align="right">0.1299001</td>
<td align="right">0.2399031</td>
<td align="right">0.2225579</td>
<td align="right">0.4291600</td>
<td align="right">0.3967425</td>
<td align="right">0.5215483</td>
<td align="right">0.3704100</td>
<td align="right">0.2633531</td>
<td align="right">0.4786416</td>
<td align="right">0.3373068</td>
<td align="right">0.4354883</td>
<td align="right">0.3365323</td>
<td align="right">0.3201247</td>
<td align="right">0.2666667</td>
<td align="right">0.2914300</td>
<td align="right">0.0884395</td>
<td align="right">0.3238696</td>
<td align="right">0.3059867</td>
<td align="right">0.3034502</td>
<td align="right">0.2702652</td>
<td align="right">0.4068059</td>
<td align="right">0.2751848</td>
<td align="right">0.3496872</td>
</tr>
<tr class="even">
<td align="left">macro-APOC2+</td>
<td align="right">0.0109264</td>
<td align="right">0.0651118</td>
<td align="right">0.1585296</td>
<td align="right">0.1371391</td>
<td align="right">0.0198544</td>
<td align="right">0.1236319</td>
<td align="right">0.0955727</td>
<td align="right">0.1273043</td>
<td align="right">0.0854212</td>
<td align="right">0.0868313</td>
<td align="right">0.0002580</td>
<td align="right">0.1261976</td>
<td align="right">0.0467342</td>
<td align="right">0.0329869</td>
<td align="right">0.1250182</td>
<td align="right">0.0888067</td>
<td align="right">0.1756142</td>
<td align="right">0.0429043</td>
<td align="right">0.1804556</td>
<td align="right">0.1162201</td>
<td align="right">0.1199616</td>
<td align="right">0.1345119</td>
<td align="right">0.2617124</td>
<td align="right">0.2832326</td>
<td align="right">0.0205997</td>
<td align="right">0.0200459</td>
<td align="right">0.0670391</td>
<td align="right">0.0745098</td>
<td align="right">0.0318991</td>
<td align="right">0.0685604</td>
<td align="right">0.0463576</td>
<td align="right">0.1048143</td>
<td align="right">0.1081254</td>
<td align="right">0.1050757</td>
<td align="right">0.0848200</td>
<td align="right">0.0903459</td>
<td align="right">0.0362209</td>
<td align="right">0.0835962</td>
<td align="right">0.0082357</td>
<td align="right">0.0108078</td>
<td align="right">0.0045455</td>
<td align="right">0.1941222</td>
<td align="right">0.0767440</td>
<td align="right">0.0922360</td>
</tr>
<tr class="odd">
<td align="left">macro-CCL</td>
<td align="right">0.0361045</td>
<td align="right">0.0285066</td>
<td align="right">0.0134980</td>
<td align="right">0.0469160</td>
<td align="right">0.0488087</td>
<td align="right">0.0137819</td>
<td align="right">0.0597330</td>
<td align="right">0.0212396</td>
<td align="right">0.0658907</td>
<td align="right">0.0289438</td>
<td align="right">0.0273513</td>
<td align="right">0.0181698</td>
<td align="right">0.0230856</td>
<td align="right">0.0162675</td>
<td align="right">0.0207148</td>
<td align="right">0.1091582</td>
<td align="right">0.0639217</td>
<td align="right">0.1141914</td>
<td align="right">0.0449640</td>
<td align="right">0.0380159</td>
<td align="right">0.0527831</td>
<td align="right">0.0860876</td>
<td align="right">0.0129241</td>
<td align="right">0.0312185</td>
<td align="right">0.0183108</td>
<td align="right">0.0478179</td>
<td align="right">0.0179569</td>
<td align="right">0.0278075</td>
<td align="right">0.1331602</td>
<td align="right">0.0388723</td>
<td align="right">0.1249448</td>
<td align="right">0.0093535</td>
<td align="right">0.0287908</td>
<td align="right">0.0258237</td>
<td align="right">0.0860720</td>
<td align="right">0.0753743</td>
<td align="right">0.4633263</td>
<td align="right">0.0988433</td>
<td align="right">0.2169781</td>
<td align="right">0.0267424</td>
<td align="right">0.1350379</td>
<td align="right">0.0201083</td>
<td align="right">0.0344234</td>
<td align="right">0.0344658</td>
</tr>
<tr class="even">
<td align="left">macro-CCL18</td>
<td align="right">0.1453682</td>
<td align="right">0.0664075</td>
<td align="right">0.0709362</td>
<td align="right">0.0318241</td>
<td align="right">0.1358372</td>
<td align="right">0.0506688</td>
<td align="right">0.0548138</td>
<td align="right">0.1180871</td>
<td align="right">0.0307753</td>
<td align="right">0.0162146</td>
<td align="right">0.0704425</td>
<td align="right">0.0716881</td>
<td align="right">0.0185811</td>
<td align="right">0.0329869</td>
<td align="right">0.0229030</td>
<td align="right">0.0471785</td>
<td align="right">0.0363967</td>
<td align="right">0.1881188</td>
<td align="right">0.0281775</td>
<td align="right">0.1028240</td>
<td align="right">0.0556622</td>
<td align="right">0.1614143</td>
<td align="right">0.1090468</td>
<td align="right">0.0757805</td>
<td align="right">0.0444038</td>
<td align="right">0.0281896</td>
<td align="right">0.0458899</td>
<td align="right">0.1547237</td>
<td align="right">0.1283383</td>
<td align="right">0.1114908</td>
<td align="right">0.1086093</td>
<td align="right">0.0503439</td>
<td align="right">0.0153551</td>
<td align="right">0.0347284</td>
<td align="right">0.0694836</td>
<td align="right">0.0433660</td>
<td align="right">0.0167522</td>
<td align="right">0.0525762</td>
<td align="right">0.1042129</td>
<td align="right">0.0529306</td>
<td align="right">0.0543561</td>
<td align="right">0.0487239</td>
<td align="right">0.0798826</td>
<td align="right">0.0497976</td>
</tr>
<tr class="odd">
<td align="left">macro-IFI27</td>
<td align="right">0.0370546</td>
<td align="right">0.1127308</td>
<td align="right">0.1748995</td>
<td align="right">0.1466535</td>
<td align="right">0.0415288</td>
<td align="right">0.0664775</td>
<td align="right">0.0660576</td>
<td align="right">0.1297088</td>
<td align="right">0.1110673</td>
<td align="right">0.0971359</td>
<td align="right">0.1559799</td>
<td align="right">0.0835811</td>
<td align="right">0.1216216</td>
<td align="right">0.2227745</td>
<td align="right">0.0850474</td>
<td align="right">0.0638298</td>
<td align="right">0.1037307</td>
<td align="right">0.0554455</td>
<td align="right">0.1366906</td>
<td align="right">0.0615496</td>
<td align="right">0.0556622</td>
<td align="right">0.0253651</td>
<td align="right">0.0678514</td>
<td align="right">0.0518630</td>
<td align="right">0.1210803</td>
<td align="right">0.1229902</td>
<td align="right">0.0243416</td>
<td align="right">0.0377897</td>
<td align="right">0.0541543</td>
<td align="right">0.0337463</td>
<td align="right">0.0189845</td>
<td align="right">0.1155433</td>
<td align="right">0.1666667</td>
<td align="right">0.0756901</td>
<td align="right">0.0475743</td>
<td align="right">0.1040268</td>
<td align="right">0.0937217</td>
<td align="right">0.0541535</td>
<td align="right">0.0538486</td>
<td align="right">0.1806845</td>
<td align="right">0.2045455</td>
<td align="right">0.0193349</td>
<td align="right">0.1701934</td>
<td align="right">0.2012756</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27+APOC2+</td>
<td align="right">0.0009501</td>
<td align="right">0.0119857</td>
<td align="right">0.0953475</td>
<td align="right">0.0626640</td>
<td align="right">0.0043018</td>
<td align="right">0.0218889</td>
<td align="right">0.0281096</td>
<td align="right">0.0454181</td>
<td align="right">0.0327481</td>
<td align="right">0.0259130</td>
<td align="right">0.0003870</td>
<td align="right">0.0419557</td>
<td align="right">0.0118243</td>
<td align="right">0.0140081</td>
<td align="right">0.0288840</td>
<td align="right">0.0379278</td>
<td align="right">0.0586897</td>
<td align="right">0.0455446</td>
<td align="right">0.0977218</td>
<td align="right">0.0177408</td>
<td align="right">0.0374280</td>
<td align="right">0.0299769</td>
<td align="right">0.0379645</td>
<td align="right">0.0362538</td>
<td align="right">0.0059510</td>
<td align="right">0.0060555</td>
<td align="right">0.0027933</td>
<td align="right">0.0057041</td>
<td align="right">0.0126113</td>
<td align="right">0.0044853</td>
<td align="right">0.0035320</td>
<td align="right">0.0231087</td>
<td align="right">0.0489443</td>
<td align="right">0.0276046</td>
<td align="right">0.0169014</td>
<td align="right">0.0294269</td>
<td align="right">0.0437670</td>
<td align="right">0.0089380</td>
<td align="right">0.0003168</td>
<td align="right">0.0018013</td>
<td align="right">0.0022727</td>
<td align="right">0.0108275</td>
<td align="right">0.0459654</td>
<td align="right">0.0482031</td>
</tr>
<tr class="odd">
<td align="left">macro-IFI27+CCL18+</td>
<td align="right">0.0114014</td>
<td align="right">0.0077745</td>
<td align="right">0.0376221</td>
<td align="right">0.0104987</td>
<td align="right">0.0095963</td>
<td align="right">0.0020268</td>
<td align="right">0.0063247</td>
<td align="right">0.0253807</td>
<td align="right">0.0023673</td>
<td align="right">0.0010608</td>
<td align="right">0.0145788</td>
<td align="right">0.0095804</td>
<td align="right">0.0011261</td>
<td align="right">0.0112969</td>
<td align="right">0.0029176</td>
<td align="right">0.0037003</td>
<td align="right">0.0050045</td>
<td align="right">0.1425743</td>
<td align="right">0.0065947</td>
<td align="right">0.0126720</td>
<td align="right">0.0076775</td>
<td align="right">0.0215219</td>
<td align="right">0.0105008</td>
<td align="right">0.0060423</td>
<td align="right">0.0080110</td>
<td align="right">0.0043850</td>
<td align="right">0.0019952</td>
<td align="right">0.0092692</td>
<td align="right">0.0181751</td>
<td align="right">0.0057668</td>
<td align="right">0.0039735</td>
<td align="right">0.0137552</td>
<td align="right">0.0047985</td>
<td align="right">0.0035619</td>
<td align="right">0.0059468</td>
<td align="right">0.0121322</td>
<td align="right">0.0086025</td>
<td align="right">0.0026288</td>
<td align="right">0.0142540</td>
<td align="right">0.0213385</td>
<td align="right">0.0227273</td>
<td align="right">0.0015468</td>
<td align="right">0.0346259</td>
<td align="right">0.0202379</td>
</tr>
<tr class="even">
<td align="left">macro-IFN</td>
<td align="right">0.0114014</td>
<td align="right">0.0145773</td>
<td align="right">0.0134980</td>
<td align="right">0.0065617</td>
<td align="right">0.0090999</td>
<td align="right">0.0060803</td>
<td align="right">0.0063247</td>
<td align="right">0.0040075</td>
<td align="right">0.0130203</td>
<td align="right">0.0122746</td>
<td align="right">0.0167720</td>
<td align="right">0.0105715</td>
<td align="right">0.0191441</td>
<td align="right">0.0108450</td>
<td align="right">0.0086069</td>
<td align="right">0.0129510</td>
<td align="right">0.0113740</td>
<td align="right">0.0099010</td>
<td align="right">0.0239808</td>
<td align="right">0.0170167</td>
<td align="right">0.0038388</td>
<td align="right">0.0146042</td>
<td align="right">0.0121163</td>
<td align="right">0.0123364</td>
<td align="right">0.0144198</td>
<td align="right">0.0110670</td>
<td align="right">0.0063847</td>
<td align="right">0.0049911</td>
<td align="right">0.0096439</td>
<td align="right">0.0102520</td>
<td align="right">0.0154525</td>
<td align="right">0.0178817</td>
<td align="right">0.0339091</td>
<td align="right">0.0258237</td>
<td align="right">0.0172144</td>
<td align="right">0.0172948</td>
<td align="right">0.0033203</td>
<td align="right">0.0157729</td>
<td align="right">0.0326259</td>
<td align="right">0.0230012</td>
<td align="right">0.0195076</td>
<td align="right">0.0038670</td>
<td align="right">0.0054672</td>
<td align="right">0.0042929</td>
</tr>
<tr class="odd">
<td align="left">macro-IGF1</td>
<td align="right">0.0047506</td>
<td align="right">0.0874636</td>
<td align="right">0.0290063</td>
<td align="right">0.0272310</td>
<td align="right">0.0799140</td>
<td align="right">0.0141873</td>
<td align="right">0.0238932</td>
<td align="right">0.0545017</td>
<td align="right">0.0420201</td>
<td align="right">0.1160782</td>
<td align="right">0.0458005</td>
<td align="right">0.0697060</td>
<td align="right">0.0996622</td>
<td align="right">0.0488025</td>
<td align="right">0.0414296</td>
<td align="right">0.0277521</td>
<td align="right">0.0195632</td>
<td align="right">0.0085809</td>
<td align="right">0.0629496</td>
<td align="right">0.0467053</td>
<td align="right">0.0095969</td>
<td align="right">0.0084550</td>
<td align="right">0.0306947</td>
<td align="right">0.0760322</td>
<td align="right">0.0771344</td>
<td align="right">0.1160994</td>
<td align="right">0.0327215</td>
<td align="right">0.0185383</td>
<td align="right">0.0103858</td>
<td align="right">0.0226399</td>
<td align="right">0.0088300</td>
<td align="right">0.0486933</td>
<td align="right">0.0665387</td>
<td align="right">0.0814782</td>
<td align="right">0.0278560</td>
<td align="right">0.0281363</td>
<td align="right">0.0090552</td>
<td align="right">0.1035752</td>
<td align="right">0.0402281</td>
<td align="right">0.1292781</td>
<td align="right">0.0797348</td>
<td align="right">0.0232019</td>
<td align="right">0.0173129</td>
<td align="right">0.0099350</td>
</tr>
<tr class="even">
<td align="left">macro-interstitial</td>
<td align="right">0.0118765</td>
<td align="right">0.0330418</td>
<td align="right">0.0031591</td>
<td align="right">0.0249344</td>
<td align="right">0.0072799</td>
<td align="right">0.0077017</td>
<td align="right">0.0182713</td>
<td align="right">0.0044082</td>
<td align="right">0.0339317</td>
<td align="right">0.0045461</td>
<td align="right">0.0130306</td>
<td align="right">0.0082590</td>
<td align="right">0.0242117</td>
<td align="right">0.0162675</td>
<td align="right">0.0051058</td>
<td align="right">0.1110083</td>
<td align="right">0.0045496</td>
<td align="right">0.0217822</td>
<td align="right">0.0191847</td>
<td align="right">0.0021723</td>
<td align="right">0.1986564</td>
<td align="right">0.1813989</td>
<td align="right">0.0767367</td>
<td align="right">0.0324773</td>
<td align="right">0.0082399</td>
<td align="right">0.0077260</td>
<td align="right">0.0554669</td>
<td align="right">0.0313725</td>
<td align="right">0.0459941</td>
<td align="right">0.0175139</td>
<td align="right">0.1094923</td>
<td align="right">0.0027510</td>
<td align="right">0.0063980</td>
<td align="right">0.0160285</td>
<td align="right">0.0691706</td>
<td align="right">0.0627259</td>
<td align="right">0.0107154</td>
<td align="right">0.0315457</td>
<td align="right">0.0310421</td>
<td align="right">0.0052653</td>
<td align="right">0.0068182</td>
<td align="right">0.0092807</td>
<td align="right">0.0045560</td>
<td align="right">0.0034343</td>
</tr>
<tr class="odd">
<td align="left">macro-lipid</td>
<td align="right">0.0418052</td>
<td align="right">0.0382248</td>
<td align="right">0.0163699</td>
<td align="right">0.0423228</td>
<td align="right">0.1767042</td>
<td align="right">0.0194568</td>
<td align="right">0.1742797</td>
<td align="right">0.0081485</td>
<td align="right">0.0658907</td>
<td align="right">0.1786634</td>
<td align="right">0.0708296</td>
<td align="right">0.0723489</td>
<td align="right">0.0506757</td>
<td align="right">0.0750113</td>
<td align="right">0.0762947</td>
<td align="right">0.1119334</td>
<td align="right">0.0113740</td>
<td align="right">0.0118812</td>
<td align="right">0.0263789</td>
<td align="right">0.0557567</td>
<td align="right">0.0527831</td>
<td align="right">0.0322829</td>
<td align="right">0.0185784</td>
<td align="right">0.0317221</td>
<td align="right">0.0391394</td>
<td align="right">0.1016914</td>
<td align="right">0.0311253</td>
<td align="right">0.0245989</td>
<td align="right">0.1275964</td>
<td align="right">0.0258437</td>
<td align="right">0.1125828</td>
<td align="right">0.0211829</td>
<td align="right">0.0409469</td>
<td align="right">0.0943900</td>
<td align="right">0.1276995</td>
<td align="right">0.0862158</td>
<td align="right">0.0123755</td>
<td align="right">0.0289169</td>
<td align="right">0.0627178</td>
<td align="right">0.0780103</td>
<td align="right">0.0257576</td>
<td align="right">0.0177881</td>
<td align="right">0.0750228</td>
<td align="right">0.0073593</td>
</tr>
<tr class="even">
<td align="left">macro-lipid-APOC2+</td>
<td align="right">0.0004751</td>
<td align="right">0.0058309</td>
<td align="right">0.0097645</td>
<td align="right">0.0252625</td>
<td align="right">0.0105890</td>
<td align="right">0.0052696</td>
<td align="right">0.0393535</td>
<td align="right">0.0050761</td>
<td align="right">0.0213060</td>
<td align="right">0.0371268</td>
<td align="right">0.0001290</td>
<td align="right">0.0363396</td>
<td align="right">0.0033784</td>
<td align="right">0.0031631</td>
<td align="right">0.0268417</td>
<td align="right">0.0518039</td>
<td align="right">0.0054595</td>
<td align="right">0.0079208</td>
<td align="right">0.0221823</td>
<td align="right">0.0202752</td>
<td align="right">0.0374280</td>
<td align="right">0.0837817</td>
<td align="right">0.0193861</td>
<td align="right">0.0324773</td>
<td align="right">0.0020600</td>
<td align="right">0.0045939</td>
<td align="right">0.0043895</td>
<td align="right">0.0046346</td>
<td align="right">0.0252226</td>
<td align="right">0.0057668</td>
<td align="right">0.0229581</td>
<td align="right">0.0038514</td>
<td align="right">0.0057582</td>
<td align="right">0.0213713</td>
<td align="right">0.0519562</td>
<td align="right">0.0309757</td>
<td align="right">0.0123755</td>
<td align="right">0.0094637</td>
<td align="right">0.0031676</td>
<td align="right">0.0013856</td>
<td align="right">0.0003788</td>
<td align="right">0.0100541</td>
<td align="right">0.0231852</td>
<td align="right">0.0023304</td>
</tr>
<tr class="odd">
<td align="left">macro-monocyte-derived</td>
<td align="right">0.1292162</td>
<td align="right">0.0631681</td>
<td align="right">0.0789776</td>
<td align="right">0.0492126</td>
<td align="right">0.0342488</td>
<td align="right">0.0328334</td>
<td align="right">0.0288124</td>
<td align="right">0.0435480</td>
<td align="right">0.0952851</td>
<td align="right">0.0403091</td>
<td align="right">0.1385628</td>
<td align="right">0.0630988</td>
<td align="right">0.0534910</td>
<td align="right">0.0402169</td>
<td align="right">0.1296864</td>
<td align="right">0.0832562</td>
<td align="right">0.0618744</td>
<td align="right">0.2158416</td>
<td align="right">0.0557554</td>
<td align="right">0.0774801</td>
<td align="right">0.1007678</td>
<td align="right">0.0284397</td>
<td align="right">0.0387722</td>
<td align="right">0.0347432</td>
<td align="right">0.1215381</td>
<td align="right">0.0703696</td>
<td align="right">0.0913807</td>
<td align="right">0.1433155</td>
<td align="right">0.0778932</td>
<td align="right">0.0931226</td>
<td align="right">0.0569536</td>
<td align="right">0.0679505</td>
<td align="right">0.0697377</td>
<td align="right">0.0828139</td>
<td align="right">0.0666667</td>
<td align="right">0.0562726</td>
<td align="right">0.1696348</td>
<td align="right">0.1493165</td>
<td align="right">0.0424454</td>
<td align="right">0.0644312</td>
<td align="right">0.0825758</td>
<td align="right">0.1337974</td>
<td align="right">0.0725929</td>
<td align="right">0.0983687</td>
</tr>
<tr class="even">
<td align="left">macro-MT</td>
<td align="right">0.0190024</td>
<td align="right">0.0168448</td>
<td align="right">0.0103389</td>
<td align="right">0.0252625</td>
<td align="right">0.0190271</td>
<td align="right">0.0372923</td>
<td align="right">0.0421644</td>
<td align="right">0.0617152</td>
<td align="right">0.0341290</td>
<td align="right">0.0315199</td>
<td align="right">0.0130306</td>
<td align="right">0.0247770</td>
<td align="right">0.0185811</td>
<td align="right">0.0533213</td>
<td align="right">0.0138585</td>
<td align="right">0.0083256</td>
<td align="right">0.0191083</td>
<td align="right">0.0105611</td>
<td align="right">0.0263789</td>
<td align="right">0.0231716</td>
<td align="right">0.0239923</td>
<td align="right">0.0138355</td>
<td align="right">0.0040388</td>
<td align="right">0.0239174</td>
<td align="right">0.0189975</td>
<td align="right">0.0187931</td>
<td align="right">0.0319234</td>
<td align="right">0.0281640</td>
<td align="right">0.0181751</td>
<td align="right">0.0237078</td>
<td align="right">0.0123620</td>
<td align="right">0.0181568</td>
<td align="right">0.0127959</td>
<td align="right">0.0133571</td>
<td align="right">0.0178404</td>
<td align="right">0.0260712</td>
<td align="right">0.0075460</td>
<td align="right">0.0215563</td>
<td align="right">0.0202724</td>
<td align="right">0.0597201</td>
<td align="right">0.0361742</td>
<td align="right">0.0409899</td>
<td align="right">0.0188316</td>
<td align="right">0.0134920</td>
</tr>
<tr class="odd">
<td align="left">macro-proliferating-G2M</td>
<td align="right">0.0109264</td>
<td align="right">0.0181406</td>
<td align="right">0.0068926</td>
<td align="right">0.0219816</td>
<td align="right">0.0198544</td>
<td align="right">0.0226996</td>
<td align="right">0.0168658</td>
<td align="right">0.0189687</td>
<td align="right">0.0126258</td>
<td align="right">0.0081831</td>
<td align="right">0.0247710</td>
<td align="right">0.0181698</td>
<td align="right">0.0112613</td>
<td align="right">0.0293719</td>
<td align="right">0.0103574</td>
<td align="right">0.0101758</td>
<td align="right">0.0150136</td>
<td align="right">0.0112211</td>
<td align="right">0.0191847</td>
<td align="right">0.0184649</td>
<td align="right">0.0239923</td>
<td align="right">0.0184473</td>
<td align="right">0.0153473</td>
<td align="right">0.0156093</td>
<td align="right">0.0274662</td>
<td align="right">0.0127375</td>
<td align="right">0.0207502</td>
<td align="right">0.0210339</td>
<td align="right">0.0129822</td>
<td align="right">0.0196497</td>
<td align="right">0.0048565</td>
<td align="right">0.0242091</td>
<td align="right">0.0153551</td>
<td align="right">0.0227070</td>
<td align="right">0.0115806</td>
<td align="right">0.0105834</td>
<td align="right">0.0049804</td>
<td align="right">0.0057834</td>
<td align="right">0.0177384</td>
<td align="right">0.0076209</td>
<td align="right">0.0140152</td>
<td align="right">0.0193349</td>
<td align="right">0.0139719</td>
<td align="right">0.0116522</td>
</tr>
<tr class="even">
<td align="left">macro-proliferating-S</td>
<td align="right">0.0304038</td>
<td align="right">0.0398445</td>
<td align="right">0.0272832</td>
<td align="right">0.0465879</td>
<td align="right">0.0309398</td>
<td align="right">0.0356709</td>
<td align="right">0.0323261</td>
<td align="right">0.0292546</td>
<td align="right">0.0232788</td>
<td align="right">0.0174269</td>
<td align="right">0.0220617</td>
<td align="right">0.0393129</td>
<td align="right">0.0236486</td>
<td align="right">0.0253050</td>
<td align="right">0.0128373</td>
<td align="right">0.0185014</td>
<td align="right">0.0227480</td>
<td align="right">0.0165017</td>
<td align="right">0.0383693</td>
<td align="right">0.0293266</td>
<td align="right">0.0143954</td>
<td align="right">0.0284397</td>
<td align="right">0.0371567</td>
<td align="right">0.0284491</td>
<td align="right">0.0357061</td>
<td align="right">0.0223429</td>
<td align="right">0.0331205</td>
<td align="right">0.0338681</td>
<td align="right">0.0211424</td>
<td align="right">0.0288338</td>
<td align="right">0.0057395</td>
<td align="right">0.0360385</td>
<td align="right">0.0271913</td>
<td align="right">0.0365093</td>
<td align="right">0.0203443</td>
<td align="right">0.0209086</td>
<td align="right">0.0090552</td>
<td align="right">0.0063091</td>
<td align="right">0.0389610</td>
<td align="right">0.0250797</td>
<td align="right">0.0295455</td>
<td align="right">0.0185615</td>
<td align="right">0.0263238</td>
<td align="right">0.0268613</td>
</tr>
<tr class="odd">
<td align="left">macro-T</td>
<td align="right">0.0232779</td>
<td align="right">0.0246194</td>
<td align="right">0.0304423</td>
<td align="right">0.0177165</td>
<td align="right">0.0271343</td>
<td align="right">0.0154033</td>
<td align="right">0.0238932</td>
<td align="right">0.0252471</td>
<td align="right">0.0201223</td>
<td align="right">0.0233369</td>
<td align="right">0.0209005</td>
<td align="right">0.0142055</td>
<td align="right">0.0163288</td>
<td align="right">0.0180750</td>
<td align="right">0.0194019</td>
<td align="right">0.0129510</td>
<td align="right">0.0177434</td>
<td align="right">0.0072607</td>
<td align="right">0.0161871</td>
<td align="right">0.0191890</td>
<td align="right">0.0095969</td>
<td align="right">0.0015373</td>
<td align="right">0.0072698</td>
<td align="right">0.0052870</td>
<td align="right">0.0077821</td>
<td align="right">0.0083525</td>
<td align="right">0.0111732</td>
<td align="right">0.0092692</td>
<td align="right">0.0092730</td>
<td align="right">0.0111064</td>
<td align="right">0.0070640</td>
<td align="right">0.0068776</td>
<td align="right">0.0121561</td>
<td align="right">0.0129118</td>
<td align="right">0.0122066</td>
<td align="right">0.0147135</td>
<td align="right">0.0101117</td>
<td align="right">0.0031546</td>
<td align="right">0.0069686</td>
<td align="right">0.0084523</td>
<td align="right">0.0117424</td>
<td align="right">0.0216551</td>
<td align="right">0.0257163</td>
<td align="right">0.0263707</td>
</tr>
</tbody>
</table>
</div>
<div id="cell-proportions-by-sample" class="section level2">
<h2>Cell proportions by sample</h2>
<pre class="r"><code>props$Proportions %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity, 
                             Group,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
  distinct()-&gt; dat

ggplot(dat, aes(x = sample, y = Freq, fill = clusters)) +
  geom_bar(stat = &quot;identity&quot;, color = &quot;black&quot;, size = 0.1) +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1),
        legend.text = element_text(size = 8),
        legend.position = &quot;bottom&quot;) +
  labs(y = &quot;Proportion&quot;, fill = &quot;Cell Label&quot;) +
  scale_fill_paletteer_d(&quot;Polychrome::glasbey&quot;, direction = -1) +
  facet_grid(~Group, scales = &quot;free_x&quot;, space = &quot;free_x&quot;)</code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-8-1.png" width="864" style="display: block; margin: auto;" /></p>
</div>
<div id="cell-proportions-by-cell-type" class="section level2">
<h2>Cell proportions by cell type</h2>
<pre class="r"><code>props$Proportions %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id,
                             ann_level_3,
                             Disease,
                             Treatment,
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;, &quot;clusters&quot; = &quot;ann_level_3&quot;)) %&gt;%
  distinct()-&gt; dat

ggplot(dat, 
       aes(x = clusters, y = Freq, fill = clusters)) +
  geom_boxplot(outlier.size = 0.1, size = 0.25) +
  theme(axis.text.x = element_text(angle = 45,
                                   vjust = 1,
                                   hjust = 1),
        legend.text = element_text(size = 8)) +
  labs(y = &quot;Proportion&quot;) +
  scale_fill_paletteer_d(&quot;Polychrome::glasbey&quot;, direction = -1) +
  NoLegend()</code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="explore-sources-of-variation" class="section level1">
<h1>Explore sources of variation</h1>
<div id="cell-count-data" class="section level2">
<h2>Cell count data</h2>
<p>Look at the sources of variation in the raw cell count level
data.</p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$Counts,
    gene.selection = &quot;common&quot;,
    plot = FALSE, dim.plot = dims[[i]])
  
  data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            shape = as.factor(Disease),
                            color = as.factor(Batch))) +
    geom_point(size = 3) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Batch&quot;,
         shape = &quot;Disease&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) 
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$Counts, 
                 gene.selection = &quot;common&quot;,
                 plot = FALSE, dim.plot = dims[[i]])
  
   data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity,
                             Participant,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    group_by(sample) %&gt;%
    mutate(ncells = n()) %&gt;%
    ungroup() %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            colour = log2(ncells)))+
    geom_text(aes(label = str_remove_all(sample, &quot;sample_&quot;)), size = 2.5) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Log2 No. Cells&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) +
    scale_colour_viridis_c(option = &quot;magma&quot;)
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="cell-proportion-data" class="section level2">
<h2>Cell proportion data</h2>
<p>Look at the sources of variation in the cell proportions data.</p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps,
    gene.selection = &quot;common&quot;,
    plot = FALSE, dim.plot = dims[[i]])
  
  data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            shape = as.factor(Disease),
                            color = as.factor(Batch)))+
    geom_point(size = 3) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Batch&quot;,
         shape = &quot;Disease&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9))
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps,
    gene.selection = &quot;common&quot;,
    plot = FALSE, dim.plot = dims[[i]])
  
  data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            shape = as.factor(Disease),
                            color = Sex))+
    geom_point(size = 3) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Sex&quot;,
         shape = &quot;Disease&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9))
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps, 
                 gene.selection = &quot;common&quot;,
                 plot = FALSE, dim.plot = dims[[i]])
  
   data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity,
                             Participant,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    group_by(sample) %&gt;%
    mutate(ncells = n()) %&gt;%
    ungroup() %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            colour = log2(Age)))+
    geom_text(aes(label = str_remove_all(sample, &quot;sample_&quot;)), size = 2.5) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Log2 Age&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) +
    scale_colour_viridis_c(option = &quot;magma&quot;)
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps, 
                 gene.selection = &quot;common&quot;,
                 plot = FALSE, dim.plot = dims[[i]])
  
   data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Severity,
                             Participant,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    group_by(sample) %&gt;%
    mutate(ncells = n()) %&gt;%
    ungroup() %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            colour = log2(ncells)))+
    geom_text(aes(label = str_remove_all(sample, &quot;sample_&quot;)), size = 2.5) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Log2 No. Cells&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) +
    scale_colour_viridis_c(option = &quot;magma&quot;)
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="principal-components-versus-traits" class="section level1">
<h1>Principal components versus traits</h1>
<p>Principal components analysis (PCA) allows us to mathematically
determine the sources of variation in the data. We can then investigate
whether these correlate with any of the specifed covariates. First, we
calculate the principal components. The scree plot belows shows us that
most of the variation in this data is captured by the top 7 principal
components.</p>
<pre class="r"><code>PCs &lt;- prcomp(t(props$TransformedProps), center = TRUE, 
              scale = TRUE, retx = TRUE)
loadings = PCs$x # pc loadings
plot(PCs, type=&quot;lines&quot;) # scree plot</code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Collect all of the known sample traits.</p>
<pre class="r"><code>nGenes = nrow(props$TransformedProps)
nSamples = ncol(props$TransformedProps)

info &lt;- seu@meta.data %&gt;%
  dplyr::select(sample.id, 
                Disease,
                Treatment,
                Severity,
                Participant,
                Group_severity,
                Group,
                Batch, 
                Age, 
                Sex) %&gt;%
  group_by(sample.id) %&gt;%
  mutate(ncells = n()) %&gt;%
  ungroup() %&gt;%
  distinct()

m &lt;- match(colnames(props$TransformedProps), info$sample.id)
info &lt;- info[m,]

datTraits &lt;- info %&gt;% dplyr::select(Participant, Batch, Disease, Treatment,
                                    Severity, Age, Sex, ncells, Group) %&gt;%
  mutate(Age = log2(Age),
         ncells = log2(ncells),
         Donor = factor(Participant),
         Batch = factor(Batch),
         Disease = factor(Disease, 
                          labels = 1:length(unique(Disease))),
         Group = factor(Group, 
                        labels = 1:length(unique(Group))),
         Treatment = factor(Treatment, 
                            labels = 1:length(unique(Treatment))),
         Sex = factor(Sex, labels = length(unique(Sex))),
         Severity = factor(Severity, labels = length(unique(Severity)))) %&gt;%
  mutate(across(everything(), as.numeric)) %&gt;%
  dplyr::select(-Participant)

datTraits %&gt;% 
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="8%" />
<col width="11%" />
<col width="14%" />
<col width="13%" />
<col width="15%" />
<col width="5%" />
<col width="13%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Batch</th>
<th align="right">Disease</th>
<th align="right">Treatment</th>
<th align="right">Severity</th>
<th align="right">Age</th>
<th align="right">Sex</th>
<th align="right">ncells</th>
<th align="right">Group</th>
<th align="right">Donor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-0.2590872</td>
<td align="right">2</td>
<td align="right">11.03960</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-0.0939001</td>
<td align="right">2</td>
<td align="right">11.59199</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-0.1151479</td>
<td align="right">1</td>
<td align="right">11.76570</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-0.0441471</td>
<td align="right">1</td>
<td align="right">11.57365</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">0.1428834</td>
<td align="right">2</td>
<td align="right">12.56129</td>
<td align="right">3</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-0.0729608</td>
<td align="right">1</td>
<td align="right">11.26854</td>
<td align="right">3</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.1464588</td>
<td align="right">2</td>
<td align="right">10.47472</td>
<td align="right">4</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">0.5597097</td>
<td align="right">2</td>
<td align="right">12.86998</td>
<td align="right">3</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">1.5743836</td>
<td align="right">1</td>
<td align="right">12.30749</td>
<td align="right">3</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1.5993830</td>
<td align="right">2</td>
<td align="right">12.68803</td>
<td align="right">1</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2.3883594</td>
<td align="right">2</td>
<td align="right">12.92017</td>
<td align="right">1</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2.2957230</td>
<td align="right">1</td>
<td align="right">11.56367</td>
<td align="right">3</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2.3360877</td>
<td align="right">2</td>
<td align="right">10.79442</td>
<td align="right">3</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2.2980155</td>
<td align="right">2</td>
<td align="right">11.11179</td>
<td align="right">1</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2.5790214</td>
<td align="right">1</td>
<td align="right">12.74294</td>
<td align="right">3</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2.5823250</td>
<td align="right">1</td>
<td align="right">10.07815</td>
<td align="right">3</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.1321035</td>
<td align="right">2</td>
<td align="right">12.10198</td>
<td align="right">4</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">2.5889097</td>
<td align="right">1</td>
<td align="right">10.56510</td>
<td align="right">3</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2.5583683</td>
<td align="right">1</td>
<td align="right">10.70390</td>
<td align="right">3</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2.5670653</td>
<td align="right">1</td>
<td align="right">11.43150</td>
<td align="right">3</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2.5730557</td>
<td align="right">2</td>
<td align="right">10.02514</td>
<td align="right">1</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-0.9343238</td>
<td align="right">1</td>
<td align="right">10.34541</td>
<td align="right">3</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">0.0918737</td>
<td align="right">1</td>
<td align="right">10.27380</td>
<td align="right">3</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1.0409164</td>
<td align="right">1</td>
<td align="right">11.95565</td>
<td align="right">3</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">0.0807044</td>
<td align="right">2</td>
<td align="right">12.09309</td>
<td align="right">3</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">0.9940589</td>
<td align="right">2</td>
<td align="right">12.22551</td>
<td align="right">3</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">-0.0564254</td>
<td align="right">1</td>
<td align="right">11.29117</td>
<td align="right">3</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">1.1764977</td>
<td align="right">1</td>
<td align="right">11.45379</td>
<td align="right">2</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1.5597097</td>
<td align="right">1</td>
<td align="right">11.39660</td>
<td align="right">3</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.1930156</td>
<td align="right">1</td>
<td align="right">12.19291</td>
<td align="right">2</td>
<td align="right">25</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.2980155</td>
<td align="right">1</td>
<td align="right">11.14530</td>
<td align="right">2</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1.5703964</td>
<td align="right">2</td>
<td align="right">11.82774</td>
<td align="right">1</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2.0206033</td>
<td align="right">2</td>
<td align="right">11.61010</td>
<td align="right">1</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2.3485584</td>
<td align="right">2</td>
<td align="right">11.13314</td>
<td align="right">1</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1.9730702</td>
<td align="right">1</td>
<td align="right">11.64160</td>
<td align="right">3</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.6297159</td>
<td align="right">1</td>
<td align="right">11.91961</td>
<td align="right">2</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.2923784</td>
<td align="right">2</td>
<td align="right">12.69392</td>
<td align="right">4</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">1.5801455</td>
<td align="right">2</td>
<td align="right">10.89330</td>
<td align="right">3</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1.5801455</td>
<td align="right">2</td>
<td align="right">11.62434</td>
<td align="right">3</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1.5993178</td>
<td align="right">2</td>
<td align="right">12.81718</td>
<td align="right">1</td>
<td align="right">31</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.5849625</td>
<td align="right">2</td>
<td align="right">12.36632</td>
<td align="right">4</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3.0699187</td>
<td align="right">1</td>
<td align="right">10.33651</td>
<td align="right">4</td>
<td align="right">33</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2.4204621</td>
<td align="right">2</td>
<td align="right">13.26986</td>
<td align="right">4</td>
<td align="right">34</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2.2356012</td>
<td align="right">1</td>
<td align="right">12.99312</td>
<td align="right">4</td>
<td align="right">35</td>
</tr>
</tbody>
</table>
<p>Correlate known sample traits with the top 10 principal components.
This can help us determine which traits are potentially contributing to
the main sources of variation in the data and should thus be included in
our statistical analysis.</p>
<pre class="r"><code>moduleTraitCor &lt;- suppressWarnings(cor(loadings[, 1:10], datTraits, use = &quot;p&quot;))
moduleTraitPvalue &lt;- WGCNA::corPvalueStudent(moduleTraitCor, (nSamples - 2))

textMatrix &lt;- paste(signif(moduleTraitCor, 2), &quot;\n(&quot;, 
                    signif(moduleTraitPvalue, 1), &quot;)&quot;, sep = &quot;&quot;)
dim(textMatrix) &lt;- dim(moduleTraitCor)

## Display the correlation values within a heatmap plot
par(cex=0.75, mar = c(6, 8.5, 3, 3))
WGCNA::labeledHeatmap(Matrix = t(moduleTraitCor),
                      xLabels = colnames(loadings)[1:10],
                      yLabels = names(datTraits),
                      colorLabels = FALSE,
                      colors = WGCNA::blueWhiteRed(6),
                      textMatrix = t(textMatrix),
                      setStdMargins = FALSE,
                      cex.text = 1,
                      zlim = c(-1,1),
                      main = paste(&quot;PCA-trait relationships: Top 10 PCs&quot;))</code></pre>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="statistical-analysis-using-the-propeller-and-limma-approach"
class="section level1">
<h1>Statistical analysis using the <code>propeller</code> and
<code>limma</code> approach</h1>
<p>Create the design matrix.</p>
<pre class="r"><code>group &lt;- factor(info$Group_severity)
participant &lt;- factor(info$Participant)
age &lt;- log2(info$Age)
batch &lt;- factor(info$Batch)
sex &lt;- factor(info$Sex)

design &lt;- model.matrix(~ 0 + group + batch + age + sex)
colnames(design)[1:7] &lt;- levels(group) 
design</code></pre>
<pre><code>   CF.IVA.M CF.IVA.S CF.LUMA_IVA.M CF.LUMA_IVA.S CF.NO_MOD.M CF.NO_MOD.S
1         0        0             0             0           0           0
2         0        0             0             0           1           0
3         0        0             0             0           1           0
4         0        0             0             0           1           0
5         0        0             0             0           1           0
6         0        0             0             0           1           0
7         0        0             0             0           0           0
8         0        0             0             0           0           1
9         0        0             0             0           0           1
10        1        0             0             0           0           0
11        1        0             0             0           0           0
12        0        0             0             0           0           1
13        0        0             0             0           1           0
14        1        0             0             0           0           0
15        0        0             0             0           1           0
16        0        0             0             0           0           1
17        0        0             0             0           0           0
18        0        0             0             0           0           1
19        0        0             0             0           1           0
20        0        0             0             0           1           0
21        0        1             0             0           0           0
22        0        0             0             0           1           0
23        0        0             0             0           1           0
24        0        0             0             0           1           0
25        0        0             0             0           1           0
26        0        0             0             0           1           0
27        0        0             0             0           0           1
28        0        0             0             1           0           0
29        0        0             0             0           1           0
30        0        0             1             0           0           0
31        0        0             1             0           0           0
32        1        0             0             0           0           0
33        1        0             0             0           0           0
34        1        0             0             0           0           0
35        0        0             0             0           1           0
36        0        0             1             0           0           0
37        0        0             0             0           0           0
38        0        0             0             0           0           1
39        0        0             0             0           1           0
40        0        1             0             0           0           0
41        0        0             0             0           0           0
42        0        0             0             0           0           0
43        0        0             0             0           0           0
44        0        0             0             0           0           0
   NON_CF.CTRL batch1 batch2 batch3 batch4 batch5 batch6         age sexM
1            1      0      0      1      0      0      0 -0.25908722    1
2            0      0      0      1      0      0      0 -0.09390014    1
3            0      0      0      1      0      0      0 -0.11514787    0
4            0      0      0      0      1      0      0 -0.04414710    0
5            0      0      0      0      1      0      0  0.14288337    1
6            0      0      0      0      0      1      0 -0.07296080    0
7            1      0      0      1      0      0      0  0.14645883    1
8            0      0      0      0      0      1      0  0.55970971    1
9            0      0      0      1      0      0      0  1.57438357    0
10           0      0      0      1      0      0      0  1.59938302    1
11           0      0      0      0      0      1      0  2.38835941    1
12           0      1      0      0      0      0      0  2.29572302    0
13           0      1      0      0      0      0      0  2.33608770    1
14           0      1      0      0      0      0      0  2.29801547    1
15           0      0      0      0      0      1      0  2.57902140    0
16           0      1      0      0      0      0      0  2.58232503    0
17           1      0      0      0      0      1      0  0.13210354    1
18           0      1      0      0      0      0      0  2.58890969    0
19           0      1      0      0      0      0      0  2.55836829    0
20           0      1      0      0      0      0      0  2.56706530    0
21           0      1      0      0      0      0      0  2.57305573    1
22           0      0      0      0      0      0      1 -0.93432383    0
23           0      0      0      0      0      0      1  0.09187369    0
24           0      0      0      0      0      0      1  1.04091644    0
25           0      0      0      0      0      0      1  0.08070438    1
26           0      0      0      0      0      0      1  0.99405890    1
27           0      0      0      0      0      0      1 -0.05642543    0
28           0      0      0      0      0      0      1  1.17649766    0
29           0      0      1      0      0      0      0  1.55970971    0
30           0      0      1      0      0      0      0  2.19301559    0
31           0      0      1      0      0      0      0  2.29801547    0
32           0      0      1      0      0      0      0  1.57039639    1
33           0      0      1      0      0      0      0  2.02060327    1
34           0      0      1      0      0      0      0  2.34855840    1
35           0      0      0      0      1      0      0  1.97307024    0
36           0      0      0      0      1      0      0  2.62971590    0
37           1      0      0      0      0      0      1  0.29237837    1
38           0      0      0      0      0      0      0  1.58014548    1
39           0      0      0      0      0      0      0  1.58014548    1
40           0      0      0      0      0      0      0  1.59931779    1
41           1      0      0      0      0      0      0  1.58496250    1
42           1      0      1      0      0      0      0  3.06991870    0
43           1      0      0      1      0      0      0  2.42046210    1
44           1      0      0      1      0      0      0  2.23560118    0
attr(,&quot;assign&quot;)
 [1] 1 1 1 1 1 1 1 2 2 2 2 2 2 3 4
attr(,&quot;contrasts&quot;)
attr(,&quot;contrasts&quot;)$group
[1] &quot;contr.treatment&quot;

attr(,&quot;contrasts&quot;)$batch
[1] &quot;contr.treatment&quot;

attr(,&quot;contrasts&quot;)$sex
[1] &quot;contr.treatment&quot;</code></pre>
<p>Create the contrast matrix.</p>
<pre class="r"><code>contr &lt;- makeContrasts(CF.NO_MODvCF.IVA = 0.5*(CF.NO_MOD.M + CF.NO_MOD.S) - 0.5*(CF.IVA.M + CF.IVA.S),
                       CF.NO_MODvCF.LUMA_IVA = 0.5*(CF.NO_MOD.M + CF.NO_MOD.S) - 0.5*(CF.LUMA_IVA.M + CF.LUMA_IVA.S),
                       CF.NO_MOD.MvCF.NO_MOD.S = CF.NO_MOD.M - CF.NO_MOD.S,
                       CF.NO_MODvNON_CF.CTRL = 0.5*(CF.NO_MOD.M + CF.NO_MOD.S) - NON_CF.CTRL,
                       CF.IVAvNON_CF.CTRL = 0.5*(CF.IVA.M + CF.IVA.S) - NON_CF.CTRL,
                       CF.LUMA_IVAvNON_CF.CTRL = 0.5*(CF.LUMA_IVA.M + CF.LUMA_IVA.S) - NON_CF.CTRL,
                       levels = design)
contr</code></pre>
<pre><code>               Contrasts
Levels          CF.NO_MODvCF.IVA CF.NO_MODvCF.LUMA_IVA CF.NO_MOD.MvCF.NO_MOD.S
  CF.IVA.M                  -0.5                   0.0                       0
  CF.IVA.S                  -0.5                   0.0                       0
  CF.LUMA_IVA.M              0.0                  -0.5                       0
  CF.LUMA_IVA.S              0.0                  -0.5                       0
  CF.NO_MOD.M                0.5                   0.5                       1
  CF.NO_MOD.S                0.5                   0.5                      -1
  NON_CF.CTRL                0.0                   0.0                       0
  batch1                     0.0                   0.0                       0
  batch2                     0.0                   0.0                       0
  batch3                     0.0                   0.0                       0
  batch4                     0.0                   0.0                       0
  batch5                     0.0                   0.0                       0
  batch6                     0.0                   0.0                       0
  age                        0.0                   0.0                       0
  sexM                       0.0                   0.0                       0
               Contrasts
Levels          CF.NO_MODvNON_CF.CTRL CF.IVAvNON_CF.CTRL
  CF.IVA.M                        0.0                0.5
  CF.IVA.S                        0.0                0.5
  CF.LUMA_IVA.M                   0.0                0.0
  CF.LUMA_IVA.S                   0.0                0.0
  CF.NO_MOD.M                     0.5                0.0
  CF.NO_MOD.S                     0.5                0.0
  NON_CF.CTRL                    -1.0               -1.0
  batch1                          0.0                0.0
  batch2                          0.0                0.0
  batch3                          0.0                0.0
  batch4                          0.0                0.0
  batch5                          0.0                0.0
  batch6                          0.0                0.0
  age                             0.0                0.0
  sexM                            0.0                0.0
               Contrasts
Levels          CF.LUMA_IVAvNON_CF.CTRL
  CF.IVA.M                          0.0
  CF.IVA.S                          0.0
  CF.LUMA_IVA.M                     0.5
  CF.LUMA_IVA.S                     0.5
  CF.NO_MOD.M                       0.0
  CF.NO_MOD.S                       0.0
  NON_CF.CTRL                      -1.0
  batch1                            0.0
  batch2                            0.0
  batch3                            0.0
  batch4                            0.0
  batch5                            0.0
  batch6                            0.0
  age                               0.0
  sexM                              0.0</code></pre>
<p>Add random effect for samples from the same individual.</p>
<pre class="r"><code>dupcor &lt;- duplicateCorrelation(props$TransformedProps, design=design,
                                block=participant)
dupcor</code></pre>
<pre><code>$consensus.correlation
[1] 0.6239257

$cor
[1] 0.6239257

$atanh.correlations
 [1]  0.80080074  1.27682941  0.70836292  1.46926384  0.63499798  1.30012069
 [7]  1.42121492  0.64466135  1.01553796  0.29787332  0.45725389  0.35069044
[13]  1.03135931  0.60024395 -0.53606034  0.04722491  0.38956524</code></pre>
<p>Fit the model.</p>
<pre class="r"><code>fit &lt;- lmFit(props$TransformedProps, design=design, block=participant, 
                correlation=dupcor$consensus)
fit2 &lt;- contrasts.fit(fit, contr)
fit2 &lt;- eBayes(fit2, robust=TRUE, trend=FALSE)
pvalue &lt;- 0.05
summary(decideTests(fit2, p.value = pvalue))</code></pre>
<pre><code>       CF.NO_MODvCF.IVA CF.NO_MODvCF.LUMA_IVA CF.NO_MOD.MvCF.NO_MOD.S
Down                  0                     0                       0
NotSig               17                    17                      17
Up                    0                     0                       0
       CF.NO_MODvNON_CF.CTRL CF.IVAvNON_CF.CTRL CF.LUMA_IVAvNON_CF.CTRL
Down                       0                  0                       0
NotSig                    16                 17                      17
Up                         1                  0                       0</code></pre>
<div id="results" class="section level2">
<h2>Results</h2>
<pre class="r"><code>p &lt;- vector(&quot;list&quot;, ncol(contr))

for(i in 1:ncol(contr)){
  print(knitr::kable(topTable(fit2, coef = i),
                     caption = colnames(contr)[i]))
  
  props$Proportions %&gt;% data.frame %&gt;%
    left_join(info,
              by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    mutate(Group = Group_severity) %&gt;%
    dplyr::filter(Group %in% names(contr[,i])[abs(contr[, i]) &gt; 0]) -&gt; dat
  
  if(length(unique(dat$Group)) &gt; 2) dat$Group &lt;- str_remove(dat$Group, &quot;.(M|S)$&quot;)
  ggplot(dat, aes(x = Group,
                  y = Freq,
                  colour = Group,
                  group = Group)) +
    geom_boxplot(outlier.shape = NA, colour = &quot;grey&quot;) +
    geom_jitter(stat = &quot;identity&quot;,
                width = 0.15,
                size = 2) +
    theme_classic() +
    theme(axis.text.x = element_text(angle = 90,
                                     hjust = 1,
                                     vjust = 0.5),
          legend.position = &quot;bottom&quot;,
          legend.direction = &quot;horizontal&quot;) +
    labs(x = &quot;Group&quot;, y = &quot;Proportion&quot;,
         colour = &quot;Condition&quot;) +
    facet_wrap(~clusters, scales = &quot;free_y&quot;, ncol = 4) +
    ggtitle(colnames(contr)[i]) -&gt; p[[i]]
  
  print(p[[i]])
}</code></pre>
<table>
<caption>CF.NO_MODvCF.IVA</caption>
<colgroup>
<col width="27%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-IFI27</td>
<td align="right">-0.0772602</td>
<td align="right">0.3007553</td>
<td align="right">-1.3692886</td>
<td align="right">0.1807087</td>
<td align="right">0.983121</td>
<td align="right">-4.907573</td>
</tr>
<tr class="even">
<td align="left">macro-IGF1</td>
<td align="right">0.0505640</td>
<td align="right">0.2016823</td>
<td align="right">1.2237763</td>
<td align="right">0.2302198</td>
<td align="right">0.983121</td>
<td align="right">-5.073126</td>
</tr>
<tr class="odd">
<td align="left">macro-CCL</td>
<td align="right">0.0797410</td>
<td align="right">0.2263490</td>
<td align="right">1.0799450</td>
<td align="right">0.2884639</td>
<td align="right">0.983121</td>
<td align="right">-5.220257</td>
</tr>
<tr class="even">
<td align="left">macro-MT</td>
<td align="right">-0.0285045</td>
<td align="right">0.1487592</td>
<td align="right">-0.9970053</td>
<td align="right">0.3263730</td>
<td align="right">0.983121</td>
<td align="right">-5.297472</td>
</tr>
<tr class="odd">
<td align="left">macro-CCL18</td>
<td align="right">0.0499042</td>
<td align="right">0.2540647</td>
<td align="right">0.9880788</td>
<td align="right">0.3307331</td>
<td align="right">0.983121</td>
<td align="right">-5.305370</td>
</tr>
<tr class="even">
<td align="left">macro-interstitial</td>
<td align="right">-0.0550669</td>
<td align="right">0.1522175</td>
<td align="right">-0.8773672</td>
<td align="right">0.3870091</td>
<td align="right">0.983121</td>
<td align="right">-5.398526</td>
</tr>
<tr class="odd">
<td align="left">macro-proliferating-G2M</td>
<td align="right">-0.0152719</td>
<td align="right">0.1237643</td>
<td align="right">-0.7806807</td>
<td align="right">0.4408268</td>
<td align="right">0.983121</td>
<td align="right">-5.471355</td>
</tr>
<tr class="even">
<td align="left">macro-alveolar</td>
<td align="right">0.0385831</td>
<td align="right">0.5919576</td>
<td align="right">0.5147923</td>
<td align="right">0.6103347</td>
<td align="right">0.983121</td>
<td align="right">-5.629028</td>
</tr>
<tr class="odd">
<td align="left">macro-T</td>
<td align="right">0.0061848</td>
<td align="right">0.1182567</td>
<td align="right">0.4021564</td>
<td align="right">0.6902890</td>
<td align="right">0.983121</td>
<td align="right">-5.676717</td>
</tr>
<tr class="even">
<td align="left">macro-monocyte-derived</td>
<td align="right">0.0154171</td>
<td align="right">0.2791111</td>
<td align="right">0.3543871</td>
<td align="right">0.7254385</td>
<td align="right">0.983121</td>
<td align="right">-5.693415</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-23-1.png" width="768" style="display: block; margin: auto;" /></p>
<table>
<caption>CF.NO_MODvCF.LUMA_IVA</caption>
<colgroup>
<col width="27%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-CCL18</td>
<td align="right">-0.1066688</td>
<td align="right">0.2540647</td>
<td align="right">-2.4765341</td>
<td align="right">0.0189042</td>
<td align="right">0.3213710</td>
<td align="right">-3.240610</td>
</tr>
<tr class="even">
<td align="left">macro-IGF1</td>
<td align="right">0.0617442</td>
<td align="right">0.2016823</td>
<td align="right">1.7523037</td>
<td align="right">0.0895689</td>
<td align="right">0.7613355</td>
<td align="right">-4.502771</td>
</tr>
<tr class="odd">
<td align="left">macro-lipid</td>
<td align="right">0.0669550</td>
<td align="right">0.2289080</td>
<td align="right">1.3174221</td>
<td align="right">0.1973129</td>
<td align="right">0.9545225</td>
<td align="right">-5.091744</td>
</tr>
<tr class="even">
<td align="left">macro-lipid-APOC2+</td>
<td align="right">0.0330901</td>
<td align="right">0.1152469</td>
<td align="right">0.9223003</td>
<td align="right">0.3634662</td>
<td align="right">0.9545225</td>
<td align="right">-5.496578</td>
</tr>
<tr class="odd">
<td align="left">macro-IFI27+CCL18+</td>
<td align="right">-0.0183941</td>
<td align="right">0.1008002</td>
<td align="right">-0.5090482</td>
<td align="right">0.6143083</td>
<td align="right">0.9545225</td>
<td align="right">-5.773949</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27+APOC2+</td>
<td align="right">0.0178241</td>
<td align="right">0.1468071</td>
<td align="right">0.4803683</td>
<td align="right">0.6343245</td>
<td align="right">0.9545225</td>
<td align="right">-5.787396</td>
</tr>
<tr class="odd">
<td align="left">macro-T</td>
<td align="right">0.0062990</td>
<td align="right">0.1182567</td>
<td align="right">0.4802746</td>
<td align="right">0.6343558</td>
<td align="right">0.9545225</td>
<td align="right">-5.787470</td>
</tr>
<tr class="even">
<td align="left">macro-proliferating-S</td>
<td align="right">-0.0094593</td>
<td align="right">0.1610808</td>
<td align="right">-0.4801454</td>
<td align="right">0.6344466</td>
<td align="right">0.9545225</td>
<td align="right">-5.787529</td>
</tr>
<tr class="odd">
<td align="left">macro-MT</td>
<td align="right">-0.0099350</td>
<td align="right">0.1487592</td>
<td align="right">-0.4074768</td>
<td align="right">0.6864188</td>
<td align="right">0.9545225</td>
<td align="right">-5.818136</td>
</tr>
<tr class="even">
<td align="left">macro-proliferating-G2M</td>
<td align="right">-0.0066590</td>
<td align="right">0.1237643</td>
<td align="right">-0.3991574</td>
<td align="right">0.6924747</td>
<td align="right">0.9545225</td>
<td align="right">-5.821325</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-23-2.png" width="768" style="display: block; margin: auto;" /></p>
<table>
<caption>CF.NO_MOD.MvCF.NO_MOD.S</caption>
<colgroup>
<col width="27%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-IFN</td>
<td align="right">0.0271627</td>
<td align="right">0.1102832</td>
<td align="right">2.0027903</td>
<td align="right">0.0538831</td>
<td align="right">0.6305075</td>
<td align="right">-4.137732</td>
</tr>
<tr class="even">
<td align="left">macro-monocyte-derived</td>
<td align="right">-0.0649346</td>
<td align="right">0.2791111</td>
<td align="right">-1.8476423</td>
<td align="right">0.0741774</td>
<td align="right">0.6305075</td>
<td align="right">-4.393307</td>
</tr>
<tr class="odd">
<td align="left">macro-proliferating-S</td>
<td align="right">0.0202295</td>
<td align="right">0.1610808</td>
<td align="right">1.0839516</td>
<td align="right">0.2866259</td>
<td align="right">0.8535663</td>
<td align="right">-5.392948</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27</td>
<td align="right">0.0489569</td>
<td align="right">0.3007553</td>
<td align="right">1.0740353</td>
<td align="right">0.2910628</td>
<td align="right">0.8535663</td>
<td align="right">-5.402790</td>
</tr>
<tr class="odd">
<td align="left">macro-MT</td>
<td align="right">-0.0218460</td>
<td align="right">0.1487592</td>
<td align="right">-0.9458464</td>
<td align="right">0.3514392</td>
<td align="right">0.8535663</td>
<td align="right">-5.523309</td>
</tr>
<tr class="even">
<td align="left">macro-interstitial</td>
<td align="right">-0.0389267</td>
<td align="right">0.1522175</td>
<td align="right">-0.7677221</td>
<td align="right">0.4484374</td>
<td align="right">0.8535663</td>
<td align="right">-5.666573</td>
</tr>
<tr class="odd">
<td align="left">macro-CCL18</td>
<td align="right">-0.0244336</td>
<td align="right">0.2540647</td>
<td align="right">-0.5988361</td>
<td align="right">0.5536158</td>
<td align="right">0.8535663</td>
<td align="right">-5.775934</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27+CCL18+</td>
<td align="right">-0.0202417</td>
<td align="right">0.1008002</td>
<td align="right">-0.5913447</td>
<td align="right">0.5585600</td>
<td align="right">0.8535663</td>
<td align="right">-5.780176</td>
</tr>
<tr class="odd">
<td align="left">macro-alveolar</td>
<td align="right">0.0355601</td>
<td align="right">0.5919576</td>
<td align="right">0.5873055</td>
<td align="right">0.5612351</td>
<td align="right">0.8535663</td>
<td align="right">-5.782441</td>
</tr>
<tr class="even">
<td align="left">macro-T</td>
<td align="right">0.0067967</td>
<td align="right">0.1182567</td>
<td align="right">0.5470588</td>
<td align="right">0.5881992</td>
<td align="right">0.8535663</td>
<td align="right">-5.804225</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-23-3.png" width="768" style="display: block; margin: auto;" /></p>
<table>
<caption>CF.NO_MODvNON_CF.CTRL</caption>
<colgroup>
<col width="27%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-IGF1</td>
<td align="right">0.1238936</td>
<td align="right">0.2016823</td>
<td align="right">3.5143548</td>
<td align="right">0.0013738</td>
<td align="right">0.0233541</td>
<td align="right">-1.078640</td>
</tr>
<tr class="even">
<td align="left">macro-IFN</td>
<td align="right">0.0236105</td>
<td align="right">0.1102832</td>
<td align="right">1.6483086</td>
<td align="right">0.1092447</td>
<td align="right">0.8171448</td>
<td align="right">-4.896312</td>
</tr>
<tr class="odd">
<td align="left">macro-lipid</td>
<td align="right">0.0753321</td>
<td align="right">0.2289080</td>
<td align="right">1.4815109</td>
<td align="right">0.1485239</td>
<td align="right">0.8171448</td>
<td align="right">-5.134942</td>
</tr>
<tr class="even">
<td align="left">macro-CCL</td>
<td align="right">-0.0839676</td>
<td align="right">0.2263490</td>
<td align="right">-1.3328079</td>
<td align="right">0.1922694</td>
<td align="right">0.8171448</td>
<td align="right">-5.328955</td>
</tr>
<tr class="odd">
<td align="left">macro-IFI27</td>
<td align="right">-0.0397423</td>
<td align="right">0.3007553</td>
<td align="right">-0.8255214</td>
<td align="right">0.4153581</td>
<td align="right">0.8506807</td>
<td align="right">-5.848981</td>
</tr>
<tr class="even">
<td align="left">macro-interstitial</td>
<td align="right">0.0427504</td>
<td align="right">0.1522175</td>
<td align="right">0.7983011</td>
<td align="right">0.4307447</td>
<td align="right">0.8506807</td>
<td align="right">-5.870365</td>
</tr>
<tr class="odd">
<td align="left">macro-T</td>
<td align="right">-0.0104680</td>
<td align="right">0.1182567</td>
<td align="right">-0.7977494</td>
<td align="right">0.4309980</td>
<td align="right">0.8506807</td>
<td align="right">-5.870858</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27+APOC2+</td>
<td align="right">-0.0242895</td>
<td align="right">0.1468071</td>
<td align="right">-0.6542859</td>
<td align="right">0.5177331</td>
<td align="right">0.8506807</td>
<td align="right">-5.971994</td>
</tr>
<tr class="odd">
<td align="left">macro-monocyte-derived</td>
<td align="right">-0.0228342</td>
<td align="right">0.2791111</td>
<td align="right">-0.6151733</td>
<td align="right">0.5429121</td>
<td align="right">0.8506807</td>
<td align="right">-5.996219</td>
</tr>
<tr class="even">
<td align="left">macro-alveolar</td>
<td align="right">0.0359628</td>
<td align="right">0.5919576</td>
<td align="right">0.5623725</td>
<td align="right">0.5778902</td>
<td align="right">0.8506807</td>
<td align="right">-6.026609</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-23-4.png" width="768" style="display: block; margin: auto;" /></p>
<table>
<caption>CF.IVAvNON_CF.CTRL</caption>
<colgroup>
<col width="27%" />
<col width="12%" />
<col width="11%" />
<col width="12%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-CCL</td>
<td align="right">-0.1637086</td>
<td align="right">0.2263490</td>
<td align="right">-2.2031311</td>
<td align="right">0.0351144</td>
<td align="right">0.5969454</td>
<td align="right">-3.666995</td>
</tr>
<tr class="even">
<td align="left">macro-IGF1</td>
<td align="right">0.0733297</td>
<td align="right">0.2016823</td>
<td align="right">1.7635562</td>
<td align="right">0.0876219</td>
<td align="right">0.7447863</td>
<td align="right">-4.376015</td>
</tr>
<tr class="odd">
<td align="left">macro-interstitial</td>
<td align="right">0.0978174</td>
<td align="right">0.1522175</td>
<td align="right">1.5486572</td>
<td align="right">0.1315729</td>
<td align="right">0.7455796</td>
<td align="right">-4.677054</td>
</tr>
<tr class="even">
<td align="left">macro-lipid</td>
<td align="right">0.0816477</td>
<td align="right">0.2289080</td>
<td align="right">1.3613888</td>
<td align="right">0.1831651</td>
<td align="right">0.7784517</td>
<td align="right">-4.912357</td>
</tr>
<tr class="odd">
<td align="left">macro-IFN</td>
<td align="right">0.0185495</td>
<td align="right">0.1102832</td>
<td align="right">1.0979399</td>
<td align="right">0.2805653</td>
<td align="right">0.8220100</td>
<td align="right">-5.197827</td>
</tr>
<tr class="even">
<td align="left">macro-T</td>
<td align="right">-0.0166528</td>
<td align="right">0.1182567</td>
<td align="right">-1.0759794</td>
<td align="right">0.2901212</td>
<td align="right">0.8220100</td>
<td align="right">-5.219109</td>
</tr>
<tr class="odd">
<td align="left">macro-MT</td>
<td align="right">0.0255988</td>
<td align="right">0.1487592</td>
<td align="right">0.8897154</td>
<td align="right">0.3803755</td>
<td align="right">0.8265480</td>
<td align="right">-5.383474</td>
</tr>
<tr class="even">
<td align="left">macro-monocyte-derived</td>
<td align="right">-0.0382513</td>
<td align="right">0.2791111</td>
<td align="right">-0.8737168</td>
<td align="right">0.3889638</td>
<td align="right">0.8265480</td>
<td align="right">-5.396162</td>
</tr>
<tr class="odd">
<td align="left">macro-IFI27</td>
<td align="right">0.0375179</td>
<td align="right">0.3007553</td>
<td align="right">0.6607333</td>
<td align="right">0.5136442</td>
<td align="right">0.8408146</td>
<td align="right">-5.544782</td>
</tr>
<tr class="even">
<td align="left">macro-lipid-APOC2+</td>
<td align="right">0.0268312</td>
<td align="right">0.1152469</td>
<td align="right">0.6337387</td>
<td align="right">0.5308811</td>
<td align="right">0.8408146</td>
<td align="right">-5.560773</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-23-5.png" width="768" style="display: block; margin: auto;" /></p>
<table>
<caption>CF.LUMA_IVAvNON_CF.CTRL</caption>
<colgroup>
<col width="26%" />
<col width="13%" />
<col width="11%" />
<col width="13%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">macro-CCL18</td>
<td align="right">0.1303531</td>
<td align="right">0.2540647</td>
<td align="right">2.3049452</td>
<td align="right">0.0280006</td>
<td align="right">0.4760098</td>
<td align="right">-3.448066</td>
</tr>
<tr class="even">
<td align="left">macro-IGF1</td>
<td align="right">0.0621495</td>
<td align="right">0.2016823</td>
<td align="right">1.3433307</td>
<td align="right">0.1888776</td>
<td align="right">0.9451149</td>
<td align="right">-4.858046</td>
</tr>
<tr class="odd">
<td align="left">macro-IFN</td>
<td align="right">0.0237028</td>
<td align="right">0.1102832</td>
<td align="right">1.2609030</td>
<td align="right">0.2166172</td>
<td align="right">0.9451149</td>
<td align="right">-4.949804</td>
</tr>
<tr class="even">
<td align="left">macro-CCL</td>
<td align="right">-0.1029454</td>
<td align="right">0.2263490</td>
<td align="right">-1.2451209</td>
<td align="right">0.2223800</td>
<td align="right">0.9451149</td>
<td align="right">-4.966753</td>
</tr>
<tr class="odd">
<td align="left">macro-T</td>
<td align="right">-0.0167670</td>
<td align="right">0.1182567</td>
<td align="right">-0.9736580</td>
<td align="right">0.3376557</td>
<td align="right">0.9572141</td>
<td align="right">-5.228228</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27+APOC2+</td>
<td align="right">-0.0421136</td>
<td align="right">0.1468071</td>
<td align="right">-0.8644118</td>
<td align="right">0.3939746</td>
<td align="right">0.9572141</td>
<td align="right">-5.316545</td>
</tr>
<tr class="odd">
<td align="left">macro-interstitial</td>
<td align="right">0.0534938</td>
<td align="right">0.1522175</td>
<td align="right">0.7611648</td>
<td align="right">0.4522870</td>
<td align="right">0.9572141</td>
<td align="right">-5.390896</td>
</tr>
<tr class="even">
<td align="left">macro-IFI27</td>
<td align="right">-0.0450603</td>
<td align="right">0.3007553</td>
<td align="right">-0.7132112</td>
<td align="right">0.4810285</td>
<td align="right">0.9572141</td>
<td align="right">-5.422349</td>
</tr>
<tr class="odd">
<td align="left">macro-alveolar</td>
<td align="right">0.0528250</td>
<td align="right">0.5919576</td>
<td align="right">0.6294479</td>
<td align="right">0.5336491</td>
<td align="right">0.9572141</td>
<td align="right">-5.472545</td>
</tr>
<tr class="even">
<td align="left">macro-proliferating-S</td>
<td align="right">0.0098729</td>
<td align="right">0.1610808</td>
<td align="right">0.3816720</td>
<td align="right">0.7052712</td>
<td align="right">0.9572141</td>
<td align="right">-5.585109</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.2_proportions_analysis_ann_level_3_macrophages.Rmd/unnamed-chunk-23-6.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="session-info" class="section level1 appendix">
<h1 class="appendix">Session info</h1>
<summary>
The analysis and this document were prepared using the following
software (click triangle to expand)
</summary>
<details>
<pre class="r"><code>sessioninfo::session_info()</code></pre>
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.3 (2024-02-29)
 os       Ubuntu 22.04.4 LTS
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  en_AU.UTF-8
 ctype    en_AU.UTF-8
 tz       Etc/UTC
 date     2024-09-10
 pandoc   3.1.1 @ /usr/lib/rstudio-server/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 ! package              * version    date (UTC) lib source
 P abind                  1.4-5      2016-07-21 [?] RSPM (R 4.3.0)
 P AnnotationDbi        * 1.64.1     2023-11-03 [?] Bioconductor
 P backports              1.4.1      2021-12-13 [?] RSPM (R 4.3.0)
 P base64enc              0.1-3      2015-07-28 [?] RSPM (R 4.3.0)
 P Biobase              * 2.62.0     2023-10-24 [?] Bioconductor
 P BiocGenerics         * 0.48.1     2023-11-01 [?] Bioconductor
 P BiocManager            1.30.22    2023-08-08 [?] RSPM (R 4.3.0)
 P Biostrings             2.70.2     2024-01-28 [?] Bioconductor 3.18 (R 4.3.3)
 P bit                    4.0.5      2022-11-15 [?] RSPM (R 4.3.0)
 P bit64                  4.0.5      2020-08-30 [?] RSPM (R 4.3.0)
 P bitops                 1.0-7      2021-04-24 [?] RSPM (R 4.3.0)
 P blob                   1.2.4      2023-03-17 [?] RSPM (R 4.3.0)
 P bslib                  0.6.1      2023-11-28 [?] RSPM (R 4.3.0)
 P cachem                 1.0.8      2023-05-01 [?] RSPM (R 4.3.0)
 P callr                  3.7.3      2022-11-02 [?] RSPM (R 4.3.0)
 P checkmate              2.3.1      2023-12-04 [?] RSPM (R 4.3.0)
 P circlize               0.4.15     2022-05-10 [?] RSPM (R 4.3.0)
 P cli                    3.6.2      2023-12-11 [?] RSPM (R 4.3.0)
 P clue                   0.3-65     2023-09-23 [?] RSPM (R 4.3.0)
 P cluster                2.1.6      2023-12-01 [?] CRAN (R 4.3.2)
 P clustree             * 0.5.1      2023-11-05 [?] RSPM (R 4.3.0)
 P codetools              0.2-19     2023-02-01 [?] CRAN (R 4.2.2)
 P colorspace             2.1-0      2023-01-23 [?] RSPM (R 4.3.0)
 P ComplexHeatmap         2.18.0     2023-10-24 [?] Bioconductor
 P cowplot                1.1.3      2024-01-22 [?] RSPM (R 4.3.0)
 P crayon                 1.5.2      2022-09-29 [?] RSPM (R 4.3.0)
 P data.table             1.15.0     2024-01-30 [?] RSPM (R 4.3.0)
 P DBI                    1.2.1      2024-01-12 [?] RSPM (R 4.3.0)
 P DelayedArray           0.28.0     2023-10-24 [?] Bioconductor
 P deldir                 2.0-2      2023-11-23 [?] RSPM (R 4.3.0)
 P dendextend             1.17.1     2023-03-25 [?] RSPM (R 4.3.0)
 P digest                 0.6.34     2024-01-11 [?] RSPM (R 4.3.0)
 P dittoSeq             * 1.14.2     2024-02-09 [?] Bioconductor 3.18 (R 4.3.3)
 P doParallel             1.0.17     2022-02-07 [?] RSPM (R 4.3.0)
 P dplyr                * 1.1.4      2023-11-17 [?] RSPM (R 4.3.0)
 P dynamicTreeCut         1.63-1     2016-03-11 [?] RSPM (R 4.3.0)
 P edgeR                * 4.0.15     2024-02-11 [?] Bioconductor 3.18 (R 4.3.3)
 P ellipsis               0.3.2      2021-04-29 [?] RSPM (R 4.3.0)
 P evaluate               0.23       2023-11-01 [?] RSPM (R 4.3.0)
 P fansi                  1.0.6      2023-12-08 [?] RSPM (R 4.3.0)
 P farver                 2.1.1      2022-07-06 [?] RSPM (R 4.3.0)
 P fastcluster            1.2.6      2024-01-12 [?] RSPM (R 4.3.0)
 P fastmap                1.1.1      2023-02-24 [?] RSPM (R 4.3.0)
 P fitdistrplus           1.1-11     2023-04-25 [?] RSPM (R 4.3.0)
 P forcats              * 1.0.0      2023-01-29 [?] RSPM (R 4.3.0)
 P foreach                1.5.2      2022-02-02 [?] RSPM (R 4.3.0)
 P foreign                0.8-86     2023-11-28 [?] CRAN (R 4.3.2)
 P Formula                1.2-5      2023-02-24 [?] RSPM (R 4.3.0)
 P fs                     1.6.3      2023-07-20 [?] RSPM (R 4.3.0)
 P future                 1.33.1     2023-12-22 [?] RSPM (R 4.3.0)
 P future.apply           1.11.1     2023-12-21 [?] RSPM (R 4.3.0)
 P generics               0.1.3      2022-07-05 [?] RSPM (R 4.3.0)
 P GenomeInfoDb         * 1.38.6     2024-02-08 [?] Bioconductor 3.18 (R 4.3.3)
 P GenomeInfoDbData       1.2.11     2024-04-23 [?] Bioconductor
 P GenomicRanges        * 1.54.1     2023-10-29 [?] Bioconductor
 P GetoptLong             1.0.5      2020-12-15 [?] RSPM (R 4.3.0)
 P getPass                0.2-4      2023-12-10 [?] RSPM (R 4.3.0)
 P ggforce                0.4.2      2024-02-19 [?] RSPM (R 4.3.0)
 P ggplot2              * 3.5.0      2024-02-23 [?] RSPM (R 4.3.0)
 P ggraph               * 2.2.0      2024-02-27 [?] RSPM (R 4.3.0)
 P ggrepel                0.9.5      2024-01-10 [?] RSPM (R 4.3.0)
 P ggridges               0.5.6      2024-01-23 [?] RSPM (R 4.3.0)
 P git2r                  0.33.0     2023-11-26 [?] RSPM (R 4.3.0)
 P glmGamPoi            * 1.14.3     2024-02-11 [?] Bioconductor 3.18 (R 4.3.3)
 P GlobalOptions          0.1.2      2020-06-10 [?] RSPM (R 4.3.0)
 P globals                0.16.2     2022-11-21 [?] RSPM (R 4.3.0)
 P glue                 * 1.7.0      2024-01-09 [?] RSPM (R 4.3.0)
 P GO.db                  3.18.0     2024-04-23 [?] Bioconductor
 P goftest                1.2-3      2021-10-07 [?] RSPM (R 4.3.0)
 P graphlayouts           1.1.0      2024-01-19 [?] RSPM (R 4.3.0)
 P gridExtra              2.3        2017-09-09 [?] RSPM (R 4.3.0)
 P gtable                 0.3.4      2023-08-21 [?] RSPM (R 4.3.0)
 P here                 * 1.0.1      2020-12-13 [?] RSPM (R 4.3.0)
 P highr                  0.10       2022-12-22 [?] RSPM (R 4.3.0)
 P Hmisc                  5.1-1      2023-09-12 [?] RSPM (R 4.3.0)
 P hms                    1.1.3      2023-03-21 [?] RSPM (R 4.3.0)
 P htmlTable              2.4.2      2023-10-29 [?] RSPM (R 4.3.0)
 P htmltools              0.5.7      2023-11-03 [?] RSPM (R 4.3.0)
 P htmlwidgets            1.6.4      2023-12-06 [?] RSPM (R 4.3.0)
 P httpuv                 1.6.14     2024-01-26 [?] RSPM (R 4.3.0)
 P httr                   1.4.7      2023-08-15 [?] RSPM (R 4.3.0)
 P ica                    1.0-3      2022-07-08 [?] RSPM (R 4.3.0)
 P igraph                 2.0.1.1    2024-01-30 [?] RSPM (R 4.3.0)
 P impute                 1.76.0     2023-10-24 [?] Bioconductor
 P IRanges              * 2.36.0     2023-10-24 [?] Bioconductor
 P irlba                  2.3.5.1    2022-10-03 [?] RSPM (R 4.3.0)
 P iterators              1.0.14     2022-02-05 [?] RSPM (R 4.3.0)
 P jquerylib              0.1.4      2021-04-26 [?] RSPM (R 4.3.0)
 P jsonlite               1.8.8      2023-12-04 [?] RSPM (R 4.3.0)
 P KEGGREST               1.42.0     2023-10-24 [?] Bioconductor
 P KernSmooth             2.23-24    2024-05-17 [?] RSPM (R 4.3.0)
 P knitr                  1.45       2023-10-30 [?] RSPM (R 4.3.0)
 P labeling               0.4.3      2023-08-29 [?] RSPM (R 4.3.0)
 P later                  1.3.2      2023-12-06 [?] RSPM (R 4.3.0)
 P lattice                0.22-5     2023-10-24 [?] CRAN (R 4.3.1)
 P lazyeval               0.2.2      2019-03-15 [?] RSPM (R 4.3.0)
 P leiden                 0.4.3.1    2023-11-17 [?] RSPM (R 4.3.0)
 P lifecycle              1.0.4      2023-11-07 [?] RSPM (R 4.3.0)
 P limma                * 3.58.1     2023-10-31 [?] Bioconductor
 P listenv                0.9.1      2024-01-29 [?] RSPM (R 4.3.0)
 P lmtest                 0.9-40     2022-03-21 [?] RSPM (R 4.3.0)
 P locfit                 1.5-9.8    2023-06-11 [?] RSPM (R 4.3.0)
 P lubridate            * 1.9.3      2023-09-27 [?] RSPM (R 4.3.0)
 P magrittr               2.0.3      2022-03-30 [?] RSPM (R 4.3.0)
 P MASS                   7.3-60.0.1 2024-01-13 [?] RSPM (R 4.3.0)
 P Matrix                 1.6-5      2024-01-11 [?] CRAN (R 4.3.3)
 P MatrixGenerics       * 1.14.0     2023-10-24 [?] Bioconductor
 P matrixStats          * 1.2.0      2023-12-11 [?] RSPM (R 4.3.0)
 P memoise                2.0.1      2021-11-26 [?] RSPM (R 4.3.0)
 P mime                   0.12       2021-09-28 [?] RSPM (R 4.3.0)
 P miniUI                 0.1.1.1    2018-05-18 [?] RSPM (R 4.3.0)
 P munsell                0.5.0      2018-06-12 [?] RSPM (R 4.3.0)
 P nlme                   3.1-164    2023-11-27 [?] RSPM (R 4.3.0)
 P nnet                   7.3-19     2023-05-03 [?] CRAN (R 4.3.1)
 P org.Hs.eg.db         * 3.18.0     2024-04-23 [?] Bioconductor
 P paletteer            * 1.6.0      2024-01-21 [?] RSPM (R 4.3.0)
 P parallelly             1.37.0     2024-02-14 [?] RSPM (R 4.3.0)
 P patchwork            * 1.2.0      2024-01-08 [?] RSPM (R 4.3.0)
 P pbapply                1.7-2      2023-06-27 [?] RSPM (R 4.3.0)
 P pheatmap               1.0.12     2019-01-04 [?] RSPM (R 4.3.0)
 P pillar                 1.9.0      2023-03-22 [?] RSPM (R 4.3.0)
 P pkgconfig              2.0.3      2019-09-22 [?] RSPM (R 4.3.0)
 P plotly                 4.10.4     2024-01-13 [?] RSPM (R 4.3.0)
 P plyr                   1.8.9      2023-10-02 [?] RSPM (R 4.3.0)
 P png                    0.1-8      2022-11-29 [?] RSPM (R 4.3.0)
 P polyclip               1.10-6     2023-09-27 [?] RSPM (R 4.3.0)
 P preprocessCore         1.64.0     2023-10-24 [?] Bioconductor
 P prismatic              1.1.1      2022-08-15 [?] RSPM (R 4.3.0)
 P processx               3.8.3      2023-12-10 [?] RSPM (R 4.3.0)
 P progressr              0.14.0     2023-08-10 [?] RSPM (R 4.3.0)
 P promises               1.2.1      2023-08-10 [?] RSPM (R 4.3.0)
 P ps                     1.7.6      2024-01-18 [?] RSPM (R 4.3.0)
 P purrr                * 1.0.2      2023-08-10 [?] RSPM (R 4.3.0)
 P R6                     2.5.1      2021-08-19 [?] RSPM (R 4.3.0)
 P RANN                   2.6.1      2019-01-08 [?] RSPM (R 4.3.0)
 P RColorBrewer           1.1-3      2022-04-03 [?] RSPM (R 4.3.0)
 P Rcpp                   1.0.12     2024-01-09 [?] RSPM (R 4.3.0)
 P RcppAnnoy              0.0.22     2024-01-23 [?] RSPM (R 4.3.0)
 P RCurl                  1.98-1.14  2024-01-09 [?] RSPM (R 4.3.0)
 P readr                * 2.1.5      2024-01-10 [?] RSPM (R 4.3.0)
 P rematch2               2.1.2      2020-05-01 [?] RSPM (R 4.3.0)
   renv                   1.0.3      2023-09-19 [1] CRAN (R 4.3.3)
 P reshape2               1.4.4      2020-04-09 [?] RSPM (R 4.3.0)
 P reticulate             1.35.0     2024-01-31 [?] RSPM (R 4.3.0)
 P rjson                  0.2.21     2022-01-09 [?] RSPM (R 4.3.0)
 P rlang                  1.1.3      2024-01-10 [?] RSPM (R 4.3.0)
 P rmarkdown              2.25       2023-09-18 [?] RSPM (R 4.3.0)
 P ROCR                   1.0-11     2020-05-02 [?] RSPM (R 4.3.0)
 P rpart                  4.1.23     2023-12-05 [?] RSPM (R 4.3.0)
 P rprojroot              2.0.4      2023-11-05 [?] RSPM (R 4.3.0)
 P RSQLite                2.3.5      2024-01-21 [?] RSPM (R 4.3.0)
 P rstudioapi             0.15.0     2023-07-07 [?] RSPM (R 4.3.0)
 P Rtsne                  0.17       2023-12-07 [?] RSPM (R 4.3.0)
 P S4Arrays               1.2.0      2023-10-24 [?] Bioconductor
 P S4Vectors            * 0.40.2     2023-11-23 [?] Bioconductor 3.18 (R 4.3.3)
 P sass                   0.4.8      2023-12-06 [?] RSPM (R 4.3.0)
 P scales                 1.3.0      2023-11-28 [?] RSPM (R 4.3.0)
 P scattermore            1.2        2023-06-12 [?] RSPM (R 4.3.0)
   sctransform            0.4.1      2023-10-19 [1] RSPM (R 4.3.0)
 P sessioninfo            1.2.2      2021-12-06 [?] RSPM (R 4.3.0)
   Seurat               * 4.4.0      2024-04-25 [1] https://satijalab.r-universe.dev (R 4.3.3)
   SeuratObject         * 4.1.4      2024-04-25 [1] https://satijalab.r-universe.dev (R 4.3.3)
 P shape                  1.4.6      2021-05-19 [?] RSPM (R 4.3.0)
 P shiny                  1.8.0      2023-11-17 [?] RSPM (R 4.3.0)
 P SingleCellExperiment * 1.24.0     2023-10-24 [?] Bioconductor
 P sp                     2.1-3      2024-01-30 [?] RSPM (R 4.3.0)
 P SparseArray            1.2.4      2024-02-11 [?] Bioconductor 3.18 (R 4.3.3)
 P spatstat.data          3.0-4      2024-01-15 [?] RSPM (R 4.3.0)
 P spatstat.explore       3.2-6      2024-02-01 [?] RSPM (R 4.3.0)
 P spatstat.geom          3.2-8      2024-01-26 [?] RSPM (R 4.3.0)
 P spatstat.random        3.2-2      2023-11-29 [?] RSPM (R 4.3.0)
 P spatstat.sparse        3.0-3      2023-10-24 [?] RSPM (R 4.3.0)
 P spatstat.utils         3.0-4      2023-10-24 [?] RSPM (R 4.3.0)
 P speckle              * 1.2.0      2023-10-24 [?] Bioconductor
 P statmod                1.5.0      2023-01-06 [?] RSPM (R 4.3.0)
 P stringi                1.8.3      2023-12-11 [?] RSPM (R 4.3.0)
 P stringr              * 1.5.1      2023-11-14 [?] RSPM (R 4.3.0)
 P SummarizedExperiment * 1.32.0     2023-10-24 [?] Bioconductor
 P survival               3.7-0      2024-06-05 [?] RSPM (R 4.3.0)
 P tensor                 1.5        2012-05-05 [?] RSPM (R 4.3.0)
 P tibble               * 3.2.1      2023-03-20 [?] RSPM (R 4.3.0)
 P tidygraph              1.3.1      2024-01-30 [?] RSPM (R 4.3.0)
 P tidyHeatmap          * 1.8.1      2022-05-20 [?] RSPM (R 4.3.3)
 P tidyr                * 1.3.1      2024-01-24 [?] RSPM (R 4.3.0)
 P tidyselect             1.2.0      2022-10-10 [?] RSPM (R 4.3.0)
 P tidyverse            * 2.0.0      2023-02-22 [?] RSPM (R 4.3.0)
 P timechange             0.3.0      2024-01-18 [?] RSPM (R 4.3.0)
 P tweenr                 2.0.3      2024-02-26 [?] RSPM (R 4.3.0)
 P tzdb                   0.4.0      2023-05-12 [?] RSPM (R 4.3.0)
 P utf8                   1.2.4      2023-10-22 [?] RSPM (R 4.3.0)
 P uwot                   0.1.16     2023-06-29 [?] RSPM (R 4.3.0)
 P vctrs                  0.6.5      2023-12-01 [?] RSPM (R 4.3.0)
 P viridis                0.6.5      2024-01-29 [?] RSPM (R 4.3.0)
 P viridisLite            0.4.2      2023-05-02 [?] RSPM (R 4.3.0)
 P WGCNA                  1.72-5     2023-12-07 [?] RSPM (R 4.3.3)
 P whisker                0.4.1      2022-12-05 [?] RSPM (R 4.3.0)
 P withr                  3.0.0      2024-01-16 [?] RSPM (R 4.3.0)
 P workflowr            * 1.7.1      2023-08-23 [?] RSPM (R 4.3.0)
 P xfun                   0.42       2024-02-08 [?] RSPM (R 4.3.0)
 P xtable                 1.8-4      2019-04-21 [?] RSPM (R 4.3.0)
 P XVector                0.42.0     2023-10-24 [?] Bioconductor
 P yaml                   2.3.8      2023-12-11 [?] RSPM (R 4.3.0)
 P zlibbioc               1.48.0     2023-10-24 [?] Bioconductor
 P zoo                    1.8-12     2023-04-13 [?] RSPM (R 4.3.0)

 [1] /mnt/allandata/jovana_data/paed-inflammation-CITEseq/renv/library/R-4.3/x86_64-pc-linux-gnu
 [2] /home/jovana/.cache/R/renv/sandbox/R-4.3/x86_64-pc-linux-gnu/9a444a72

 P ── Loaded and on-disk path mismatch.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</details>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.4 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

time zone: Etc/UTC
tzcode source: system (glibc)

attached base packages:
[1] stats4    stats     graphics  grDevices datasets  utils     methods  
[8] base     

other attached packages:
 [1] here_1.0.1                  tidyHeatmap_1.8.1          
 [3] paletteer_1.6.0             patchwork_1.2.0            
 [5] speckle_1.2.0               glue_1.7.0                 
 [7] org.Hs.eg.db_3.18.0         AnnotationDbi_1.64.1       
 [9] clustree_0.5.1              ggraph_2.2.0               
[11] dittoSeq_1.14.2             glmGamPoi_1.14.3           
[13] SeuratObject_4.1.4          Seurat_4.4.0               
[15] lubridate_1.9.3             forcats_1.0.0              
[17] stringr_1.5.1               dplyr_1.1.4                
[19] purrr_1.0.2                 readr_2.1.5                
[21] tidyr_1.3.1                 tibble_3.2.1               
[23] ggplot2_3.5.0               tidyverse_2.0.0            
[25] edgeR_4.0.15                limma_3.58.1               
[27] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0
[29] Biobase_2.62.0              GenomicRanges_1.54.1       
[31] GenomeInfoDb_1.38.6         IRanges_2.36.0             
[33] S4Vectors_0.40.2            BiocGenerics_0.48.1        
[35] MatrixGenerics_1.14.0       matrixStats_1.2.0          
[37] workflowr_1.7.1            

loaded via a namespace (and not attached):
  [1] fs_1.6.3                spatstat.sparse_3.0-3   bitops_1.0-7           
  [4] httr_1.4.7              RColorBrewer_1.1-3      doParallel_1.0.17      
  [7] dynamicTreeCut_1.63-1   backports_1.4.1         tools_4.3.3            
 [10] sctransform_0.4.1       utf8_1.2.4              R6_2.5.1               
 [13] lazyeval_0.2.2          uwot_0.1.16             GetoptLong_1.0.5       
 [16] withr_3.0.0             sp_2.1-3                gridExtra_2.3          
 [19] preprocessCore_1.64.0   progressr_0.14.0        WGCNA_1.72-5           
 [22] cli_3.6.2               spatstat.explore_3.2-6  labeling_0.4.3         
 [25] sass_0.4.8              prismatic_1.1.1         spatstat.data_3.0-4    
 [28] ggridges_0.5.6          pbapply_1.7-2           foreign_0.8-86         
 [31] sessioninfo_1.2.2       parallelly_1.37.0       impute_1.76.0          
 [34] rstudioapi_0.15.0       RSQLite_2.3.5           generics_0.1.3         
 [37] shape_1.4.6             ica_1.0-3               spatstat.random_3.2-2  
 [40] dendextend_1.17.1       GO.db_3.18.0            Matrix_1.6-5           
 [43] fansi_1.0.6             abind_1.4-5             lifecycle_1.0.4        
 [46] whisker_0.4.1           yaml_2.3.8              SparseArray_1.2.4      
 [49] Rtsne_0.17              grid_4.3.3              blob_1.2.4             
 [52] promises_1.2.1          crayon_1.5.2            miniUI_0.1.1.1         
 [55] lattice_0.22-5          cowplot_1.1.3           KEGGREST_1.42.0        
 [58] pillar_1.9.0            knitr_1.45              ComplexHeatmap_2.18.0  
 [61] rjson_0.2.21            future.apply_1.11.1     codetools_0.2-19       
 [64] leiden_0.4.3.1          getPass_0.2-4           data.table_1.15.0      
 [67] vctrs_0.6.5             png_0.1-8               gtable_0.3.4           
 [70] rematch2_2.1.2          cachem_1.0.8            xfun_0.42              
 [73] S4Arrays_1.2.0          mime_0.12               tidygraph_1.3.1        
 [76] survival_3.7-0          pheatmap_1.0.12         iterators_1.0.14       
 [79] statmod_1.5.0           ellipsis_0.3.2          fitdistrplus_1.1-11    
 [82] ROCR_1.0-11             nlme_3.1-164            bit64_4.0.5            
 [85] RcppAnnoy_0.0.22        rprojroot_2.0.4         bslib_0.6.1            
 [88] irlba_2.3.5.1           rpart_4.1.23            KernSmooth_2.23-24     
 [91] Hmisc_5.1-1             colorspace_2.1-0        DBI_1.2.1              
 [94] nnet_7.3-19             tidyselect_1.2.0        processx_3.8.3         
 [97] bit_4.0.5               compiler_4.3.3          git2r_0.33.0           
[100] htmlTable_2.4.2         DelayedArray_0.28.0     plotly_4.10.4          
[103] checkmate_2.3.1         scales_1.3.0            lmtest_0.9-40          
[106] callr_3.7.3             digest_0.6.34           goftest_1.2-3          
[109] spatstat.utils_3.0-4    rmarkdown_2.25          XVector_0.42.0         
[112] base64enc_0.1-3         htmltools_0.5.7         pkgconfig_2.0.3        
[115] highr_0.10              fastmap_1.1.1           rlang_1.1.3            
[118] GlobalOptions_0.1.2     htmlwidgets_1.6.4       shiny_1.8.0            
[121] farver_2.1.1            jquerylib_0.1.4         zoo_1.8-12             
[124] jsonlite_1.8.8          RCurl_1.98-1.14         magrittr_2.0.3         
[127] Formula_1.2-5           GenomeInfoDbData_1.2.11 munsell_0.5.0          
[130] Rcpp_1.0.12             viridis_0.6.5           reticulate_1.35.0      
[133] stringi_1.8.3           zlibbioc_1.48.0         MASS_7.3-60.0.1        
[136] plyr_1.8.9              parallel_4.3.3          listenv_0.9.1          
[139] ggrepel_0.9.5           deldir_2.0-2            Biostrings_2.70.2      
[142] graphlayouts_1.1.0      splines_4.3.3           tensor_1.5             
[145] hms_1.1.3               circlize_0.4.15         locfit_1.5-9.8         
[148] ps_1.7.6                fastcluster_1.2.6       igraph_2.0.1.1         
[151] spatstat.geom_3.2-8     reshape2_1.4.4          evaluate_0.23          
[154] renv_1.0.3              BiocManager_1.30.22     tzdb_0.4.0             
[157] foreach_1.5.2           tweenr_2.0.3            httpuv_1.6.14          
[160] RANN_2.6.1              polyclip_1.10-6         future_1.33.1          
[163] clue_0.3-65             scattermore_1.2         ggforce_0.4.2          
[166] xtable_1.8-4            later_1.3.2             viridisLite_0.4.2      
[169] memoise_2.0.1           cluster_2.1.6           timechange_0.3.0       
[172] globals_0.16.2         </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
