<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Jovana Maksimovic" />

<meta name="date" content="2024-09-09" />

<title>Inflammation of Paediatric Pulmonary Diseases</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">paed-inflammation-CITEseq</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Inflammation of Paediatric Pulmonary
Diseases</h1>
<h3 class="subtitle">Cell type proportions analysis - broad labels</h3>
<h4 class="author">Jovana Maksimovic</h4>
<h4 class="date">September 09, 2024</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-09-09
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>paed-inflammation-CITEseq/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20240216code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20240216)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20240216code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20240216)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsatlassianpetermacorgaubitbucketscmospaedinflammationciteseqtreeb6be5d650ebc6624df7cdd534af6c676dd187c43targetblankb6be5d6a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/tree/b6be5d650ebc6624df7cdd534af6c676dd187c43" target="_blank">b6be5d6</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsatlassianpetermacorgaubitbucketscmospaedinflammationciteseqtreeb6be5d650ebc6624df7cdd534af6c676dd187c43targetblankb6be5d6a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/tree/b6be5d650ebc6624df7cdd534af6c676dd187c43" target="_blank">b6be5d6</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    data/C133_Neeland_batch1/
    Ignored:    data/C133_Neeland_merged/
    Ignored:    renv/library/
    Ignored:    renv/staging/

Untracked files:
    Untracked:  analysis/13.0_DGE_analysis_macro-alveolar_cells_CF-only-samples_OLD.Rmd
    Untracked:  analysis/13.1_DGE_analysis_macro-alveolar_cells_CF-vs-control-samples_OLD.Rmd
    Untracked:  analysis/13.3_DGE_analysis_macro-monocyte-derived_CF-only-samples_OLD.Rmd
    Untracked:  analysis/13.4_DGE_analysis_macro-monocyte-derived_CF-vs-control-samples_OLD.Rmd
    Untracked:  analysis/15.0_integrate_all_cells.Rmd

Unstaged changes:
    Modified:   analysis/09.0_integrate_cluster_macro_cells.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/14.0_proportions_analysis_broad.Rmd</code>) and HTML
(<code>docs/14.0_proportions_analysis_broad.html</code>) files. If
you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/b6be5d650ebc6624df7cdd534af6c676dd187c43/analysis/14.0_proportions_analysis_broad.Rmd" target="_blank">b6be5d6</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-09-09
</td>
<td>
wflow_publish("analysis/14.0_proportions_analysis_broad.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/14.0_proportions_analysis_broad.html" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/01f0f43d543c87aca12c50ae95538cda6f7ddc0c/analysis/14.0_proportions_analysis_broad.Rmd" target="_blank">01f0f43</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
<td>
wflow_publish("analysis/14.*")
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="load-libraries" class="section level1">
<h1>Load libraries</h1>
<pre class="r"><code>suppressPackageStartupMessages({
  library(SingleCellExperiment)
  library(edgeR)
  library(tidyverse)
  library(ggplot2)
  library(Seurat)
  library(glmGamPoi)
  library(dittoSeq)
  library(clustree)
  library(AnnotationDbi)
  library(org.Hs.eg.db)
  library(glue)
  library(speckle)
  library(patchwork)
  library(paletteer)
  library(tidyHeatmap)
  library(here)
})

set.seed(42)
options(scipen=999)
options(future.globals.maxSize = 6500 * 1024^2)</code></pre>
</div>
<div id="load-data" class="section level1">
<h1>Load Data</h1>
<pre class="r"><code>files &lt;- list.files(here(&quot;data/C133_Neeland_merged&quot;),
                    pattern = &quot;C133_Neeland_full_clean.*(macrophages|t_cells|other_cells)_annotated_diet.SEU.rds&quot;,
                    full.names = TRUE)

seuLst &lt;- lapply(files[2:4], function(f) readRDS(f))

seu &lt;- merge(seuLst[[1]], 
             y = c(seuLst[[2]], 
                   seuLst[[3]]))
seu</code></pre>
<pre><code>An object of class Seurat 
21568 features across 191521 samples within 1 assay 
Active assay: RNA (21568 features, 0 variable features)</code></pre>
<pre><code>             used    (Mb) gc trigger    (Mb)   max used    (Mb)
Ncells   12075375   644.9   19710050  1052.7   13822807   738.3
Vcells 1331980955 10162.3 3633571648 27722.0 3492810279 26648.1</code></pre>
</div>
<div id="analyse-cell-type-proportions" class="section level1">
<h1>Analyse Cell type proportions</h1>
<pre class="r"><code># Differences in cell type proportions
props &lt;- getTransformedProps(clusters = seu$Broad,
                             sample = seu$sample.id, transform=&quot;asin&quot;)
props$Proportions %&gt;% knitr::kable()</code></pre>
<table>
<colgroup>
<col width="3%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="1%" />
<col width="1%" />
<col width="1%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sample_1.1</th>
<th align="right">sample_15.1</th>
<th align="right">sample_16.1</th>
<th align="right">sample_17.1</th>
<th align="right">sample_18.1</th>
<th align="right">sample_19.1</th>
<th align="right">sample_2.1</th>
<th align="right">sample_20.1</th>
<th align="right">sample_21.1</th>
<th align="right">sample_22.1</th>
<th align="right">sample_23.1</th>
<th align="right">sample_24.1</th>
<th align="right">sample_25.1</th>
<th align="right">sample_26.1</th>
<th align="right">sample_27.1</th>
<th align="right">sample_28.1</th>
<th align="right">sample_29.1</th>
<th align="right">sample_3.1</th>
<th align="right">sample_30.1</th>
<th align="right">sample_31.1</th>
<th align="right">sample_32.1</th>
<th align="right">sample_33.1</th>
<th align="right">sample_34.1</th>
<th align="right">sample_34.2</th>
<th align="right">sample_34.3</th>
<th align="right">sample_35.1</th>
<th align="right">sample_35.2</th>
<th align="right">sample_36.1</th>
<th align="right">sample_36.2</th>
<th align="right">sample_37.1</th>
<th align="right">sample_37.2</th>
<th align="right">sample_37.3</th>
<th align="right">sample_38.1</th>
<th align="right">sample_38.2</th>
<th align="right">sample_38.3</th>
<th align="right">sample_39.1</th>
<th align="right">sample_39.2</th>
<th align="right">sample_4.1</th>
<th align="right">sample_40.1</th>
<th align="right">sample_41.1</th>
<th align="right">sample_42.1</th>
<th align="right">sample_43.1</th>
<th align="right">sample_5.1</th>
<th align="right">sample_6.1</th>
<th align="right">sample_7.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">B cells</td>
<td align="right">0.2007576</td>
<td align="right">0.0482375</td>
<td align="right">0.0311111</td>
<td align="right">0.2339181</td>
<td align="right">0.0192308</td>
<td align="right">0.1276596</td>
<td align="right">0.2584541</td>
<td align="right">0.0436137</td>
<td align="right">0.1309824</td>
<td align="right">0.0711111</td>
<td align="right">0.2728273</td>
<td align="right">0.0351926</td>
<td align="right">0.0367347</td>
<td align="right">0.0946970</td>
<td align="right">0.0196850</td>
<td align="right">0.0164474</td>
<td align="right">0.2956879</td>
<td align="right">0.1931034</td>
<td align="right">0.0143198</td>
<td align="right">0.0182927</td>
<td align="right">0.0398010</td>
<td align="right">0.1185050</td>
<td align="right">0.0205128</td>
<td align="right">0.0000000</td>
<td align="right">0.0281124</td>
<td align="right">0.1522843</td>
<td align="right">0.0853175</td>
<td align="right">0.1891892</td>
<td align="right">0.2230392</td>
<td align="right">0.1123596</td>
<td align="right">0.2175439</td>
<td align="right">0.1319797</td>
<td align="right">0.2093023</td>
<td align="right">0.1792453</td>
<td align="right">0.2729970</td>
<td align="right">0.3150685</td>
<td align="right">0.1102484</td>
<td align="right">0.0541291</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0686695</td>
<td align="right">0.0673077</td>
<td align="right">0.2107765</td>
</tr>
<tr class="even">
<td align="left">CD4 T cells</td>
<td align="right">0.0833333</td>
<td align="right">0.1855288</td>
<td align="right">0.2133333</td>
<td align="right">0.0964912</td>
<td align="right">0.1038462</td>
<td align="right">0.1276596</td>
<td align="right">0.0990338</td>
<td align="right">0.2118380</td>
<td align="right">0.2644836</td>
<td align="right">0.2488889</td>
<td align="right">0.1848185</td>
<td align="right">0.1613546</td>
<td align="right">0.2326531</td>
<td align="right">0.2500000</td>
<td align="right">0.1299213</td>
<td align="right">0.1414474</td>
<td align="right">0.0965092</td>
<td align="right">0.1000000</td>
<td align="right">0.4216388</td>
<td align="right">0.3170732</td>
<td align="right">0.2288557</td>
<td align="right">0.3017320</td>
<td align="right">0.0871795</td>
<td align="right">0.0542636</td>
<td align="right">0.0602410</td>
<td align="right">0.1455161</td>
<td align="right">0.1726190</td>
<td align="right">0.0706861</td>
<td align="right">0.1887255</td>
<td align="right">0.2471910</td>
<td align="right">0.2842105</td>
<td align="right">0.3350254</td>
<td align="right">0.2441860</td>
<td align="right">0.3113208</td>
<td align="right">0.2106825</td>
<td align="right">0.1819961</td>
<td align="right">0.2344720</td>
<td align="right">0.0596808</td>
<td align="right">0.4689737</td>
<td align="right">0.3547352</td>
<td align="right">0.2087563</td>
<td align="right">0.1643306</td>
<td align="right">0.3025751</td>
<td align="right">0.2005495</td>
<td align="right">0.2844691</td>
</tr>
<tr class="odd">
<td align="left">CD8 T cells</td>
<td align="right">0.0568182</td>
<td align="right">0.1985158</td>
<td align="right">0.4666667</td>
<td align="right">0.1929825</td>
<td align="right">0.2076923</td>
<td align="right">0.0638298</td>
<td align="right">0.1388889</td>
<td align="right">0.2398754</td>
<td align="right">0.2468514</td>
<td align="right">0.2888889</td>
<td align="right">0.1430143</td>
<td align="right">0.1905710</td>
<td align="right">0.1795918</td>
<td align="right">0.2386364</td>
<td align="right">0.2598425</td>
<td align="right">0.3618421</td>
<td align="right">0.1889117</td>
<td align="right">0.1482759</td>
<td align="right">0.2155927</td>
<td align="right">0.4166667</td>
<td align="right">0.2587065</td>
<td align="right">0.2497721</td>
<td align="right">0.0769231</td>
<td align="right">0.0310078</td>
<td align="right">0.0883534</td>
<td align="right">0.1708968</td>
<td align="right">0.1071429</td>
<td align="right">0.0207900</td>
<td align="right">0.1102941</td>
<td align="right">0.2359551</td>
<td align="right">0.1298246</td>
<td align="right">0.2487310</td>
<td align="right">0.1627907</td>
<td align="right">0.1509434</td>
<td align="right">0.1928783</td>
<td align="right">0.0508806</td>
<td align="right">0.2927019</td>
<td align="right">0.1422623</td>
<td align="right">0.3269690</td>
<td align="right">0.4510433</td>
<td align="right">0.5000000</td>
<td align="right">0.7361044</td>
<td align="right">0.3583691</td>
<td align="right">0.3956044</td>
<td align="right">0.2836767</td>
</tr>
<tr class="even">
<td align="left">DC cells</td>
<td align="right">0.0871212</td>
<td align="right">0.1243043</td>
<td align="right">0.0622222</td>
<td align="right">0.2134503</td>
<td align="right">0.2192308</td>
<td align="right">0.2978723</td>
<td align="right">0.0048309</td>
<td align="right">0.1651090</td>
<td align="right">0.1108312</td>
<td align="right">0.0488889</td>
<td align="right">0.0704070</td>
<td align="right">0.2450199</td>
<td align="right">0.2693878</td>
<td align="right">0.1780303</td>
<td align="right">0.1574803</td>
<td align="right">0.1546053</td>
<td align="right">0.1416838</td>
<td align="right">0.2379310</td>
<td align="right">0.1097852</td>
<td align="right">0.0691057</td>
<td align="right">0.1791045</td>
<td align="right">0.1403829</td>
<td align="right">0.6051282</td>
<td align="right">0.6821705</td>
<td align="right">0.5461847</td>
<td align="right">0.1844332</td>
<td align="right">0.2638889</td>
<td align="right">0.2162162</td>
<td align="right">0.2414216</td>
<td align="right">0.1179775</td>
<td align="right">0.1087719</td>
<td align="right">0.0609137</td>
<td align="right">0.0465116</td>
<td align="right">0.0754717</td>
<td align="right">0.0623145</td>
<td align="right">0.1682975</td>
<td align="right">0.1405280</td>
<td align="right">0.0707842</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0772532</td>
<td align="right">0.0659341</td>
<td align="right">0.0443740</td>
</tr>
<tr class="odd">
<td align="left">dividing innate cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0018553</td>
<td align="right">0.0044444</td>
<td align="right">0.0131579</td>
<td align="right">0.0076923</td>
<td align="right">0.0212766</td>
<td align="right">0.0253623</td>
<td align="right">0.0062305</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0121012</td>
<td align="right">0.0079681</td>
<td align="right">0.0081633</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0032895</td>
<td align="right">0.0102669</td>
<td align="right">0.0103448</td>
<td align="right">0.0007955</td>
<td align="right">0.0000000</td>
<td align="right">0.0049751</td>
<td align="right">0.0063810</td>
<td align="right">0.0102564</td>
<td align="right">0.0000000</td>
<td align="right">0.0040161</td>
<td align="right">0.0016920</td>
<td align="right">0.0019841</td>
<td align="right">0.0103950</td>
<td align="right">0.0036765</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0050761</td>
<td align="right">0.0000000</td>
<td align="right">0.0094340</td>
<td align="right">0.0089021</td>
<td align="right">0.0254403</td>
<td align="right">0.0069876</td>
<td align="right">0.0034698</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0007924</td>
</tr>
<tr class="even">
<td align="left">epithelial cells</td>
<td align="right">0.3825758</td>
<td align="right">0.0890538</td>
<td align="right">0.0088889</td>
<td align="right">0.0175439</td>
<td align="right">0.0673077</td>
<td align="right">0.1063830</td>
<td align="right">0.4178744</td>
<td align="right">0.1059190</td>
<td align="right">0.1435768</td>
<td align="right">0.1155556</td>
<td align="right">0.2343234</td>
<td align="right">0.0212483</td>
<td align="right">0.0081633</td>
<td align="right">0.0265152</td>
<td align="right">0.2677165</td>
<td align="right">0.0164474</td>
<td align="right">0.1437372</td>
<td align="right">0.0275862</td>
<td align="right">0.0023866</td>
<td align="right">0.0081301</td>
<td align="right">0.0000000</td>
<td align="right">0.0428441</td>
<td align="right">0.0717949</td>
<td align="right">0.0930233</td>
<td align="right">0.0642570</td>
<td align="right">0.0795262</td>
<td align="right">0.0992063</td>
<td align="right">0.0478170</td>
<td align="right">0.0171569</td>
<td align="right">0.1235955</td>
<td align="right">0.0350877</td>
<td align="right">0.0659898</td>
<td align="right">0.0697674</td>
<td align="right">0.0566038</td>
<td align="right">0.1186944</td>
<td align="right">0.0215264</td>
<td align="right">0.0279503</td>
<td align="right">0.0180430</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0236052</td>
<td align="right">0.0178571</td>
<td align="right">0.0087163</td>
</tr>
<tr class="odd">
<td align="left">gamma delta T cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0037106</td>
<td align="right">0.0133333</td>
<td align="right">0.0043860</td>
<td align="right">0.0038462</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0093458</td>
<td align="right">0.0100756</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0019920</td>
<td align="right">0.0081633</td>
<td align="right">0.0037879</td>
<td align="right">0.0118110</td>
<td align="right">0.0032895</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0493238</td>
<td align="right">0.0284553</td>
<td align="right">0.0049751</td>
<td align="right">0.0027347</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0016920</td>
<td align="right">0.0000000</td>
<td align="right">0.0020790</td>
<td align="right">0.0000000</td>
<td align="right">0.0168539</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0094340</td>
<td align="right">0.0296736</td>
<td align="right">0.0019569</td>
<td align="right">0.0108696</td>
<td align="right">0.0000000</td>
<td align="right">0.0560859</td>
<td align="right">0.0176565</td>
<td align="right">0.0158629</td>
<td align="right">0.0062832</td>
<td align="right">0.0021459</td>
<td align="right">0.0000000</td>
<td align="right">0.0071315</td>
</tr>
<tr class="even">
<td align="left">innate lymphocyte</td>
<td align="right">0.0265152</td>
<td align="right">0.2374768</td>
<td align="right">0.0755556</td>
<td align="right">0.0423977</td>
<td align="right">0.0500000</td>
<td align="right">0.1276596</td>
<td align="right">0.0205314</td>
<td align="right">0.0467290</td>
<td align="right">0.0176322</td>
<td align="right">0.1155556</td>
<td align="right">0.0275028</td>
<td align="right">0.0285525</td>
<td align="right">0.0775510</td>
<td align="right">0.0643939</td>
<td align="right">0.0433071</td>
<td align="right">0.0164474</td>
<td align="right">0.0266940</td>
<td align="right">0.0241379</td>
<td align="right">0.0747812</td>
<td align="right">0.0569106</td>
<td align="right">0.0099502</td>
<td align="right">0.0282589</td>
<td align="right">0.0051282</td>
<td align="right">0.0077519</td>
<td align="right">0.0281124</td>
<td align="right">0.0304569</td>
<td align="right">0.0416667</td>
<td align="right">0.0041580</td>
<td align="right">0.0612745</td>
<td align="right">0.0224719</td>
<td align="right">0.0315789</td>
<td align="right">0.0253807</td>
<td align="right">0.0116279</td>
<td align="right">0.0094340</td>
<td align="right">0.0356083</td>
<td align="right">0.0078278</td>
<td align="right">0.0194099</td>
<td align="right">0.0263706</td>
<td align="right">0.0751790</td>
<td align="right">0.1075441</td>
<td align="right">0.2112944</td>
<td align="right">0.0599323</td>
<td align="right">0.0515021</td>
<td align="right">0.1043956</td>
<td align="right">0.0174326</td>
</tr>
<tr class="odd">
<td align="left">mast cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0029240</td>
<td align="right">0.0019231</td>
<td align="right">0.0000000</td>
<td align="right">0.0024155</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0110011</td>
<td align="right">0.0006640</td>
<td align="right">0.0163265</td>
<td align="right">0.0113636</td>
<td align="right">0.0078740</td>
<td align="right">0.0000000</td>
<td align="right">0.0205339</td>
<td align="right">0.0000000</td>
<td align="right">0.0015911</td>
<td align="right">0.0101626</td>
<td align="right">0.0000000</td>
<td align="right">0.0218778</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0080321</td>
<td align="right">0.0033841</td>
<td align="right">0.0039683</td>
<td align="right">0.0062370</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0050761</td>
<td align="right">0.0116279</td>
<td align="right">0.0000000</td>
<td align="right">0.0059347</td>
<td align="right">0.0019569</td>
<td align="right">0.0007764</td>
<td align="right">0.0117974</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0021459</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">monocytes</td>
<td align="right">0.1022727</td>
<td align="right">0.0092764</td>
<td align="right">0.0222222</td>
<td align="right">0.1096491</td>
<td align="right">0.2461538</td>
<td align="right">0.1276596</td>
<td align="right">0.0096618</td>
<td align="right">0.1090343</td>
<td align="right">0.0176322</td>
<td align="right">0.0400000</td>
<td align="right">0.0110011</td>
<td align="right">0.2881806</td>
<td align="right">0.1306122</td>
<td align="right">0.0984848</td>
<td align="right">0.0944882</td>
<td align="right">0.2565789</td>
<td align="right">0.0369610</td>
<td align="right">0.2172414</td>
<td align="right">0.0262530</td>
<td align="right">0.0386179</td>
<td align="right">0.2288557</td>
<td align="right">0.0209663</td>
<td align="right">0.0820513</td>
<td align="right">0.0697674</td>
<td align="right">0.1244980</td>
<td align="right">0.1827411</td>
<td align="right">0.1805556</td>
<td align="right">0.0831601</td>
<td align="right">0.1176471</td>
<td align="right">0.0955056</td>
<td align="right">0.1649123</td>
<td align="right">0.0812183</td>
<td align="right">0.1627907</td>
<td align="right">0.1415094</td>
<td align="right">0.0474777</td>
<td align="right">0.1585127</td>
<td align="right">0.0962733</td>
<td align="right">0.5954198</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0708155</td>
<td align="right">0.1263736</td>
<td align="right">0.0491284</td>
</tr>
<tr class="odd">
<td align="left">neutrophils</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0307018</td>
<td align="right">0.0153846</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0031153</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0121012</td>
<td align="right">0.0039841</td>
<td align="right">0.0040816</td>
<td align="right">0.0113636</td>
<td align="right">0.0000000</td>
<td align="right">0.0098684</td>
<td align="right">0.0205339</td>
<td align="right">0.0068966</td>
<td align="right">0.0023866</td>
<td align="right">0.0060976</td>
<td align="right">0.0099502</td>
<td align="right">0.0446673</td>
<td align="right">0.0256410</td>
<td align="right">0.0542636</td>
<td align="right">0.0361446</td>
<td align="right">0.0186125</td>
<td align="right">0.0059524</td>
<td align="right">0.3409563</td>
<td align="right">0.0159314</td>
<td align="right">0.0056180</td>
<td align="right">0.0070175</td>
<td align="right">0.0152284</td>
<td align="right">0.0000000</td>
<td align="right">0.0094340</td>
<td align="right">0.0000000</td>
<td align="right">0.0645793</td>
<td align="right">0.0372671</td>
<td align="right">0.0027759</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">NK cells</td>
<td align="right">0.0416667</td>
<td align="right">0.0575139</td>
<td align="right">0.0844444</td>
<td align="right">0.0321637</td>
<td align="right">0.0461538</td>
<td align="right">0.0000000</td>
<td align="right">0.0072464</td>
<td align="right">0.0342679</td>
<td align="right">0.0277078</td>
<td align="right">0.0355556</td>
<td align="right">0.0176018</td>
<td align="right">0.0099602</td>
<td align="right">0.0204082</td>
<td align="right">0.0113636</td>
<td align="right">0.0078740</td>
<td align="right">0.0000000</td>
<td align="right">0.0143737</td>
<td align="right">0.0241379</td>
<td align="right">0.0588703</td>
<td align="right">0.0264228</td>
<td align="right">0.0248756</td>
<td align="right">0.0154968</td>
<td align="right">0.0153846</td>
<td align="right">0.0000000</td>
<td align="right">0.0040161</td>
<td align="right">0.0169205</td>
<td align="right">0.0119048</td>
<td align="right">0.0062370</td>
<td align="right">0.0147059</td>
<td align="right">0.0056180</td>
<td align="right">0.0070175</td>
<td align="right">0.0152284</td>
<td align="right">0.0581395</td>
<td align="right">0.0188679</td>
<td align="right">0.0089021</td>
<td align="right">0.0000000</td>
<td align="right">0.0077640</td>
<td align="right">0.0111034</td>
<td align="right">0.0572792</td>
<td align="right">0.0609952</td>
<td align="right">0.0380711</td>
<td align="right">0.0260996</td>
<td align="right">0.0257511</td>
<td align="right">0.0082418</td>
<td align="right">0.0736926</td>
</tr>
<tr class="odd">
<td align="left">NK-T cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0278293</td>
<td align="right">0.0044444</td>
<td align="right">0.0029240</td>
<td align="right">0.0019231</td>
<td align="right">0.0000000</td>
<td align="right">0.0036232</td>
<td align="right">0.0062305</td>
<td align="right">0.0075567</td>
<td align="right">0.0044444</td>
<td align="right">0.0022002</td>
<td align="right">0.0000000</td>
<td align="right">0.0040816</td>
<td align="right">0.0113636</td>
<td align="right">0.0000000</td>
<td align="right">0.0032895</td>
<td align="right">0.0041068</td>
<td align="right">0.0034483</td>
<td align="right">0.0031822</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0027347</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0033841</td>
<td align="right">0.0119048</td>
<td align="right">0.0000000</td>
<td align="right">0.0024510</td>
<td align="right">0.0056180</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0031056</td>
<td align="right">0.0000000</td>
<td align="right">0.0083532</td>
<td align="right">0.0016051</td>
<td align="right">0.0025381</td>
<td align="right">0.0038666</td>
<td align="right">0.0021459</td>
<td align="right">0.0013736</td>
<td align="right">0.0071315</td>
</tr>
<tr class="even">
<td align="left">proliferating T/NK</td>
<td align="right">0.0189394</td>
<td align="right">0.0166976</td>
<td align="right">0.0133333</td>
<td align="right">0.0073099</td>
<td align="right">0.0096154</td>
<td align="right">0.0000000</td>
<td align="right">0.0120773</td>
<td align="right">0.0186916</td>
<td align="right">0.0226700</td>
<td align="right">0.0311111</td>
<td align="right">0.0011001</td>
<td align="right">0.0053121</td>
<td align="right">0.0040816</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0164474</td>
<td align="right">0.0000000</td>
<td align="right">0.0068966</td>
<td align="right">0.0190931</td>
<td align="right">0.0040650</td>
<td align="right">0.0099502</td>
<td align="right">0.0036463</td>
<td align="right">0.0000000</td>
<td align="right">0.0077519</td>
<td align="right">0.0080321</td>
<td align="right">0.0084602</td>
<td align="right">0.0138889</td>
<td align="right">0.0020790</td>
<td align="right">0.0036765</td>
<td align="right">0.0112360</td>
<td align="right">0.0140351</td>
<td align="right">0.0101523</td>
<td align="right">0.0232558</td>
<td align="right">0.0283019</td>
<td align="right">0.0059347</td>
<td align="right">0.0019569</td>
<td align="right">0.0116460</td>
<td align="right">0.0041638</td>
<td align="right">0.0071599</td>
<td align="right">0.0064205</td>
<td align="right">0.0234772</td>
<td align="right">0.0033833</td>
<td align="right">0.0150215</td>
<td align="right">0.0123626</td>
<td align="right">0.0126783</td>
</tr>
</tbody>
</table>
<div id="cell-type-proportions-by-sample" class="section level2">
<h2>Cell type proportions by sample</h2>
<pre class="r"><code>props$Proportions %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity,
                             Group,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
  distinct()-&gt; dat

ggplot(dat, aes(x = sample, y = Freq, fill = clusters)) +
  geom_bar(stat = &quot;identity&quot;, color = &quot;black&quot;, size = 0.1) +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1),
        legend.text = element_text(size = 8),
        legend.position = &quot;bottom&quot;) +
  labs(y = &quot;Proportion&quot;, fill = &quot;Cell Label&quot;) +
  scale_fill_paletteer_d(&quot;miscpalettes::pastel&quot;, direction = 1) +
  facet_grid(~Group, scales = &quot;free_x&quot;, space = &quot;free_x&quot;)</code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-6-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="no.-cells-per-sample" class="section level2">
<h2>No. cells per sample</h2>
<pre class="r"><code>props$Counts %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity, 
                             Group,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
  distinct() -&gt; dat

ggplot(dat, aes(x = sample, y = Freq, fill = Disease)) +
  geom_bar(stat = &quot;identity&quot;) +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1),
        legend.text = element_text(size = 8),
        legend.position = &quot;bottom&quot;) +
  labs(y = &quot;No. cells&quot;, fill = &quot;Disease&quot;) +
  facet_grid(~Group, scales = &quot;free_x&quot;, space = &quot;free_x&quot;) +
  geom_hline(yintercept = 1000, linetype = &quot;dashed&quot;)</code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-7-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-7-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Remove sample with too few cells.</p>
<pre class="r"><code>seu &lt;- subset(seu, cells = which(!seu$sample.id %in% c(&quot;sample_23.1&quot;)))

# Differences in cell type proportions
props &lt;- getTransformedProps(clusters = seu$Broad,
                             sample = seu$sample.id, transform=&quot;asin&quot;)
props$Proportions %&gt;% knitr::kable()</code></pre>
<table style="width:100%;">
<colgroup>
<col width="4%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
<col width="2%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sample_1.1</th>
<th align="right">sample_15.1</th>
<th align="right">sample_16.1</th>
<th align="right">sample_17.1</th>
<th align="right">sample_18.1</th>
<th align="right">sample_19.1</th>
<th align="right">sample_2.1</th>
<th align="right">sample_20.1</th>
<th align="right">sample_21.1</th>
<th align="right">sample_22.1</th>
<th align="right">sample_24.1</th>
<th align="right">sample_25.1</th>
<th align="right">sample_26.1</th>
<th align="right">sample_27.1</th>
<th align="right">sample_28.1</th>
<th align="right">sample_29.1</th>
<th align="right">sample_3.1</th>
<th align="right">sample_30.1</th>
<th align="right">sample_31.1</th>
<th align="right">sample_32.1</th>
<th align="right">sample_33.1</th>
<th align="right">sample_34.1</th>
<th align="right">sample_34.2</th>
<th align="right">sample_34.3</th>
<th align="right">sample_35.1</th>
<th align="right">sample_35.2</th>
<th align="right">sample_36.1</th>
<th align="right">sample_36.2</th>
<th align="right">sample_37.1</th>
<th align="right">sample_37.2</th>
<th align="right">sample_37.3</th>
<th align="right">sample_38.1</th>
<th align="right">sample_38.2</th>
<th align="right">sample_38.3</th>
<th align="right">sample_39.1</th>
<th align="right">sample_39.2</th>
<th align="right">sample_4.1</th>
<th align="right">sample_40.1</th>
<th align="right">sample_41.1</th>
<th align="right">sample_42.1</th>
<th align="right">sample_43.1</th>
<th align="right">sample_5.1</th>
<th align="right">sample_6.1</th>
<th align="right">sample_7.1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">B cells</td>
<td align="right">0.2007576</td>
<td align="right">0.0482375</td>
<td align="right">0.0311111</td>
<td align="right">0.2339181</td>
<td align="right">0.0192308</td>
<td align="right">0.1276596</td>
<td align="right">0.2584541</td>
<td align="right">0.0436137</td>
<td align="right">0.1309824</td>
<td align="right">0.0711111</td>
<td align="right">0.0351926</td>
<td align="right">0.0367347</td>
<td align="right">0.0946970</td>
<td align="right">0.0196850</td>
<td align="right">0.0164474</td>
<td align="right">0.2956879</td>
<td align="right">0.1931034</td>
<td align="right">0.0143198</td>
<td align="right">0.0182927</td>
<td align="right">0.0398010</td>
<td align="right">0.1185050</td>
<td align="right">0.0205128</td>
<td align="right">0.0000000</td>
<td align="right">0.0281124</td>
<td align="right">0.1522843</td>
<td align="right">0.0853175</td>
<td align="right">0.1891892</td>
<td align="right">0.2230392</td>
<td align="right">0.1123596</td>
<td align="right">0.2175439</td>
<td align="right">0.1319797</td>
<td align="right">0.2093023</td>
<td align="right">0.1792453</td>
<td align="right">0.2729970</td>
<td align="right">0.3150685</td>
<td align="right">0.1102484</td>
<td align="right">0.0541291</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0686695</td>
<td align="right">0.0673077</td>
<td align="right">0.2107765</td>
</tr>
<tr class="even">
<td align="left">CD4 T cells</td>
<td align="right">0.0833333</td>
<td align="right">0.1855288</td>
<td align="right">0.2133333</td>
<td align="right">0.0964912</td>
<td align="right">0.1038462</td>
<td align="right">0.1276596</td>
<td align="right">0.0990338</td>
<td align="right">0.2118380</td>
<td align="right">0.2644836</td>
<td align="right">0.2488889</td>
<td align="right">0.1613546</td>
<td align="right">0.2326531</td>
<td align="right">0.2500000</td>
<td align="right">0.1299213</td>
<td align="right">0.1414474</td>
<td align="right">0.0965092</td>
<td align="right">0.1000000</td>
<td align="right">0.4216388</td>
<td align="right">0.3170732</td>
<td align="right">0.2288557</td>
<td align="right">0.3017320</td>
<td align="right">0.0871795</td>
<td align="right">0.0542636</td>
<td align="right">0.0602410</td>
<td align="right">0.1455161</td>
<td align="right">0.1726190</td>
<td align="right">0.0706861</td>
<td align="right">0.1887255</td>
<td align="right">0.2471910</td>
<td align="right">0.2842105</td>
<td align="right">0.3350254</td>
<td align="right">0.2441860</td>
<td align="right">0.3113208</td>
<td align="right">0.2106825</td>
<td align="right">0.1819961</td>
<td align="right">0.2344720</td>
<td align="right">0.0596808</td>
<td align="right">0.4689737</td>
<td align="right">0.3547352</td>
<td align="right">0.2087563</td>
<td align="right">0.1643306</td>
<td align="right">0.3025751</td>
<td align="right">0.2005495</td>
<td align="right">0.2844691</td>
</tr>
<tr class="odd">
<td align="left">CD8 T cells</td>
<td align="right">0.0568182</td>
<td align="right">0.1985158</td>
<td align="right">0.4666667</td>
<td align="right">0.1929825</td>
<td align="right">0.2076923</td>
<td align="right">0.0638298</td>
<td align="right">0.1388889</td>
<td align="right">0.2398754</td>
<td align="right">0.2468514</td>
<td align="right">0.2888889</td>
<td align="right">0.1905710</td>
<td align="right">0.1795918</td>
<td align="right">0.2386364</td>
<td align="right">0.2598425</td>
<td align="right">0.3618421</td>
<td align="right">0.1889117</td>
<td align="right">0.1482759</td>
<td align="right">0.2155927</td>
<td align="right">0.4166667</td>
<td align="right">0.2587065</td>
<td align="right">0.2497721</td>
<td align="right">0.0769231</td>
<td align="right">0.0310078</td>
<td align="right">0.0883534</td>
<td align="right">0.1708968</td>
<td align="right">0.1071429</td>
<td align="right">0.0207900</td>
<td align="right">0.1102941</td>
<td align="right">0.2359551</td>
<td align="right">0.1298246</td>
<td align="right">0.2487310</td>
<td align="right">0.1627907</td>
<td align="right">0.1509434</td>
<td align="right">0.1928783</td>
<td align="right">0.0508806</td>
<td align="right">0.2927019</td>
<td align="right">0.1422623</td>
<td align="right">0.3269690</td>
<td align="right">0.4510433</td>
<td align="right">0.5000000</td>
<td align="right">0.7361044</td>
<td align="right">0.3583691</td>
<td align="right">0.3956044</td>
<td align="right">0.2836767</td>
</tr>
<tr class="even">
<td align="left">DC cells</td>
<td align="right">0.0871212</td>
<td align="right">0.1243043</td>
<td align="right">0.0622222</td>
<td align="right">0.2134503</td>
<td align="right">0.2192308</td>
<td align="right">0.2978723</td>
<td align="right">0.0048309</td>
<td align="right">0.1651090</td>
<td align="right">0.1108312</td>
<td align="right">0.0488889</td>
<td align="right">0.2450199</td>
<td align="right">0.2693878</td>
<td align="right">0.1780303</td>
<td align="right">0.1574803</td>
<td align="right">0.1546053</td>
<td align="right">0.1416838</td>
<td align="right">0.2379310</td>
<td align="right">0.1097852</td>
<td align="right">0.0691057</td>
<td align="right">0.1791045</td>
<td align="right">0.1403829</td>
<td align="right">0.6051282</td>
<td align="right">0.6821705</td>
<td align="right">0.5461847</td>
<td align="right">0.1844332</td>
<td align="right">0.2638889</td>
<td align="right">0.2162162</td>
<td align="right">0.2414216</td>
<td align="right">0.1179775</td>
<td align="right">0.1087719</td>
<td align="right">0.0609137</td>
<td align="right">0.0465116</td>
<td align="right">0.0754717</td>
<td align="right">0.0623145</td>
<td align="right">0.1682975</td>
<td align="right">0.1405280</td>
<td align="right">0.0707842</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0772532</td>
<td align="right">0.0659341</td>
<td align="right">0.0443740</td>
</tr>
<tr class="odd">
<td align="left">dividing innate cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0018553</td>
<td align="right">0.0044444</td>
<td align="right">0.0131579</td>
<td align="right">0.0076923</td>
<td align="right">0.0212766</td>
<td align="right">0.0253623</td>
<td align="right">0.0062305</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0079681</td>
<td align="right">0.0081633</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0032895</td>
<td align="right">0.0102669</td>
<td align="right">0.0103448</td>
<td align="right">0.0007955</td>
<td align="right">0.0000000</td>
<td align="right">0.0049751</td>
<td align="right">0.0063810</td>
<td align="right">0.0102564</td>
<td align="right">0.0000000</td>
<td align="right">0.0040161</td>
<td align="right">0.0016920</td>
<td align="right">0.0019841</td>
<td align="right">0.0103950</td>
<td align="right">0.0036765</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0050761</td>
<td align="right">0.0000000</td>
<td align="right">0.0094340</td>
<td align="right">0.0089021</td>
<td align="right">0.0254403</td>
<td align="right">0.0069876</td>
<td align="right">0.0034698</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0007924</td>
</tr>
<tr class="even">
<td align="left">epithelial cells</td>
<td align="right">0.3825758</td>
<td align="right">0.0890538</td>
<td align="right">0.0088889</td>
<td align="right">0.0175439</td>
<td align="right">0.0673077</td>
<td align="right">0.1063830</td>
<td align="right">0.4178744</td>
<td align="right">0.1059190</td>
<td align="right">0.1435768</td>
<td align="right">0.1155556</td>
<td align="right">0.0212483</td>
<td align="right">0.0081633</td>
<td align="right">0.0265152</td>
<td align="right">0.2677165</td>
<td align="right">0.0164474</td>
<td align="right">0.1437372</td>
<td align="right">0.0275862</td>
<td align="right">0.0023866</td>
<td align="right">0.0081301</td>
<td align="right">0.0000000</td>
<td align="right">0.0428441</td>
<td align="right">0.0717949</td>
<td align="right">0.0930233</td>
<td align="right">0.0642570</td>
<td align="right">0.0795262</td>
<td align="right">0.0992063</td>
<td align="right">0.0478170</td>
<td align="right">0.0171569</td>
<td align="right">0.1235955</td>
<td align="right">0.0350877</td>
<td align="right">0.0659898</td>
<td align="right">0.0697674</td>
<td align="right">0.0566038</td>
<td align="right">0.1186944</td>
<td align="right">0.0215264</td>
<td align="right">0.0279503</td>
<td align="right">0.0180430</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0236052</td>
<td align="right">0.0178571</td>
<td align="right">0.0087163</td>
</tr>
<tr class="odd">
<td align="left">gamma delta T cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0037106</td>
<td align="right">0.0133333</td>
<td align="right">0.0043860</td>
<td align="right">0.0038462</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0093458</td>
<td align="right">0.0100756</td>
<td align="right">0.0000000</td>
<td align="right">0.0019920</td>
<td align="right">0.0081633</td>
<td align="right">0.0037879</td>
<td align="right">0.0118110</td>
<td align="right">0.0032895</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0493238</td>
<td align="right">0.0284553</td>
<td align="right">0.0049751</td>
<td align="right">0.0027347</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0016920</td>
<td align="right">0.0000000</td>
<td align="right">0.0020790</td>
<td align="right">0.0000000</td>
<td align="right">0.0168539</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0094340</td>
<td align="right">0.0296736</td>
<td align="right">0.0019569</td>
<td align="right">0.0108696</td>
<td align="right">0.0000000</td>
<td align="right">0.0560859</td>
<td align="right">0.0176565</td>
<td align="right">0.0158629</td>
<td align="right">0.0062832</td>
<td align="right">0.0021459</td>
<td align="right">0.0000000</td>
<td align="right">0.0071315</td>
</tr>
<tr class="even">
<td align="left">innate lymphocyte</td>
<td align="right">0.0265152</td>
<td align="right">0.2374768</td>
<td align="right">0.0755556</td>
<td align="right">0.0423977</td>
<td align="right">0.0500000</td>
<td align="right">0.1276596</td>
<td align="right">0.0205314</td>
<td align="right">0.0467290</td>
<td align="right">0.0176322</td>
<td align="right">0.1155556</td>
<td align="right">0.0285525</td>
<td align="right">0.0775510</td>
<td align="right">0.0643939</td>
<td align="right">0.0433071</td>
<td align="right">0.0164474</td>
<td align="right">0.0266940</td>
<td align="right">0.0241379</td>
<td align="right">0.0747812</td>
<td align="right">0.0569106</td>
<td align="right">0.0099502</td>
<td align="right">0.0282589</td>
<td align="right">0.0051282</td>
<td align="right">0.0077519</td>
<td align="right">0.0281124</td>
<td align="right">0.0304569</td>
<td align="right">0.0416667</td>
<td align="right">0.0041580</td>
<td align="right">0.0612745</td>
<td align="right">0.0224719</td>
<td align="right">0.0315789</td>
<td align="right">0.0253807</td>
<td align="right">0.0116279</td>
<td align="right">0.0094340</td>
<td align="right">0.0356083</td>
<td align="right">0.0078278</td>
<td align="right">0.0194099</td>
<td align="right">0.0263706</td>
<td align="right">0.0751790</td>
<td align="right">0.1075441</td>
<td align="right">0.2112944</td>
<td align="right">0.0599323</td>
<td align="right">0.0515021</td>
<td align="right">0.1043956</td>
<td align="right">0.0174326</td>
</tr>
<tr class="odd">
<td align="left">mast cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0029240</td>
<td align="right">0.0019231</td>
<td align="right">0.0000000</td>
<td align="right">0.0024155</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0006640</td>
<td align="right">0.0163265</td>
<td align="right">0.0113636</td>
<td align="right">0.0078740</td>
<td align="right">0.0000000</td>
<td align="right">0.0205339</td>
<td align="right">0.0000000</td>
<td align="right">0.0015911</td>
<td align="right">0.0101626</td>
<td align="right">0.0000000</td>
<td align="right">0.0218778</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0080321</td>
<td align="right">0.0033841</td>
<td align="right">0.0039683</td>
<td align="right">0.0062370</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0050761</td>
<td align="right">0.0116279</td>
<td align="right">0.0000000</td>
<td align="right">0.0059347</td>
<td align="right">0.0019569</td>
<td align="right">0.0007764</td>
<td align="right">0.0117974</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0021459</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">monocytes</td>
<td align="right">0.1022727</td>
<td align="right">0.0092764</td>
<td align="right">0.0222222</td>
<td align="right">0.1096491</td>
<td align="right">0.2461538</td>
<td align="right">0.1276596</td>
<td align="right">0.0096618</td>
<td align="right">0.1090343</td>
<td align="right">0.0176322</td>
<td align="right">0.0400000</td>
<td align="right">0.2881806</td>
<td align="right">0.1306122</td>
<td align="right">0.0984848</td>
<td align="right">0.0944882</td>
<td align="right">0.2565789</td>
<td align="right">0.0369610</td>
<td align="right">0.2172414</td>
<td align="right">0.0262530</td>
<td align="right">0.0386179</td>
<td align="right">0.2288557</td>
<td align="right">0.0209663</td>
<td align="right">0.0820513</td>
<td align="right">0.0697674</td>
<td align="right">0.1244980</td>
<td align="right">0.1827411</td>
<td align="right">0.1805556</td>
<td align="right">0.0831601</td>
<td align="right">0.1176471</td>
<td align="right">0.0955056</td>
<td align="right">0.1649123</td>
<td align="right">0.0812183</td>
<td align="right">0.1627907</td>
<td align="right">0.1415094</td>
<td align="right">0.0474777</td>
<td align="right">0.1585127</td>
<td align="right">0.0962733</td>
<td align="right">0.5954198</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0708155</td>
<td align="right">0.1263736</td>
<td align="right">0.0491284</td>
</tr>
<tr class="odd">
<td align="left">neutrophils</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0307018</td>
<td align="right">0.0153846</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0031153</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0039841</td>
<td align="right">0.0040816</td>
<td align="right">0.0113636</td>
<td align="right">0.0000000</td>
<td align="right">0.0098684</td>
<td align="right">0.0205339</td>
<td align="right">0.0068966</td>
<td align="right">0.0023866</td>
<td align="right">0.0060976</td>
<td align="right">0.0099502</td>
<td align="right">0.0446673</td>
<td align="right">0.0256410</td>
<td align="right">0.0542636</td>
<td align="right">0.0361446</td>
<td align="right">0.0186125</td>
<td align="right">0.0059524</td>
<td align="right">0.3409563</td>
<td align="right">0.0159314</td>
<td align="right">0.0056180</td>
<td align="right">0.0070175</td>
<td align="right">0.0152284</td>
<td align="right">0.0000000</td>
<td align="right">0.0094340</td>
<td align="right">0.0000000</td>
<td align="right">0.0645793</td>
<td align="right">0.0372671</td>
<td align="right">0.0027759</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">NK cells</td>
<td align="right">0.0416667</td>
<td align="right">0.0575139</td>
<td align="right">0.0844444</td>
<td align="right">0.0321637</td>
<td align="right">0.0461538</td>
<td align="right">0.0000000</td>
<td align="right">0.0072464</td>
<td align="right">0.0342679</td>
<td align="right">0.0277078</td>
<td align="right">0.0355556</td>
<td align="right">0.0099602</td>
<td align="right">0.0204082</td>
<td align="right">0.0113636</td>
<td align="right">0.0078740</td>
<td align="right">0.0000000</td>
<td align="right">0.0143737</td>
<td align="right">0.0241379</td>
<td align="right">0.0588703</td>
<td align="right">0.0264228</td>
<td align="right">0.0248756</td>
<td align="right">0.0154968</td>
<td align="right">0.0153846</td>
<td align="right">0.0000000</td>
<td align="right">0.0040161</td>
<td align="right">0.0169205</td>
<td align="right">0.0119048</td>
<td align="right">0.0062370</td>
<td align="right">0.0147059</td>
<td align="right">0.0056180</td>
<td align="right">0.0070175</td>
<td align="right">0.0152284</td>
<td align="right">0.0581395</td>
<td align="right">0.0188679</td>
<td align="right">0.0089021</td>
<td align="right">0.0000000</td>
<td align="right">0.0077640</td>
<td align="right">0.0111034</td>
<td align="right">0.0572792</td>
<td align="right">0.0609952</td>
<td align="right">0.0380711</td>
<td align="right">0.0260996</td>
<td align="right">0.0257511</td>
<td align="right">0.0082418</td>
<td align="right">0.0736926</td>
</tr>
<tr class="odd">
<td align="left">NK-T cells</td>
<td align="right">0.0000000</td>
<td align="right">0.0278293</td>
<td align="right">0.0044444</td>
<td align="right">0.0029240</td>
<td align="right">0.0019231</td>
<td align="right">0.0000000</td>
<td align="right">0.0036232</td>
<td align="right">0.0062305</td>
<td align="right">0.0075567</td>
<td align="right">0.0044444</td>
<td align="right">0.0000000</td>
<td align="right">0.0040816</td>
<td align="right">0.0113636</td>
<td align="right">0.0000000</td>
<td align="right">0.0032895</td>
<td align="right">0.0041068</td>
<td align="right">0.0034483</td>
<td align="right">0.0031822</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0027347</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0033841</td>
<td align="right">0.0119048</td>
<td align="right">0.0000000</td>
<td align="right">0.0024510</td>
<td align="right">0.0056180</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0031056</td>
<td align="right">0.0000000</td>
<td align="right">0.0083532</td>
<td align="right">0.0016051</td>
<td align="right">0.0025381</td>
<td align="right">0.0038666</td>
<td align="right">0.0021459</td>
<td align="right">0.0013736</td>
<td align="right">0.0071315</td>
</tr>
<tr class="even">
<td align="left">proliferating T/NK</td>
<td align="right">0.0189394</td>
<td align="right">0.0166976</td>
<td align="right">0.0133333</td>
<td align="right">0.0073099</td>
<td align="right">0.0096154</td>
<td align="right">0.0000000</td>
<td align="right">0.0120773</td>
<td align="right">0.0186916</td>
<td align="right">0.0226700</td>
<td align="right">0.0311111</td>
<td align="right">0.0053121</td>
<td align="right">0.0040816</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0164474</td>
<td align="right">0.0000000</td>
<td align="right">0.0068966</td>
<td align="right">0.0190931</td>
<td align="right">0.0040650</td>
<td align="right">0.0099502</td>
<td align="right">0.0036463</td>
<td align="right">0.0000000</td>
<td align="right">0.0077519</td>
<td align="right">0.0080321</td>
<td align="right">0.0084602</td>
<td align="right">0.0138889</td>
<td align="right">0.0020790</td>
<td align="right">0.0036765</td>
<td align="right">0.0112360</td>
<td align="right">0.0140351</td>
<td align="right">0.0101523</td>
<td align="right">0.0232558</td>
<td align="right">0.0283019</td>
<td align="right">0.0059347</td>
<td align="right">0.0019569</td>
<td align="right">0.0116460</td>
<td align="right">0.0041638</td>
<td align="right">0.0071599</td>
<td align="right">0.0064205</td>
<td align="right">0.0234772</td>
<td align="right">0.0033833</td>
<td align="right">0.0150215</td>
<td align="right">0.0123626</td>
<td align="right">0.0126783</td>
</tr>
</tbody>
</table>
</div>
<div id="cell-proportions-by-sample" class="section level2">
<h2>Cell proportions by sample</h2>
<pre class="r"><code>props$Proportions %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity, 
                             Group,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
  distinct()-&gt; dat

ggplot(dat, aes(x = sample, y = Freq, fill = clusters)) +
  geom_bar(stat = &quot;identity&quot;, color = &quot;black&quot;, size = 0.1) +
  theme(axis.text.x = element_text(angle = 90,
                                   vjust = 0.5,
                                   hjust = 1),
        legend.text = element_text(size = 8),
        legend.position = &quot;bottom&quot;) +
  labs(y = &quot;Proportion&quot;, fill = &quot;Cell Label&quot;) +
  scale_fill_paletteer_d(&quot;miscpalettes::pastel&quot;, direction = 1) +
  facet_grid(~Group, scales = &quot;free_x&quot;, space = &quot;free_x&quot;)</code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-9-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-9-1">
Past versions of unnamed-chunk-9-1.png
</button>
</p>
<div id="fig-unnamed-chunk-9-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-9-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-proportions-by-cell-type" class="section level2">
<h2>Cell proportions by cell type</h2>
<pre class="r"><code>props$Proportions %&gt;%
  data.frame %&gt;%
  inner_join(seu@meta.data %&gt;%
               dplyr::select(sample.id,
                             Annotation,
                             Broad,
                             Disease,
                             Treatment,
                             Status, 
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;, &quot;clusters&quot; = &quot;Broad&quot;)) %&gt;%
  distinct()-&gt; dat

ggplot(dat, 
       aes(x = clusters, y = Freq, fill = clusters)) +
  geom_boxplot(outlier.size = 0.1, size = 0.25) +
  theme(axis.text.x = element_text(angle = 45,
                                   vjust = 1,
                                   hjust = 1),
        legend.text = element_text(size = 8)) +
  labs(y = &quot;Proportion&quot;) +
  scale_fill_paletteer_d(&quot;miscpalettes::pastel&quot;, direction = 1) +
  NoLegend()</code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-10-1">
Past versions of unnamed-chunk-10-1.png
</button>
</p>
<div id="fig-unnamed-chunk-10-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-10-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="explore-sources-of-variation" class="section level1">
<h1>Explore sources of variation</h1>
<div id="cell-count-data" class="section level2">
<h2>Cell count data</h2>
<p>Look at the sources of variation in the raw cell count level
data.</p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$Counts,
    gene.selection = &quot;common&quot;,
    plot = FALSE, dim.plot = dims[[i]])
  
  data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            shape = as.factor(Disease),
                            color = as.factor(Batch))) +
    geom_point(size = 3) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Batch&quot;,
         shape = &quot;Disease&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) 
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-11-1">
Past versions of unnamed-chunk-11-1.png
</button>
</p>
<div id="fig-unnamed-chunk-11-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-11-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$Counts, 
                 gene.selection = &quot;common&quot;,
                 plot = FALSE, dim.plot = dims[[i]])
  
   data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity,
                             Participant,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    group_by(sample) %&gt;%
    mutate(ncells = n()) %&gt;%
    ungroup() %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            colour = log2(ncells)))+
    geom_text(aes(label = str_remove_all(sample, &quot;sample_&quot;)), size = 2.5) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Log2 No. Cells&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) +
    scale_colour_viridis_c(option = &quot;magma&quot;)
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-12-1">
Past versions of unnamed-chunk-12-1.png
</button>
</p>
<div id="fig-unnamed-chunk-12-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-12-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="cell-proportion-data" class="section level2">
<h2>Cell proportion data</h2>
<p>Look at the sources of variation in the cell proportions data.</p>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps,
    gene.selection = &quot;common&quot;,
    plot = FALSE, dim.plot = dims[[i]])
  
  data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            shape = as.factor(Disease),
                            color = as.factor(Batch)))+
    geom_point(size = 3) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Batch&quot;,
         shape = &quot;Disease&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9))
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-13-1">
Past versions of unnamed-chunk-13-1.png
</button>
</p>
<div id="fig-unnamed-chunk-13-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-13-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps,
    gene.selection = &quot;common&quot;,
    plot = FALSE, dim.plot = dims[[i]])
  
  data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity, 
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            shape = as.factor(Disease),
                            color = Sex))+
    geom_point(size = 3) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Sex&quot;,
         shape = &quot;Disease&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9))
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-14-1">
Past versions of unnamed-chunk-14-1.png
</button>
</p>
<div id="fig-unnamed-chunk-14-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-14-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps, 
                 gene.selection = &quot;common&quot;,
                 plot = FALSE, dim.plot = dims[[i]])
  
   data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity,
                             Participant,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    group_by(sample) %&gt;%
    mutate(ncells = n()) %&gt;%
    ungroup() %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            colour = log2(Age)))+
    geom_text(aes(label = str_remove_all(sample, &quot;sample_&quot;)), size = 2.5) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Log2 Age&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) +
    scale_colour_viridis_c(option = &quot;magma&quot;)
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-15-1">
Past versions of unnamed-chunk-15-1.png
</button>
</p>
<div id="fig-unnamed-chunk-15-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-15-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>dims &lt;- list(c(1,2), c(2:3), c(3,4), c(4,5))
p &lt;- vector(&quot;list&quot;, length(dims))

for(i in 1:length(dims)){
  mds &lt;- plotMDS(props$TransformedProps, 
                 gene.selection = &quot;common&quot;,
                 plot = FALSE, dim.plot = dims[[i]])
  
   data.frame(x = mds$x, 
             y = mds$y,
             sample = rownames(mds$distance.matrix.squared)) %&gt;%
    left_join(seu@meta.data %&gt;%
               dplyr::select(sample.id, 
                             Disease,
                             Treatment,
                             Status, 
                             Severity,
                             Participant,
                             Batch, 
                             Age, 
                             Sex), 
             by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    group_by(sample) %&gt;%
    mutate(ncells = n()) %&gt;%
    ungroup() %&gt;%
    distinct() -&gt; dat
  
  p[[i]] &lt;- ggplot(dat, aes(x = x, y = y, 
                            colour = log2(ncells)))+
    geom_text(aes(label = str_remove_all(sample, &quot;sample_&quot;)), size = 2.5) +
    labs(x = glue(&quot;Principal Component {dims[[i]][1]}&quot;),
         y = glue(&quot;Principal Component {dims[[i]][2]}&quot;),
         colour = &quot;Log2 No. Cells&quot;) +
    theme(legend.direction = &quot;horizontal&quot;,
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9),
          axis.text = element_text(size = 8),
          axis.title = element_text(size = 9)) +
    scale_colour_viridis_c(option = &quot;magma&quot;)
}

wrap_plots(p, cols = 2) + plot_layout(guides = &quot;collect&quot;) &amp;
  theme(legend.position = &quot;bottom&quot;) </code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-16-1">
Past versions of unnamed-chunk-16-1.png
</button>
</p>
<div id="fig-unnamed-chunk-16-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-16-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="principal-components-versus-traits" class="section level1">
<h1>Principal components versus traits</h1>
<p>Principal components analysis (PCA) allows us to mathematically
determine the sources of variation in the data. We can then investigate
whether these correlate with any of the specifed covariates. First, we
calculate the principal components. The scree plot belows shows us that
most of the variation in this data is captured by the top 7 principal
components.</p>
<pre class="r"><code>PCs &lt;- prcomp(t(props$TransformedProps), center = TRUE, 
              scale = TRUE, retx = TRUE)
loadings = PCs$x # pc loadings
plot(PCs, type=&quot;lines&quot;) # scree plot</code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-17-1">
Past versions of unnamed-chunk-17-1.png
</button>
</p>
<div id="fig-unnamed-chunk-17-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-17-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Collect all of the known sample traits.</p>
<pre class="r"><code>nGenes = nrow(props$TransformedProps)
nSamples = ncol(props$TransformedProps)

info &lt;- seu@meta.data %&gt;%
  dplyr::select(sample.id, 
                Disease,
                Treatment,
                Status, 
                Severity,
                Participant,
                Group,
                Batch, 
                Age, 
                Sex) %&gt;%
  group_by(sample.id) %&gt;%
  mutate(ncells = n()) %&gt;%
  ungroup() %&gt;%
  distinct()

m &lt;- match(colnames(props$TransformedProps), info$sample.id)
info &lt;- info[m,]

datTraits &lt;- info %&gt;% dplyr::select(Participant, Batch, Disease, Status,
                                    Group, Severity, Age, Sex, ncells) %&gt;%
  mutate(Age = log2(Age),
         ncells = log2(ncells),
    Donor = factor(Participant),
         Batch = factor(Batch),
         Disease = factor(Disease, 
                          labels = 1:length(unique(Disease))),
         Group = factor(Group, 
                        labels = 1:length(unique(Group))),
         Treatment = factor(Status, 
                            labels = 1:length(unique(Status))),
         Sex = factor(Sex, labels = length(unique(Sex))),
         Severity = factor(Severity, labels = length(unique(Severity)))) %&gt;%
  mutate(across(everything(), as.numeric)) %&gt;%
  dplyr::select(-Participant, -Status)

datTraits %&gt;% 
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="8%" />
<col width="11%" />
<col width="8%" />
<col width="13%" />
<col width="15%" />
<col width="5%" />
<col width="13%" />
<col width="8%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Batch</th>
<th align="right">Disease</th>
<th align="right">Group</th>
<th align="right">Severity</th>
<th align="right">Age</th>
<th align="right">Sex</th>
<th align="right">ncells</th>
<th align="right">Donor</th>
<th align="right">Treatment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">-0.2590872</td>
<td align="right">2</td>
<td align="right">11.21006</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.0939001</td>
<td align="right">2</td>
<td align="right">11.82416</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.1151479</td>
<td align="right">1</td>
<td align="right">11.85604</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.0441471</td>
<td align="right">1</td>
<td align="right">11.86573</td>
<td align="right">4</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">0.1428834</td>
<td align="right">2</td>
<td align="right">12.68036</td>
<td align="right">5</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.0729608</td>
<td align="right">1</td>
<td align="right">11.29577</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0.1464588</td>
<td align="right">2</td>
<td align="right">11.13635</td>
<td align="right">7</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">0.5597097</td>
<td align="right">2</td>
<td align="right">12.93055</td>
<td align="right">8</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">1.5743836</td>
<td align="right">1</td>
<td align="right">12.41627</td>
<td align="right">9</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1.5993830</td>
<td align="right">2</td>
<td align="right">12.73640</td>
<td align="right">10</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2.3883594</td>
<td align="right">2</td>
<td align="right">13.17633</td>
<td align="right">11</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">2.2957230</td>
<td align="right">1</td>
<td align="right">11.67596</td>
<td align="right">12</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2.3360877</td>
<td align="right">2</td>
<td align="right">10.99435</td>
<td align="right">13</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2.2980155</td>
<td align="right">2</td>
<td align="right">11.26854</td>
<td align="right">14</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2.5790214</td>
<td align="right">1</td>
<td align="right">12.80554</td>
<td align="right">15</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">2.5823250</td>
<td align="right">1</td>
<td align="right">10.61471</td>
<td align="right">16</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0.1321035</td>
<td align="right">2</td>
<td align="right">12.19414</td>
<td align="right">17</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">2.5889097</td>
<td align="right">1</td>
<td align="right">11.43671</td>
<td align="right">18</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2.5583683</td>
<td align="right">1</td>
<td align="right">11.07682</td>
<td align="right">19</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">2.5670653</td>
<td align="right">1</td>
<td align="right">11.53284</td>
<td align="right">20</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">2.5730557</td>
<td align="right">2</td>
<td align="right">11.06272</td>
<td align="right">21</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">-0.9343238</td>
<td align="right">1</td>
<td align="right">10.54689</td>
<td align="right">22</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">0.0918737</td>
<td align="right">1</td>
<td align="right">10.41680</td>
<td align="right">22</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.0409164</td>
<td align="right">1</td>
<td align="right">12.04337</td>
<td align="right">22</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">0.0807044</td>
<td align="right">2</td>
<td align="right">12.27612</td>
<td align="right">23</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">0.9940589</td>
<td align="right">2</td>
<td align="right">12.36987</td>
<td align="right">23</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">-0.0564254</td>
<td align="right">1</td>
<td align="right">11.54448</td>
<td align="right">24</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">3</td>
<td align="right">1.1764977</td>
<td align="right">1</td>
<td align="right">11.82217</td>
<td align="right">24</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.5597097</td>
<td align="right">1</td>
<td align="right">11.48884</td>
<td align="right">25</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.1930156</td>
<td align="right">1</td>
<td align="right">12.27816</td>
<td align="right">25</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.2980155</td>
<td align="right">1</td>
<td align="right">11.26562</td>
<td align="right">25</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1.5703964</td>
<td align="right">2</td>
<td align="right">11.86147</td>
<td align="right">26</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2.0206033</td>
<td align="right">2</td>
<td align="right">11.65821</td>
<td align="right">26</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">2.3485584</td>
<td align="right">2</td>
<td align="right">11.33483</td>
<td align="right">26</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.9730702</td>
<td align="right">1</td>
<td align="right">11.85565</td>
<td align="right">27</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2.6297159</td>
<td align="right">1</td>
<td align="right">12.33371</td>
<td align="right">27</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">0.2923784</td>
<td align="right">2</td>
<td align="right">12.97782</td>
<td align="right">28</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">1.5801455</td>
<td align="right">2</td>
<td align="right">11.41996</td>
<td align="right">29</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">1.5801455</td>
<td align="right">2</td>
<td align="right">11.88417</td>
<td align="right">30</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">1.5993178</td>
<td align="right">2</td>
<td align="right">13.10214</td>
<td align="right">31</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">1.5849625</td>
<td align="right">2</td>
<td align="right">12.84333</td>
<td align="right">32</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">3.0699187</td>
<td align="right">1</td>
<td align="right">10.78054</td>
<td align="right">33</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">2.4204621</td>
<td align="right">2</td>
<td align="right">13.37246</td>
<td align="right">34</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">7</td>
<td align="right">1</td>
<td align="right">2.2356012</td>
<td align="right">1</td>
<td align="right">13.20075</td>
<td align="right">35</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>Correlate known sample traits with the top 10 principal components.
This can help us determine which traits are potentially contributing to
the main sources of variation in the data and should thus be included in
our statistical analysis.</p>
<pre class="r"><code>moduleTraitCor &lt;- suppressWarnings(cor(loadings[, 1:10], datTraits, use = &quot;p&quot;))
moduleTraitPvalue &lt;- WGCNA::corPvalueStudent(moduleTraitCor, (nSamples - 2))

textMatrix &lt;- paste(signif(moduleTraitCor, 2), &quot;\n(&quot;, 
                    signif(moduleTraitPvalue, 1), &quot;)&quot;, sep = &quot;&quot;)
dim(textMatrix) &lt;- dim(moduleTraitCor)

## Display the correlation values within a heatmap plot
par(cex=0.75, mar = c(6, 8.5, 3, 3))
WGCNA::labeledHeatmap(Matrix = t(moduleTraitCor),
                      xLabels = colnames(loadings)[1:10],
                      yLabels = names(datTraits),
                      colorLabels = FALSE,
                      colors = WGCNA::blueWhiteRed(6),
                      textMatrix = t(textMatrix),
                      setStdMargins = FALSE,
                      cex.text = 1,
                      zlim = c(-1,1),
                      main = paste(&quot;PCA-trait relationships: Top 10 PCs&quot;))</code></pre>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-19-1">
Past versions of unnamed-chunk-19-1.png
</button>
</p>
<div id="fig-unnamed-chunk-19-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-19-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="statistical-analysis-using-the-propeller-and-limma-approach"
class="section level1">
<h1>Statistical analysis using the <code>propeller</code> and
<code>limma</code> approach</h1>
<p>Create the design matrix.</p>
<pre class="r"><code>group &lt;- factor(info$Group)
participant &lt;- factor(info$Participant)
age &lt;- log2(info$Age)
batch &lt;- factor(info$Batch)
sex &lt;- factor(info$Sex)

design &lt;- model.matrix(~ 0 + group + batch)
colnames(design)[1:7] &lt;- levels(group) 
design</code></pre>
<pre><code>   CF.IVA.M CF.IVA.S CF.LUMA_IVA.M CF.LUMA_IVA.S CF.NO_MOD.M CF.NO_MOD.S
1         0        0             0             0           0           0
2         0        0             0             0           1           0
3         0        0             0             0           1           0
4         0        0             0             0           1           0
5         0        0             0             0           1           0
6         0        0             0             0           1           0
7         0        0             0             0           0           0
8         0        0             0             0           0           1
9         0        0             0             0           0           1
10        1        0             0             0           0           0
11        1        0             0             0           0           0
12        0        0             0             0           0           1
13        0        0             0             0           1           0
14        1        0             0             0           0           0
15        0        0             0             0           1           0
16        0        0             0             0           0           1
17        0        0             0             0           0           0
18        0        0             0             0           0           1
19        0        0             0             0           1           0
20        0        0             0             0           1           0
21        0        1             0             0           0           0
22        0        0             0             0           1           0
23        0        0             0             0           1           0
24        0        0             0             0           1           0
25        0        0             0             0           1           0
26        0        0             0             0           1           0
27        0        0             0             0           0           1
28        0        0             0             1           0           0
29        0        0             0             0           1           0
30        0        0             1             0           0           0
31        0        0             1             0           0           0
32        1        0             0             0           0           0
33        1        0             0             0           0           0
34        1        0             0             0           0           0
35        0        0             0             0           1           0
36        0        0             1             0           0           0
37        0        0             0             0           0           0
38        0        0             0             0           0           1
39        0        0             0             0           1           0
40        0        1             0             0           0           0
41        0        0             0             0           0           0
42        0        0             0             0           0           0
43        0        0             0             0           0           0
44        0        0             0             0           0           0
   NON_CF.CTRL batch1 batch2 batch3 batch4 batch5 batch6
1            1      0      0      1      0      0      0
2            0      0      0      1      0      0      0
3            0      0      0      1      0      0      0
4            0      0      0      0      1      0      0
5            0      0      0      0      1      0      0
6            0      0      0      0      0      1      0
7            1      0      0      1      0      0      0
8            0      0      0      0      0      1      0
9            0      0      0      1      0      0      0
10           0      0      0      1      0      0      0
11           0      0      0      0      0      1      0
12           0      1      0      0      0      0      0
13           0      1      0      0      0      0      0
14           0      1      0      0      0      0      0
15           0      0      0      0      0      1      0
16           0      1      0      0      0      0      0
17           1      0      0      0      0      1      0
18           0      1      0      0      0      0      0
19           0      1      0      0      0      0      0
20           0      1      0      0      0      0      0
21           0      1      0      0      0      0      0
22           0      0      0      0      0      0      1
23           0      0      0      0      0      0      1
24           0      0      0      0      0      0      1
25           0      0      0      0      0      0      1
26           0      0      0      0      0      0      1
27           0      0      0      0      0      0      1
28           0      0      0      0      0      0      1
29           0      0      1      0      0      0      0
30           0      0      1      0      0      0      0
31           0      0      1      0      0      0      0
32           0      0      1      0      0      0      0
33           0      0      1      0      0      0      0
34           0      0      1      0      0      0      0
35           0      0      0      0      1      0      0
36           0      0      0      0      1      0      0
37           1      0      0      0      0      0      1
38           0      0      0      0      0      0      0
39           0      0      0      0      0      0      0
40           0      0      0      0      0      0      0
41           1      0      0      0      0      0      0
42           1      0      1      0      0      0      0
43           1      0      0      1      0      0      0
44           1      0      0      1      0      0      0
attr(,&quot;assign&quot;)
 [1] 1 1 1 1 1 1 1 2 2 2 2 2 2
attr(,&quot;contrasts&quot;)
attr(,&quot;contrasts&quot;)$group
[1] &quot;contr.treatment&quot;

attr(,&quot;contrasts&quot;)$batch
[1] &quot;contr.treatment&quot;</code></pre>
<p>Create the contrast matrix.</p>
<pre class="r"><code>contr &lt;- makeContrasts(CF.NO_MODvCF.IVA = 0.5*(CF.NO_MOD.M + CF.NO_MOD.S) - 0.5*(CF.IVA.M + CF.IVA.S),
                       CF.NO_MODvCF.LUMA_IVA = 0.5*(CF.NO_MOD.M + CF.NO_MOD.S) - 0.5*(CF.LUMA_IVA.M + CF.LUMA_IVA.S),
                       CF.NO_MOD.MvCF.NO_MOD.S = CF.NO_MOD.M - CF.NO_MOD.S,
                       CF.NO_MODvNON_CF.CTRL = 0.5*(CF.NO_MOD.M + CF.NO_MOD.S) - NON_CF.CTRL,
                       CF.IVAvNON_CF.CTRL = 0.5*(CF.IVA.M + CF.IVA.S) - NON_CF.CTRL,
                       CF.LUMA_IVAvNON_CF.CTRL = 0.5*(CF.LUMA_IVA.M + CF.LUMA_IVA.S) - NON_CF.CTRL,
                       levels = design)
contr</code></pre>
<pre><code>               Contrasts
Levels          CF.NO_MODvCF.IVA CF.NO_MODvCF.LUMA_IVA CF.NO_MOD.MvCF.NO_MOD.S
  CF.IVA.M                  -0.5                   0.0                       0
  CF.IVA.S                  -0.5                   0.0                       0
  CF.LUMA_IVA.M              0.0                  -0.5                       0
  CF.LUMA_IVA.S              0.0                  -0.5                       0
  CF.NO_MOD.M                0.5                   0.5                       1
  CF.NO_MOD.S                0.5                   0.5                      -1
  NON_CF.CTRL                0.0                   0.0                       0
  batch1                     0.0                   0.0                       0
  batch2                     0.0                   0.0                       0
  batch3                     0.0                   0.0                       0
  batch4                     0.0                   0.0                       0
  batch5                     0.0                   0.0                       0
  batch6                     0.0                   0.0                       0
               Contrasts
Levels          CF.NO_MODvNON_CF.CTRL CF.IVAvNON_CF.CTRL
  CF.IVA.M                        0.0                0.5
  CF.IVA.S                        0.0                0.5
  CF.LUMA_IVA.M                   0.0                0.0
  CF.LUMA_IVA.S                   0.0                0.0
  CF.NO_MOD.M                     0.5                0.0
  CF.NO_MOD.S                     0.5                0.0
  NON_CF.CTRL                    -1.0               -1.0
  batch1                          0.0                0.0
  batch2                          0.0                0.0
  batch3                          0.0                0.0
  batch4                          0.0                0.0
  batch5                          0.0                0.0
  batch6                          0.0                0.0
               Contrasts
Levels          CF.LUMA_IVAvNON_CF.CTRL
  CF.IVA.M                          0.0
  CF.IVA.S                          0.0
  CF.LUMA_IVA.M                     0.5
  CF.LUMA_IVA.S                     0.5
  CF.NO_MOD.M                       0.0
  CF.NO_MOD.S                       0.0
  NON_CF.CTRL                      -1.0
  batch1                            0.0
  batch2                            0.0
  batch3                            0.0
  batch4                            0.0
  batch5                            0.0
  batch6                            0.0</code></pre>
<p>Add random effect for samples from the same individual.</p>
<pre class="r"><code>dupcor &lt;- duplicateCorrelation(props$TransformedProps, design=design,
                                block=participant)
dupcor</code></pre>
<pre><code>$consensus.correlation
[1] 0.4835608

$cor
[1] 0.4835608

$atanh.correlations
 [1]  0.6069739  1.2203341  0.3407848  1.1347531 -0.4968206  1.5064404
 [7] -0.5360603  1.1369909 -0.3054705  0.7256989  0.9968550  0.2747558
[13]  0.4690347 -0.1041629</code></pre>
<p>Fit the model.</p>
<pre class="r"><code>fit &lt;- lmFit(props$TransformedProps, design=design, block=participant, 
                correlation=dupcor$consensus)
fit2 &lt;- contrasts.fit(fit, contr)
fit2 &lt;- eBayes(fit2, robust=TRUE, trend=FALSE)
pvalue &lt;- 0.05
summary(decideTests(fit2, p.value = pvalue))</code></pre>
<pre><code>       CF.NO_MODvCF.IVA CF.NO_MODvCF.LUMA_IVA CF.NO_MOD.MvCF.NO_MOD.S
Down                  0                     0                       0
NotSig               14                    13                      14
Up                    0                     1                       0
       CF.NO_MODvNON_CF.CTRL CF.IVAvNON_CF.CTRL CF.LUMA_IVAvNON_CF.CTRL
Down                       0                  0                       0
NotSig                    14                 14                      13
Up                         0                  0                       1</code></pre>
<div id="results" class="section level2 tabset">
<h2 class="tabset">Results</h2>
<div id="anova-overall-results" class="section level3">
<h3>ANOVA overall results</h3>
<pre class="r"><code>topTable(fit2)</code></pre>
<pre><code>                    CF.NO_MODvCF.IVA CF.NO_MODvCF.LUMA_IVA
neutrophils             -0.001335702           0.156247232
CD4 T cells              0.046512661          -0.103017334
monocytes               -0.026703820          -0.006267278
gamma delta T cells      0.038244167           0.048611414
innate lymphocyte       -0.022240010          -0.080214712
mast cells              -0.025491997           0.035188531
DC cells                 0.034601495           0.034200361
CD8 T cells             -0.017903014          -0.112877885
B cells                 -0.016075522          -0.045565310
NK-T cells               0.028033876          -0.003175009
                    CF.NO_MOD.MvCF.NO_MOD.S CF.NO_MODvNON_CF.CTRL
neutrophils                     -0.07588777            0.05884456
CD4 T cells                     -0.03531435            0.09929663
monocytes                        0.06187549           -0.14839527
gamma delta T cells             -0.03636943            0.06103052
innate lymphocyte                0.04719364            0.05073036
mast cells                      -0.02114494           -0.01516338
DC cells                         0.03987889            0.09441096
CD8 T cells                      0.09557599           -0.06377727
B cells                         -0.09108754           -0.05390851
NK-T cells                      -0.01210417            0.02898265
                    CF.IVAvNON_CF.CTRL CF.LUMA_IVAvNON_CF.CTRL    AveExpr
neutrophils               0.0601802607            -0.097402674 0.08617661
CD4 T cells               0.0527839672             0.202313962 0.45452849
monocytes                -0.1216914531            -0.142127995 0.30208452
gamma delta T cells       0.0227863498             0.012419103 0.06196999
innate lymphocyte         0.0729703691             0.130945071 0.20617052
mast cells                0.0103286199            -0.050351908 0.03871842
DC cells                  0.0598094700             0.060210604 0.37109431
CD8 T cells              -0.0458742604             0.049100611 0.48151404
B cells                  -0.0378329857            -0.008343198 0.29191494
NK-T cells                0.0009487761             0.032157661 0.04193350
                            F    P.Value adj.P.Val
neutrophils         3.4781993 0.01750830 0.2451163
CD4 T cells         2.8414728 0.03919017 0.2743312
monocytes           1.9811601 0.11981077 0.4925885
gamma delta T cells 1.8005204 0.15141738 0.4925885
innate lymphocyte   1.6870287 0.17592445 0.4925885
mast cells          1.3106170 0.28565084 0.6389158
DC cells            1.2230247 0.31945791 0.6389158
CD8 T cells         1.0867742 0.37869103 0.6627093
B cells             0.8765189 0.48825761 0.7246848
NK-T cells          0.8263413 0.51763201 0.7246848</code></pre>
</div>
<div id="individual-comparisons" class="section level3">
<h3>Individual comparisons</h3>
<pre class="r"><code>p &lt;- vector(&quot;list&quot;, ncol(contr))

for(i in 1:ncol(contr)){
  print(knitr::kable(topTable(fit2, coef = i),
                     caption = colnames(contr)[i]))
  
  props$Proportions %&gt;% data.frame %&gt;%
    left_join(info,
              by = c(&quot;sample&quot; = &quot;sample.id&quot;)) %&gt;%
    dplyr::filter(Group %in% names(contr[,i])[abs(contr[, i]) &gt; 0]) -&gt; dat
  
  if(length(unique(dat$Group)) &gt; 2) dat$Group &lt;- str_remove(dat$Group, &quot;.(M|S)$&quot;)
  ggplot(dat, aes(x = Group,
                  y = Freq,
                  colour = Group,
                  group = Group)) +
    geom_boxplot(outlier.shape = NA, colour = &quot;grey&quot;) +
    geom_jitter(stat = &quot;identity&quot;,
                width = 0.15,
                size = 2) +
    theme_classic() +
    theme(axis.text.x = element_text(angle = 90,
                                     hjust = 1,
                                     vjust = 0.5),
          legend.position = &quot;bottom&quot;,
          legend.direction = &quot;horizontal&quot;) +
    labs(x = &quot;Group&quot;, y = &quot;Proportion&quot;,
         colour = &quot;Condition&quot;) +
    facet_wrap(~clusters, scales = &quot;free_y&quot;) +
    ggtitle(colnames(contr)[i]) -&gt; p[[i]]
  
  print(p[[i]])
}</code></pre>
<table>
<caption>CF.NO_MODvCF.IVA</caption>
<colgroup>
<col width="24%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NK-T cells</td>
<td align="right">0.0280339</td>
<td align="right">0.0419335</td>
<td align="right">1.3126845</td>
<td align="right">0.1980442</td>
<td align="right">0.9108975</td>
<td align="right">-4.931050</td>
</tr>
<tr class="even">
<td align="left">gamma delta T cells</td>
<td align="right">0.0382442</td>
<td align="right">0.0619700</td>
<td align="right">1.2721885</td>
<td align="right">0.2119020</td>
<td align="right">0.9108975</td>
<td align="right">-4.976516</td>
</tr>
<tr class="odd">
<td align="left">mast cells</td>
<td align="right">-0.0254920</td>
<td align="right">0.0387184</td>
<td align="right">-1.1556856</td>
<td align="right">0.2558326</td>
<td align="right">0.9108975</td>
<td align="right">-5.100120</td>
</tr>
<tr class="even">
<td align="left">CD4 T cells</td>
<td align="right">0.0465127</td>
<td align="right">0.4545285</td>
<td align="right">1.0001167</td>
<td align="right">0.3243748</td>
<td align="right">0.9108975</td>
<td align="right">-5.248036</td>
</tr>
<tr class="odd">
<td align="left">epithelial cells</td>
<td align="right">-0.0549040</td>
<td align="right">0.2234522</td>
<td align="right">-0.7338269</td>
<td align="right">0.4681245</td>
<td align="right">0.9108975</td>
<td align="right">-5.454376</td>
</tr>
<tr class="even">
<td align="left">proliferating T/NK</td>
<td align="right">-0.0159962</td>
<td align="right">0.0912470</td>
<td align="right">-0.6725033</td>
<td align="right">0.5057891</td>
<td align="right">0.9108975</td>
<td align="right">-5.493312</td>
</tr>
<tr class="odd">
<td align="left">DC cells</td>
<td align="right">0.0346015</td>
<td align="right">0.3710943</td>
<td align="right">0.6286007</td>
<td align="right">0.5338442</td>
<td align="right">0.9108975</td>
<td align="right">-5.519072</td>
</tr>
<tr class="even">
<td align="left">NK cells</td>
<td align="right">0.0196522</td>
<td align="right">0.1393575</td>
<td align="right">0.5394775</td>
<td align="right">0.5930798</td>
<td align="right">0.9108975</td>
<td align="right">-5.566260</td>
</tr>
<tr class="odd">
<td align="left">innate lymphocyte</td>
<td align="right">-0.0222400</td>
<td align="right">0.2061705</td>
<td align="right">-0.5060624</td>
<td align="right">0.6161044</td>
<td align="right">0.9108975</td>
<td align="right">-5.582107</td>
</tr>
<tr class="even">
<td align="left">monocytes</td>
<td align="right">-0.0267038</td>
<td align="right">0.3020845</td>
<td align="right">-0.4569431</td>
<td align="right">0.6506411</td>
<td align="right">0.9108975</td>
<td align="right">-5.603617</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-1">
Past versions of unnamed-chunk-25-1.png
</button>
</p>
<div id="fig-unnamed-chunk-25-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-1.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<table>
<caption>CF.NO_MODvCF.LUMA_IVA</caption>
<colgroup>
<col width="26%" />
<col width="13%" />
<col width="11%" />
<col width="13%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">neutrophils</td>
<td align="right">0.1562472</td>
<td align="right">0.0861766</td>
<td align="right">3.3084216</td>
<td align="right">0.0022379</td>
<td align="right">0.0313306</td>
<td align="right">-1.498312</td>
</tr>
<tr class="even">
<td align="left">CD4 T cells</td>
<td align="right">-0.1030173</td>
<td align="right">0.4545285</td>
<td align="right">-2.0351798</td>
<td align="right">0.0497515</td>
<td align="right">0.3482605</td>
<td align="right">-4.198721</td>
</tr>
<tr class="odd">
<td align="left">innate lymphocyte</td>
<td align="right">-0.0802147</td>
<td align="right">0.2061705</td>
<td align="right">-1.6770117</td>
<td align="right">0.1027850</td>
<td align="right">0.3543735</td>
<td align="right">-4.786179</td>
</tr>
<tr class="even">
<td align="left">CD8 T cells</td>
<td align="right">-0.1128779</td>
<td align="right">0.4815140</td>
<td align="right">-1.5319213</td>
<td align="right">0.1348679</td>
<td align="right">0.3543735</td>
<td align="right">-4.997227</td>
</tr>
<tr class="odd">
<td align="left">gamma delta T cells</td>
<td align="right">0.0486114</td>
<td align="right">0.0619700</td>
<td align="right">1.4857218</td>
<td align="right">0.1465279</td>
<td align="right">0.3543735</td>
<td align="right">-5.060932</td>
</tr>
<tr class="even">
<td align="left">mast cells</td>
<td align="right">0.0351885</td>
<td align="right">0.0387184</td>
<td align="right">1.4657166</td>
<td align="right">0.1518744</td>
<td align="right">0.3543735</td>
<td align="right">-5.088023</td>
</tr>
<tr class="odd">
<td align="left">epithelial cells</td>
<td align="right">0.0750748</td>
<td align="right">0.2234522</td>
<td align="right">0.9219269</td>
<td align="right">0.3631141</td>
<td align="right">0.7262282</td>
<td align="right">-5.695664</td>
</tr>
<tr class="even">
<td align="left">dividing innate cells</td>
<td align="right">0.0189094</td>
<td align="right">0.0528350</td>
<td align="right">0.6637332</td>
<td align="right">0.5113180</td>
<td align="right">0.8006370</td>
<td align="right">-5.892293</td>
</tr>
<tr class="odd">
<td align="left">B cells</td>
<td align="right">-0.0455653</td>
<td align="right">0.2919149</td>
<td align="right">-0.5997053</td>
<td align="right">0.5527101</td>
<td align="right">0.8006370</td>
<td align="right">-5.931368</td>
</tr>
<tr class="even">
<td align="left">DC cells</td>
<td align="right">0.0342004</td>
<td align="right">0.3710943</td>
<td align="right">0.5708522</td>
<td align="right">0.5718836</td>
<td align="right">0.8006370</td>
<td align="right">-5.947736</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-2.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-2">
Past versions of unnamed-chunk-25-2.png
</button>
</p>
<div id="fig-unnamed-chunk-25-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-2.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<table>
<caption>CF.NO_MOD.MvCF.NO_MOD.S</caption>
<colgroup>
<col width="24%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">neutrophils</td>
<td align="right">-0.0758878</td>
<td align="right">0.0861766</td>
<td align="right">-1.8115215</td>
<td align="right">0.0789724</td>
<td align="right">0.5610201</td>
<td align="right">-4.291728</td>
</tr>
<tr class="even">
<td align="left">CD8 T cells</td>
<td align="right">0.0955760</td>
<td align="right">0.4815140</td>
<td align="right">1.4623105</td>
<td align="right">0.1529114</td>
<td align="right">0.5610201</td>
<td align="right">-4.776304</td>
</tr>
<tr class="odd">
<td align="left">B cells</td>
<td align="right">-0.0910875</td>
<td align="right">0.2919149</td>
<td align="right">-1.3515302</td>
<td align="right">0.1855204</td>
<td align="right">0.5610201</td>
<td align="right">-4.911406</td>
</tr>
<tr class="even">
<td align="left">gamma delta T cells</td>
<td align="right">-0.0363694</td>
<td align="right">0.0619700</td>
<td align="right">-1.2531382</td>
<td align="right">0.2186690</td>
<td align="right">0.5610201</td>
<td align="right">-5.023501</td>
</tr>
<tr class="odd">
<td align="left">innate lymphocyte</td>
<td align="right">0.0471936</td>
<td align="right">0.2061705</td>
<td align="right">1.1123174</td>
<td align="right">0.2738665</td>
<td align="right">0.5610201</td>
<td align="right">-5.170475</td>
</tr>
<tr class="even">
<td align="left">monocytes</td>
<td align="right">0.0618755</td>
<td align="right">0.3020845</td>
<td align="right">1.0966893</td>
<td align="right">0.2805451</td>
<td align="right">0.5610201</td>
<td align="right">-5.185799</td>
</tr>
<tr class="odd">
<td align="left">mast cells</td>
<td align="right">-0.0211449</td>
<td align="right">0.0387184</td>
<td align="right">-0.9929298</td>
<td align="right">0.3277288</td>
<td align="right">0.5610201</td>
<td align="right">-5.282498</td>
</tr>
<tr class="even">
<td align="left">proliferating T/NK</td>
<td align="right">-0.0203773</td>
<td align="right">0.0912470</td>
<td align="right">-0.8873642</td>
<td align="right">0.3810907</td>
<td align="right">0.5610201</td>
<td align="right">-5.371547</td>
</tr>
<tr class="odd">
<td align="left">NK cells</td>
<td align="right">-0.0304087</td>
<td align="right">0.1393575</td>
<td align="right">-0.8646439</td>
<td align="right">0.3933054</td>
<td align="right">0.5610201</td>
<td align="right">-5.389437</td>
</tr>
<tr class="even">
<td align="left">CD4 T cells</td>
<td align="right">-0.0353144</td>
<td align="right">0.4545285</td>
<td align="right">-0.7865148</td>
<td align="right">0.4370569</td>
<td align="right">0.5610201</td>
<td align="right">-5.447655</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-3.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-3">
Past versions of unnamed-chunk-25-3.png
</button>
</p>
<div id="fig-unnamed-chunk-25-3" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-3.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<table>
<caption>CF.NO_MODvNON_CF.CTRL</caption>
<colgroup>
<col width="24%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">monocytes</td>
<td align="right">-0.1483953</td>
<td align="right">0.3020845</td>
<td align="right">-2.7206950</td>
<td align="right">0.0102245</td>
<td align="right">0.1431431</td>
<td align="right">-2.681908</td>
</tr>
<tr class="even">
<td align="left">CD4 T cells</td>
<td align="right">0.0992966</td>
<td align="right">0.4545285</td>
<td align="right">2.2876259</td>
<td align="right">0.0285554</td>
<td align="right">0.1709411</td>
<td align="right">-3.516068</td>
</tr>
<tr class="odd">
<td align="left">gamma delta T cells</td>
<td align="right">0.0610305</td>
<td align="right">0.0619700</td>
<td align="right">2.1752256</td>
<td align="right">0.0366302</td>
<td align="right">0.1709411</td>
<td align="right">-3.715342</td>
</tr>
<tr class="even">
<td align="left">DC cells</td>
<td align="right">0.0944110</td>
<td align="right">0.3710943</td>
<td align="right">1.8376951</td>
<td align="right">0.0749291</td>
<td align="right">0.2622520</td>
<td align="right">-4.271945</td>
</tr>
<tr class="odd">
<td align="left">NK-T cells</td>
<td align="right">0.0289827</td>
<td align="right">0.0419335</td>
<td align="right">1.4540735</td>
<td align="right">0.1550567</td>
<td align="right">0.3627339</td>
<td align="right">-4.810472</td>
</tr>
<tr class="even">
<td align="left">neutrophils</td>
<td align="right">0.0588446</td>
<td align="right">0.0861766</td>
<td align="right">1.4530242</td>
<td align="right">0.1554574</td>
<td align="right">0.3627339</td>
<td align="right">-4.811844</td>
</tr>
<tr class="odd">
<td align="left">innate lymphocyte</td>
<td align="right">0.0507304</td>
<td align="right">0.2061705</td>
<td align="right">1.2368243</td>
<td align="right">0.2246945</td>
<td align="right">0.4493889</td>
<td align="right">-5.066976</td>
</tr>
<tr class="even">
<td align="left">CD8 T cells</td>
<td align="right">-0.0637773</td>
<td align="right">0.4815140</td>
<td align="right">-1.0093728</td>
<td align="right">0.3199820</td>
<td align="right">0.5599685</td>
<td align="right">-5.294968</td>
</tr>
<tr class="odd">
<td align="left">proliferating T/NK</td>
<td align="right">0.0195260</td>
<td align="right">0.0912470</td>
<td align="right">0.8795530</td>
<td align="right">0.3852498</td>
<td align="right">0.5793509</td>
<td align="right">-5.405783</td>
</tr>
<tr class="even">
<td align="left">B cells</td>
<td align="right">-0.0539085</td>
<td align="right">0.2919149</td>
<td align="right">-0.8274065</td>
<td align="right">0.4138221</td>
<td align="right">0.5793509</td>
<td align="right">-5.446125</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-4.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-4">
Past versions of unnamed-chunk-25-4.png
</button>
</p>
<div id="fig-unnamed-chunk-25-4" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-4.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<table>
<caption>CF.IVAvNON_CF.CTRL</caption>
<colgroup>
<col width="24%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">monocytes</td>
<td align="right">-0.1216915</td>
<td align="right">0.3020845</td>
<td align="right">-1.7549582</td>
<td align="right">0.0883466</td>
<td align="right">0.8547199</td>
<td align="right">-4.265871</td>
</tr>
<tr class="even">
<td align="left">innate lymphocyte</td>
<td align="right">0.0729704</td>
<td align="right">0.2061705</td>
<td align="right">1.3993732</td>
<td align="right">0.1708304</td>
<td align="right">0.8547199</td>
<td align="right">-4.718613</td>
</tr>
<tr class="odd">
<td align="left">proliferating T/NK</td>
<td align="right">0.0355221</td>
<td align="right">0.0912470</td>
<td align="right">1.2586224</td>
<td align="right">0.2167045</td>
<td align="right">0.8547199</td>
<td align="right">-4.873317</td>
</tr>
<tr class="even">
<td align="left">neutrophils</td>
<td align="right">0.0601803</td>
<td align="right">0.0861766</td>
<td align="right">1.1688735</td>
<td align="right">0.2506489</td>
<td align="right">0.8547199</td>
<td align="right">-4.964246</td>
</tr>
<tr class="odd">
<td align="left">CD4 T cells</td>
<td align="right">0.0527840</td>
<td align="right">0.4545285</td>
<td align="right">0.9565319</td>
<td align="right">0.3456093</td>
<td align="right">0.8547199</td>
<td align="right">-5.154743</td>
</tr>
<tr class="even">
<td align="left">DC cells</td>
<td align="right">0.0598095</td>
<td align="right">0.3710943</td>
<td align="right">0.9157310</td>
<td align="right">0.3663085</td>
<td align="right">0.8547199</td>
<td align="right">-5.187269</td>
</tr>
<tr class="odd">
<td align="left">gamma delta T cells</td>
<td align="right">0.0227863</td>
<td align="right">0.0619700</td>
<td align="right">0.6388206</td>
<td align="right">0.5272018</td>
<td align="right">0.8852661</td>
<td align="right">-5.372170</td>
</tr>
<tr class="even">
<td align="left">CD8 T cells</td>
<td align="right">-0.0458743</td>
<td align="right">0.4815140</td>
<td align="right">-0.5710861</td>
<td align="right">0.5717268</td>
<td align="right">0.8852661</td>
<td align="right">-5.407619</td>
</tr>
<tr class="odd">
<td align="left">epithelial cells</td>
<td align="right">0.0475202</td>
<td align="right">0.2234522</td>
<td align="right">0.5352860</td>
<td align="right">0.5959638</td>
<td align="right">0.8852661</td>
<td align="right">-5.424810</td>
</tr>
<tr class="even">
<td align="left">B cells</td>
<td align="right">-0.0378330</td>
<td align="right">0.2919149</td>
<td align="right">-0.4567506</td>
<td align="right">0.6507781</td>
<td align="right">0.8852661</td>
<td align="right">-5.458691</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-5.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-5">
Past versions of unnamed-chunk-25-5.png
</button>
</p>
<div id="fig-unnamed-chunk-25-5" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-5.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<table style="width:100%;">
<caption>CF.LUMA_IVAvNON_CF.CTRL</caption>
<colgroup>
<col width="23%" />
<col width="13%" />
<col width="12%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">logFC</th>
<th align="right">AveExpr</th>
<th align="right">t</th>
<th align="right">P.Value</th>
<th align="right">adj.P.Val</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CD4 T cells</td>
<td align="right">0.2023140</td>
<td align="right">0.4545285</td>
<td align="right">3.2374126</td>
<td align="right">0.0027063</td>
<td align="right">0.0378887</td>
<td align="right">-1.652005</td>
</tr>
<tr class="even">
<td align="left">innate lymphocyte</td>
<td align="right">0.1309451</td>
<td align="right">0.2061705</td>
<td align="right">2.2174352</td>
<td align="right">0.0334362</td>
<td align="right">0.2340533</td>
<td align="right">-3.839751</td>
</tr>
<tr class="odd">
<td align="left">monocytes</td>
<td align="right">-0.1421280</td>
<td align="right">0.3020845</td>
<td align="right">-1.8099272</td>
<td align="right">0.0792246</td>
<td align="right">0.2913839</td>
<td align="right">-4.549431</td>
</tr>
<tr class="even">
<td align="left">mast cells</td>
<td align="right">-0.0503519</td>
<td align="right">0.0387184</td>
<td align="right">-1.6988088</td>
<td align="right">0.0984507</td>
<td align="right">0.2913839</td>
<td align="right">-4.722702</td>
</tr>
<tr class="odd">
<td align="left">neutrophils</td>
<td align="right">-0.0974027</td>
<td align="right">0.0861766</td>
<td align="right">-1.6705486</td>
<td align="right">0.1040657</td>
<td align="right">0.2913839</td>
<td align="right">-4.765587</td>
</tr>
<tr class="even">
<td align="left">NK-T cells</td>
<td align="right">0.0321577</td>
<td align="right">0.0419335</td>
<td align="right">1.1206097</td>
<td align="right">0.2702740</td>
<td align="right">0.6306393</td>
<td align="right">-5.470139</td>
</tr>
<tr class="odd">
<td align="left">epithelial cells</td>
<td align="right">-0.0824586</td>
<td align="right">0.2234522</td>
<td align="right">-0.8201967</td>
<td align="right">0.4178624</td>
<td align="right">0.6723357</td>
<td align="right">-5.746240</td>
</tr>
<tr class="even">
<td align="left">DC cells</td>
<td align="right">0.0602106</td>
<td align="right">0.3710943</td>
<td align="right">0.8140399</td>
<td align="right">0.4213318</td>
<td align="right">0.6723357</td>
<td align="right">-5.751049</td>
</tr>
<tr class="odd">
<td align="left">proliferating T/NK</td>
<td align="right">0.0241137</td>
<td align="right">0.0912470</td>
<td align="right">0.7544599</td>
<td align="right">0.4557452</td>
<td align="right">0.6723357</td>
<td align="right">-5.795853</td>
</tr>
<tr class="even">
<td align="left">NK cells</td>
<td align="right">0.0349392</td>
<td align="right">0.1393575</td>
<td align="right">0.7137869</td>
<td align="right">0.4802398</td>
<td align="right">0.6723357</td>
<td align="right">-5.824473</td>
</tr>
</tbody>
</table>
<p><img src="figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-6.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-25-6">
Past versions of unnamed-chunk-25-6.png
</button>
</p>
<div id="fig-unnamed-chunk-25-6" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://atlassian.petermac.org.au/bitbucket/scm/os/paed-inflammation-citeseq/blob/be02872e8118083eca3a6e08ab535d4cf40f3e72/docs/figure/14.0_proportions_analysis_broad.Rmd/unnamed-chunk-25-6.png" target="_blank">be02872</a>
</td>
<td>
Jovana Maksimovic
</td>
<td>
2024-08-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="session-info" class="section level1 appendix">
<h1 class="appendix">Session info</h1>
<summary>
The analysis and this document were prepared using the following
software (click triangle to expand)
</summary>
<details>
<pre class="r"><code>sessioninfo::session_info()</code></pre>
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.3.3 (2024-02-29)
 os       Ubuntu 22.04.4 LTS
 system   x86_64, linux-gnu
 ui       X11
 language (EN)
 collate  en_AU.UTF-8
 ctype    en_AU.UTF-8
 tz       Etc/UTC
 date     2024-09-09
 pandoc   3.1.1 @ /usr/lib/rstudio-server/bin/quarto/bin/tools/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────
 ! package              * version    date (UTC) lib source
 P abind                  1.4-5      2016-07-21 [?] RSPM (R 4.3.0)
 P AnnotationDbi        * 1.64.1     2023-11-03 [?] Bioconductor
 P backports              1.4.1      2021-12-13 [?] RSPM (R 4.3.0)
 P base64enc              0.1-3      2015-07-28 [?] RSPM (R 4.3.0)
 P Biobase              * 2.62.0     2023-10-24 [?] Bioconductor
 P BiocGenerics         * 0.48.1     2023-11-01 [?] Bioconductor
 P BiocManager            1.30.22    2023-08-08 [?] RSPM (R 4.3.0)
 P Biostrings             2.70.2     2024-01-28 [?] Bioconductor 3.18 (R 4.3.3)
 P bit                    4.0.5      2022-11-15 [?] RSPM (R 4.3.0)
 P bit64                  4.0.5      2020-08-30 [?] RSPM (R 4.3.0)
 P bitops                 1.0-7      2021-04-24 [?] RSPM (R 4.3.0)
 P blob                   1.2.4      2023-03-17 [?] RSPM (R 4.3.0)
 P bslib                  0.6.1      2023-11-28 [?] RSPM (R 4.3.0)
 P cachem                 1.0.8      2023-05-01 [?] RSPM (R 4.3.0)
 P callr                  3.7.3      2022-11-02 [?] RSPM (R 4.3.0)
 P checkmate              2.3.1      2023-12-04 [?] RSPM (R 4.3.0)
 P circlize               0.4.15     2022-05-10 [?] RSPM (R 4.3.0)
 P cli                    3.6.2      2023-12-11 [?] RSPM (R 4.3.0)
 P clue                   0.3-65     2023-09-23 [?] RSPM (R 4.3.0)
 P cluster                2.1.6      2023-12-01 [?] CRAN (R 4.3.2)
 P clustree             * 0.5.1      2023-11-05 [?] RSPM (R 4.3.0)
 P codetools              0.2-19     2023-02-01 [?] CRAN (R 4.2.2)
 P colorspace             2.1-0      2023-01-23 [?] RSPM (R 4.3.0)
 P ComplexHeatmap         2.18.0     2023-10-24 [?] Bioconductor
 P cowplot                1.1.3      2024-01-22 [?] RSPM (R 4.3.0)
 P crayon                 1.5.2      2022-09-29 [?] RSPM (R 4.3.0)
 P data.table             1.15.0     2024-01-30 [?] RSPM (R 4.3.0)
 P DBI                    1.2.1      2024-01-12 [?] RSPM (R 4.3.0)
 P DelayedArray           0.28.0     2023-10-24 [?] Bioconductor
 P deldir                 2.0-2      2023-11-23 [?] RSPM (R 4.3.0)
 P dendextend             1.17.1     2023-03-25 [?] RSPM (R 4.3.0)
 P digest                 0.6.34     2024-01-11 [?] RSPM (R 4.3.0)
 P dittoSeq             * 1.14.2     2024-02-09 [?] Bioconductor 3.18 (R 4.3.3)
 P doParallel             1.0.17     2022-02-07 [?] RSPM (R 4.3.0)
 P dplyr                * 1.1.4      2023-11-17 [?] RSPM (R 4.3.0)
 P dynamicTreeCut         1.63-1     2016-03-11 [?] RSPM (R 4.3.0)
 P edgeR                * 4.0.15     2024-02-11 [?] Bioconductor 3.18 (R 4.3.3)
 P ellipsis               0.3.2      2021-04-29 [?] RSPM (R 4.3.0)
 P evaluate               0.23       2023-11-01 [?] RSPM (R 4.3.0)
 P fansi                  1.0.6      2023-12-08 [?] RSPM (R 4.3.0)
 P farver                 2.1.1      2022-07-06 [?] RSPM (R 4.3.0)
 P fastcluster            1.2.6      2024-01-12 [?] RSPM (R 4.3.0)
 P fastmap                1.1.1      2023-02-24 [?] RSPM (R 4.3.0)
 P fitdistrplus           1.1-11     2023-04-25 [?] RSPM (R 4.3.0)
 P forcats              * 1.0.0      2023-01-29 [?] RSPM (R 4.3.0)
 P foreach                1.5.2      2022-02-02 [?] RSPM (R 4.3.0)
 P foreign                0.8-86     2023-11-28 [?] CRAN (R 4.3.2)
 P Formula                1.2-5      2023-02-24 [?] RSPM (R 4.3.0)
 P fs                     1.6.3      2023-07-20 [?] RSPM (R 4.3.0)
 P future                 1.33.1     2023-12-22 [?] RSPM (R 4.3.0)
 P future.apply           1.11.1     2023-12-21 [?] RSPM (R 4.3.0)
 P generics               0.1.3      2022-07-05 [?] RSPM (R 4.3.0)
 P GenomeInfoDb         * 1.38.6     2024-02-08 [?] Bioconductor 3.18 (R 4.3.3)
 P GenomeInfoDbData       1.2.11     2024-04-23 [?] Bioconductor
 P GenomicRanges        * 1.54.1     2023-10-29 [?] Bioconductor
 P GetoptLong             1.0.5      2020-12-15 [?] RSPM (R 4.3.0)
 P getPass                0.2-4      2023-12-10 [?] RSPM (R 4.3.0)
 P ggforce                0.4.2      2024-02-19 [?] RSPM (R 4.3.0)
 P ggplot2              * 3.5.0      2024-02-23 [?] RSPM (R 4.3.0)
 P ggraph               * 2.2.0      2024-02-27 [?] RSPM (R 4.3.0)
 P ggrepel                0.9.5      2024-01-10 [?] RSPM (R 4.3.0)
 P ggridges               0.5.6      2024-01-23 [?] RSPM (R 4.3.0)
 P git2r                  0.33.0     2023-11-26 [?] RSPM (R 4.3.0)
 P glmGamPoi            * 1.14.3     2024-02-11 [?] Bioconductor 3.18 (R 4.3.3)
 P GlobalOptions          0.1.2      2020-06-10 [?] RSPM (R 4.3.0)
 P globals                0.16.2     2022-11-21 [?] RSPM (R 4.3.0)
 P glue                 * 1.7.0      2024-01-09 [?] RSPM (R 4.3.0)
 P GO.db                  3.18.0     2024-04-23 [?] Bioconductor
 P goftest                1.2-3      2021-10-07 [?] RSPM (R 4.3.0)
 P graphlayouts           1.1.0      2024-01-19 [?] RSPM (R 4.3.0)
 P gridExtra              2.3        2017-09-09 [?] RSPM (R 4.3.0)
 P gtable                 0.3.4      2023-08-21 [?] RSPM (R 4.3.0)
 P here                 * 1.0.1      2020-12-13 [?] RSPM (R 4.3.0)
 P highr                  0.10       2022-12-22 [?] RSPM (R 4.3.0)
 P Hmisc                  5.1-1      2023-09-12 [?] RSPM (R 4.3.0)
 P hms                    1.1.3      2023-03-21 [?] RSPM (R 4.3.0)
 P htmlTable              2.4.2      2023-10-29 [?] RSPM (R 4.3.0)
 P htmltools              0.5.7      2023-11-03 [?] RSPM (R 4.3.0)
 P htmlwidgets            1.6.4      2023-12-06 [?] RSPM (R 4.3.0)
 P httpuv                 1.6.14     2024-01-26 [?] RSPM (R 4.3.0)
 P httr                   1.4.7      2023-08-15 [?] RSPM (R 4.3.0)
 P ica                    1.0-3      2022-07-08 [?] RSPM (R 4.3.0)
 P igraph                 2.0.1.1    2024-01-30 [?] RSPM (R 4.3.0)
 P impute                 1.76.0     2023-10-24 [?] Bioconductor
 P IRanges              * 2.36.0     2023-10-24 [?] Bioconductor
 P irlba                  2.3.5.1    2022-10-03 [?] RSPM (R 4.3.0)
 P iterators              1.0.14     2022-02-05 [?] RSPM (R 4.3.0)
 P jquerylib              0.1.4      2021-04-26 [?] RSPM (R 4.3.0)
 P jsonlite               1.8.8      2023-12-04 [?] RSPM (R 4.3.0)
 P KEGGREST               1.42.0     2023-10-24 [?] Bioconductor
 P KernSmooth             2.23-24    2024-05-17 [?] RSPM (R 4.3.0)
 P knitr                  1.45       2023-10-30 [?] RSPM (R 4.3.0)
 P labeling               0.4.3      2023-08-29 [?] RSPM (R 4.3.0)
 P later                  1.3.2      2023-12-06 [?] RSPM (R 4.3.0)
 P lattice                0.22-5     2023-10-24 [?] CRAN (R 4.3.1)
 P lazyeval               0.2.2      2019-03-15 [?] RSPM (R 4.3.0)
 P leiden                 0.4.3.1    2023-11-17 [?] RSPM (R 4.3.0)
 P lifecycle              1.0.4      2023-11-07 [?] RSPM (R 4.3.0)
 P limma                * 3.58.1     2023-10-31 [?] Bioconductor
 P listenv                0.9.1      2024-01-29 [?] RSPM (R 4.3.0)
 P lmtest                 0.9-40     2022-03-21 [?] RSPM (R 4.3.0)
 P locfit                 1.5-9.8    2023-06-11 [?] RSPM (R 4.3.0)
 P lubridate            * 1.9.3      2023-09-27 [?] RSPM (R 4.3.0)
 P magrittr               2.0.3      2022-03-30 [?] RSPM (R 4.3.0)
 P MASS                   7.3-60.0.1 2024-01-13 [?] RSPM (R 4.3.0)
 P Matrix                 1.6-5      2024-01-11 [?] CRAN (R 4.3.3)
 P MatrixGenerics       * 1.14.0     2023-10-24 [?] Bioconductor
 P matrixStats          * 1.2.0      2023-12-11 [?] RSPM (R 4.3.0)
 P memoise                2.0.1      2021-11-26 [?] RSPM (R 4.3.0)
 P mime                   0.12       2021-09-28 [?] RSPM (R 4.3.0)
 P miniUI                 0.1.1.1    2018-05-18 [?] RSPM (R 4.3.0)
 P munsell                0.5.0      2018-06-12 [?] RSPM (R 4.3.0)
 P nlme                   3.1-164    2023-11-27 [?] RSPM (R 4.3.0)
 P nnet                   7.3-19     2023-05-03 [?] CRAN (R 4.3.1)
 P org.Hs.eg.db         * 3.18.0     2024-04-23 [?] Bioconductor
 P paletteer            * 1.6.0      2024-01-21 [?] RSPM (R 4.3.0)
 P parallelly             1.37.0     2024-02-14 [?] RSPM (R 4.3.0)
 P patchwork            * 1.2.0      2024-01-08 [?] RSPM (R 4.3.0)
 P pbapply                1.7-2      2023-06-27 [?] RSPM (R 4.3.0)
 P pheatmap               1.0.12     2019-01-04 [?] RSPM (R 4.3.0)
 P pillar                 1.9.0      2023-03-22 [?] RSPM (R 4.3.0)
 P pkgconfig              2.0.3      2019-09-22 [?] RSPM (R 4.3.0)
 P plotly                 4.10.4     2024-01-13 [?] RSPM (R 4.3.0)
 P plyr                   1.8.9      2023-10-02 [?] RSPM (R 4.3.0)
 P png                    0.1-8      2022-11-29 [?] RSPM (R 4.3.0)
 P polyclip               1.10-6     2023-09-27 [?] RSPM (R 4.3.0)
 P preprocessCore         1.64.0     2023-10-24 [?] Bioconductor
 P prismatic              1.1.1      2022-08-15 [?] RSPM (R 4.3.0)
 P processx               3.8.3      2023-12-10 [?] RSPM (R 4.3.0)
 P progressr              0.14.0     2023-08-10 [?] RSPM (R 4.3.0)
 P promises               1.2.1      2023-08-10 [?] RSPM (R 4.3.0)
 P ps                     1.7.6      2024-01-18 [?] RSPM (R 4.3.0)
 P purrr                * 1.0.2      2023-08-10 [?] RSPM (R 4.3.0)
 P R6                     2.5.1      2021-08-19 [?] RSPM (R 4.3.0)
 P RANN                   2.6.1      2019-01-08 [?] RSPM (R 4.3.0)
 P RColorBrewer           1.1-3      2022-04-03 [?] RSPM (R 4.3.0)
 P Rcpp                   1.0.12     2024-01-09 [?] RSPM (R 4.3.0)
 P RcppAnnoy              0.0.22     2024-01-23 [?] RSPM (R 4.3.0)
 P RCurl                  1.98-1.14  2024-01-09 [?] RSPM (R 4.3.0)
 P readr                * 2.1.5      2024-01-10 [?] RSPM (R 4.3.0)
 P rematch2               2.1.2      2020-05-01 [?] RSPM (R 4.3.0)
   renv                   1.0.3      2023-09-19 [1] CRAN (R 4.3.3)
 P reshape2               1.4.4      2020-04-09 [?] RSPM (R 4.3.0)
 P reticulate             1.35.0     2024-01-31 [?] RSPM (R 4.3.0)
 P rjson                  0.2.21     2022-01-09 [?] RSPM (R 4.3.0)
 P rlang                  1.1.3      2024-01-10 [?] RSPM (R 4.3.0)
 P rmarkdown              2.25       2023-09-18 [?] RSPM (R 4.3.0)
 P ROCR                   1.0-11     2020-05-02 [?] RSPM (R 4.3.0)
 P rpart                  4.1.23     2023-12-05 [?] RSPM (R 4.3.0)
 P rprojroot              2.0.4      2023-11-05 [?] RSPM (R 4.3.0)
 P RSQLite                2.3.5      2024-01-21 [?] RSPM (R 4.3.0)
 P rstudioapi             0.15.0     2023-07-07 [?] RSPM (R 4.3.0)
 P Rtsne                  0.17       2023-12-07 [?] RSPM (R 4.3.0)
 P S4Arrays               1.2.0      2023-10-24 [?] Bioconductor
 P S4Vectors            * 0.40.2     2023-11-23 [?] Bioconductor 3.18 (R 4.3.3)
 P sass                   0.4.8      2023-12-06 [?] RSPM (R 4.3.0)
 P scales                 1.3.0      2023-11-28 [?] RSPM (R 4.3.0)
 P scattermore            1.2        2023-06-12 [?] RSPM (R 4.3.0)
   sctransform            0.4.1      2023-10-19 [1] RSPM (R 4.3.0)
 P sessioninfo            1.2.2      2021-12-06 [?] RSPM (R 4.3.0)
   Seurat               * 4.4.0      2024-04-25 [1] https://satijalab.r-universe.dev (R 4.3.3)
   SeuratObject         * 4.1.4      2024-04-25 [1] https://satijalab.r-universe.dev (R 4.3.3)
 P shape                  1.4.6      2021-05-19 [?] RSPM (R 4.3.0)
 P shiny                  1.8.0      2023-11-17 [?] RSPM (R 4.3.0)
 P SingleCellExperiment * 1.24.0     2023-10-24 [?] Bioconductor
 P sp                     2.1-3      2024-01-30 [?] RSPM (R 4.3.0)
 P SparseArray            1.2.4      2024-02-11 [?] Bioconductor 3.18 (R 4.3.3)
 P spatstat.data          3.0-4      2024-01-15 [?] RSPM (R 4.3.0)
 P spatstat.explore       3.2-6      2024-02-01 [?] RSPM (R 4.3.0)
 P spatstat.geom          3.2-8      2024-01-26 [?] RSPM (R 4.3.0)
 P spatstat.random        3.2-2      2023-11-29 [?] RSPM (R 4.3.0)
 P spatstat.sparse        3.0-3      2023-10-24 [?] RSPM (R 4.3.0)
 P spatstat.utils         3.0-4      2023-10-24 [?] RSPM (R 4.3.0)
 P speckle              * 1.2.0      2023-10-24 [?] Bioconductor
 P statmod                1.5.0      2023-01-06 [?] RSPM (R 4.3.0)
 P stringi                1.8.3      2023-12-11 [?] RSPM (R 4.3.0)
 P stringr              * 1.5.1      2023-11-14 [?] RSPM (R 4.3.0)
 P SummarizedExperiment * 1.32.0     2023-10-24 [?] Bioconductor
 P survival               3.7-0      2024-06-05 [?] RSPM (R 4.3.0)
 P tensor                 1.5        2012-05-05 [?] RSPM (R 4.3.0)
 P tibble               * 3.2.1      2023-03-20 [?] RSPM (R 4.3.0)
 P tidygraph              1.3.1      2024-01-30 [?] RSPM (R 4.3.0)
 P tidyHeatmap          * 1.8.1      2022-05-20 [?] RSPM (R 4.3.3)
 P tidyr                * 1.3.1      2024-01-24 [?] RSPM (R 4.3.0)
 P tidyselect             1.2.0      2022-10-10 [?] RSPM (R 4.3.0)
 P tidyverse            * 2.0.0      2023-02-22 [?] RSPM (R 4.3.0)
 P timechange             0.3.0      2024-01-18 [?] RSPM (R 4.3.0)
 P tweenr                 2.0.3      2024-02-26 [?] RSPM (R 4.3.0)
 P tzdb                   0.4.0      2023-05-12 [?] RSPM (R 4.3.0)
 P utf8                   1.2.4      2023-10-22 [?] RSPM (R 4.3.0)
 P uwot                   0.1.16     2023-06-29 [?] RSPM (R 4.3.0)
 P vctrs                  0.6.5      2023-12-01 [?] RSPM (R 4.3.0)
 P viridis                0.6.5      2024-01-29 [?] RSPM (R 4.3.0)
 P viridisLite            0.4.2      2023-05-02 [?] RSPM (R 4.3.0)
 P WGCNA                  1.72-5     2023-12-07 [?] RSPM (R 4.3.3)
 P whisker                0.4.1      2022-12-05 [?] RSPM (R 4.3.0)
 P withr                  3.0.0      2024-01-16 [?] RSPM (R 4.3.0)
 P workflowr            * 1.7.1      2023-08-23 [?] RSPM (R 4.3.0)
 P xfun                   0.42       2024-02-08 [?] RSPM (R 4.3.0)
 P xtable                 1.8-4      2019-04-21 [?] RSPM (R 4.3.0)
 P XVector                0.42.0     2023-10-24 [?] Bioconductor
 P yaml                   2.3.8      2023-12-11 [?] RSPM (R 4.3.0)
 P zlibbioc               1.48.0     2023-10-24 [?] Bioconductor
 P zoo                    1.8-12     2023-04-13 [?] RSPM (R 4.3.0)

 [1] /mnt/allandata/jovana_data/paed-inflammation-CITEseq/renv/library/R-4.3/x86_64-pc-linux-gnu
 [2] /home/jovana/.cache/R/renv/sandbox/R-4.3/x86_64-pc-linux-gnu/9a444a72

 P ── Loaded and on-disk path mismatch.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</details>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 22.04.4 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

time zone: Etc/UTC
tzcode source: system (glibc)

attached base packages:
[1] stats4    stats     graphics  grDevices datasets  utils     methods  
[8] base     

other attached packages:
 [1] here_1.0.1                  tidyHeatmap_1.8.1          
 [3] paletteer_1.6.0             patchwork_1.2.0            
 [5] speckle_1.2.0               glue_1.7.0                 
 [7] org.Hs.eg.db_3.18.0         AnnotationDbi_1.64.1       
 [9] clustree_0.5.1              ggraph_2.2.0               
[11] dittoSeq_1.14.2             glmGamPoi_1.14.3           
[13] SeuratObject_4.1.4          Seurat_4.4.0               
[15] lubridate_1.9.3             forcats_1.0.0              
[17] stringr_1.5.1               dplyr_1.1.4                
[19] purrr_1.0.2                 readr_2.1.5                
[21] tidyr_1.3.1                 tibble_3.2.1               
[23] ggplot2_3.5.0               tidyverse_2.0.0            
[25] edgeR_4.0.15                limma_3.58.1               
[27] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0
[29] Biobase_2.62.0              GenomicRanges_1.54.1       
[31] GenomeInfoDb_1.38.6         IRanges_2.36.0             
[33] S4Vectors_0.40.2            BiocGenerics_0.48.1        
[35] MatrixGenerics_1.14.0       matrixStats_1.2.0          
[37] workflowr_1.7.1            

loaded via a namespace (and not attached):
  [1] fs_1.6.3                spatstat.sparse_3.0-3   bitops_1.0-7           
  [4] httr_1.4.7              RColorBrewer_1.1-3      doParallel_1.0.17      
  [7] dynamicTreeCut_1.63-1   backports_1.4.1         tools_4.3.3            
 [10] sctransform_0.4.1       utf8_1.2.4              R6_2.5.1               
 [13] lazyeval_0.2.2          uwot_0.1.16             GetoptLong_1.0.5       
 [16] withr_3.0.0             sp_2.1-3                gridExtra_2.3          
 [19] preprocessCore_1.64.0   progressr_0.14.0        WGCNA_1.72-5           
 [22] cli_3.6.2               spatstat.explore_3.2-6  labeling_0.4.3         
 [25] sass_0.4.8              prismatic_1.1.1         spatstat.data_3.0-4    
 [28] ggridges_0.5.6          pbapply_1.7-2           foreign_0.8-86         
 [31] sessioninfo_1.2.2       parallelly_1.37.0       impute_1.76.0          
 [34] rstudioapi_0.15.0       RSQLite_2.3.5           generics_0.1.3         
 [37] shape_1.4.6             ica_1.0-3               spatstat.random_3.2-2  
 [40] dendextend_1.17.1       GO.db_3.18.0            Matrix_1.6-5           
 [43] fansi_1.0.6             abind_1.4-5             lifecycle_1.0.4        
 [46] whisker_0.4.1           yaml_2.3.8              SparseArray_1.2.4      
 [49] Rtsne_0.17              grid_4.3.3              blob_1.2.4             
 [52] promises_1.2.1          crayon_1.5.2            miniUI_0.1.1.1         
 [55] lattice_0.22-5          cowplot_1.1.3           KEGGREST_1.42.0        
 [58] pillar_1.9.0            knitr_1.45              ComplexHeatmap_2.18.0  
 [61] rjson_0.2.21            future.apply_1.11.1     codetools_0.2-19       
 [64] leiden_0.4.3.1          getPass_0.2-4           data.table_1.15.0      
 [67] vctrs_0.6.5             png_0.1-8               gtable_0.3.4           
 [70] rematch2_2.1.2          cachem_1.0.8            xfun_0.42              
 [73] S4Arrays_1.2.0          mime_0.12               tidygraph_1.3.1        
 [76] survival_3.7-0          pheatmap_1.0.12         iterators_1.0.14       
 [79] statmod_1.5.0           ellipsis_0.3.2          fitdistrplus_1.1-11    
 [82] ROCR_1.0-11             nlme_3.1-164            bit64_4.0.5            
 [85] RcppAnnoy_0.0.22        rprojroot_2.0.4         bslib_0.6.1            
 [88] irlba_2.3.5.1           rpart_4.1.23            KernSmooth_2.23-24     
 [91] Hmisc_5.1-1             colorspace_2.1-0        DBI_1.2.1              
 [94] nnet_7.3-19             tidyselect_1.2.0        processx_3.8.3         
 [97] bit_4.0.5               compiler_4.3.3          git2r_0.33.0           
[100] htmlTable_2.4.2         DelayedArray_0.28.0     plotly_4.10.4          
[103] checkmate_2.3.1         scales_1.3.0            lmtest_0.9-40          
[106] callr_3.7.3             digest_0.6.34           goftest_1.2-3          
[109] spatstat.utils_3.0-4    rmarkdown_2.25          XVector_0.42.0         
[112] base64enc_0.1-3         htmltools_0.5.7         pkgconfig_2.0.3        
[115] highr_0.10              fastmap_1.1.1           rlang_1.1.3            
[118] GlobalOptions_0.1.2     htmlwidgets_1.6.4       shiny_1.8.0            
[121] farver_2.1.1            jquerylib_0.1.4         zoo_1.8-12             
[124] jsonlite_1.8.8          RCurl_1.98-1.14         magrittr_2.0.3         
[127] Formula_1.2-5           GenomeInfoDbData_1.2.11 munsell_0.5.0          
[130] Rcpp_1.0.12             viridis_0.6.5           reticulate_1.35.0      
[133] stringi_1.8.3           zlibbioc_1.48.0         MASS_7.3-60.0.1        
[136] plyr_1.8.9              parallel_4.3.3          listenv_0.9.1          
[139] ggrepel_0.9.5           deldir_2.0-2            Biostrings_2.70.2      
[142] graphlayouts_1.1.0      splines_4.3.3           tensor_1.5             
[145] hms_1.1.3               circlize_0.4.15         locfit_1.5-9.8         
[148] ps_1.7.6                fastcluster_1.2.6       igraph_2.0.1.1         
[151] spatstat.geom_3.2-8     reshape2_1.4.4          evaluate_0.23          
[154] renv_1.0.3              BiocManager_1.30.22     tzdb_0.4.0             
[157] foreach_1.5.2           tweenr_2.0.3            httpuv_1.6.14          
[160] RANN_2.6.1              polyclip_1.10-6         future_1.33.1          
[163] clue_0.3-65             scattermore_1.2         ggforce_0.4.2          
[166] xtable_1.8-4            later_1.3.2             viridisLite_0.4.2      
[169] memoise_2.0.1           cluster_2.1.6           timechange_0.3.0       
[172] globals_0.16.2         </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
