---
title: "Inflammation of Paediatric Pulmonary Diseases"
description: |
author:
  - name: Jovana Maksimovic and George Howitt
date: "`r Sys.Date()`"
site: workflowr::wflow_site
output:
  html_document: 
    theme: cosmo
---

```{r, echo = FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, number_sections = FALSE)
```

Follow the links below to view the different parts of the analysis. 


# Abstract {-}

# Authors {-}
 
# Analysis Overview {-}

1. Remove empty droplets and demultiplex
    i) [Batch 0](01.0_preprocess_batch0.html)
    ii) [Batch 1](01.1_preprocess_batch1.html)
    iii) [Batch 2](01.2_preprocess_batch2.html)
    iv) [Batch 3](01.3_preprocess_batch3.html)
    v) [Batch 4](01.4_preprocess_batch4.html)
    vi) [Batch 5](01.5_preprocess_batch5.html)
    vii) [Batch 6](01.6_preprocess_batch6.html)

2. [Quality control](02.0_quality_control.html)

3. [Identify doublets](03.0_identify_doublets.html)

4. [Filter doublets](04.0_filter_doublets.html)

5. [Remove ambient contamination](05.0_remove_ambient.html)

6. Annotate using Human Lung Cell Atlas v2.0
    i)    [Without ambient removal](06.0_azimuth_annotation.html)
    ii)    [With ambient removal](06.1_azimuth_annotation_decontx.html)

7. [Cluster T/NK cells](07.1_integrate_cluster_t_cells_decontx.html)

8. [Cluster rare cells](08.1_integrate_cluster_other_cells_decontx.html)

9. [Cluster macrophage cells](09.0_integrate_cluster_macro_cells.html)

10. [Annotate macrophage cells](10.0_manual_annotations_macro_cells.html) 

11. [Annotate T/NK cells](11.0_manual_annotations_t_cells_decontx.html)  

12. [Annotate rare cells](12.0_manual_annotations_other_cells.html) 

<!-- 13. Differential expression analysis within macrophage sub-types -->
<!--     i)    [Alveolar macro. CF modifiers & severity](13.0_DGE_analysis_macro-alveolar_cells_CF-only-samples.html)  -->
<!--     ii)    [Alveolar macro. CF$\pm$modifiers vs non-CF control](13.1_DGE_analysis_macro-alveolar_cells_CF-vs-control-samples.html) -->
<!--     iii)    [Monocyte-derived macro. CF modifiers & severity](13.2_DGE_analysis_macro-monocyte-derived_CF-only-samples.html)  -->
<!--     iv)    [Monocyte-derived macro. CF$\pm$modifiers vs non-CF control](13.3_DGE_analysis_macro-monocyte-derived_CF-vs-control-samples.html) -->
<!--     v)    [Macro. CCL CF modifiers & severity](13.4_DGE_analysis_macro-CCL_CF-only-samples.html)  -->
<!--     vi)    [Macro. CCL CF$\pm$modifiers vs non-CF control](13.5_DGE_analysis_macro-CCL_CF-vs-control-samples.html)  -->
<!--     vii)    [Macro. IFI27 CF modifiers & severity](13.6_DGE_analysis_macro-IFI27_CF-only-samples.html)  -->
<!--     vii)    [Macro. IFI27 CF$\pm$modifiers vs non-CF control](13.7_DGE_analysis_macro-IFI27_CF-vs-control-samples.html)  -->
<!--     ix)    [Macro. lipid CF modifiers & severity](13.8_DGE_analysis_macro-lipid_CF-only-samples.html)  -->
<!--     x)    [Macro. lipid CF$\pm$modifiers vs non-CF control](13.9_DGE_analysis_macro-lipid_CF-vs-control-samples.html) -->
<!--     xi)    [Macro. APOC2+ CF modifiers & severity](13.10_DGE_analysis_macro-APOC2+_CF-only-samples.html)  -->
<!--     xii)    [Macro. APOC2+ CF$\pm$modifiers vs non-CF control](13.11_DGE_analysis_macro-APOC2+_CF-vs-control-samples.html) -->
<!--     xiii)    [Macro. proliferating CF modifiers & severity](13.12_DGE_analysis_macro-proliferating_CF-only-samples.html)  -->
<!--     xiv)    [Macro. proliferating CF$\pm$modifiers vs non-CF control](13.13_DGE_analysis_macro-proliferating_CF-vs-control-samples.html) -->
13. Differential expression analysis of macrophage
    i) [Macrophages](13.0_DGE_analysis_macrophages.html)
    ii) [Alveolar macrophages](13.1_DGE_analysis_macro-alveolar.html)
    iii) [APOC2+ macrophages](13.2_DGE_analysis_macro-APOC2+.html)

14. Analyse cell types proportions
    i) [Annotation level 1](14.0_proportions_analysis_ann_level_1.html) 
    ii) [Annotation level 3, non macro. cells](14.1_proportions_analysis_ann_level_3_non-macrophages.html)
    iii) [Annotation level 3, macro. cells](14.2_proportions_analysis_ann_level_3_macrophages.html)


15. [Figure 1](15.0_Figure_1.html)


16. [Figure 2](16.0_Figure_2.html)


17.0 [S. Figure ADTs](17.0_Supplementary_Figure_ADTs.html)    

    
To ensure reproducibility, I had to install these versions of the following packages specifically: Seurat_4.4.0,  SeuratObject_4.1.4, SeuratData_0.2.2 (very specifically this commit "satijalab/seurat-data@d6a8ce61ccb21a3b204f194d07009772c822791d", Azimuth_0.4.6.

As per this issue, https://github.com/satijalab/seurat-object/issues/165, if there is an error running sctransform, remove all relevant packages (and purge if using renv) and then install using the following method exactly, to build from source.

if (!requireNamespace("remotes", quietly = TRUE)) {
  install.packages("remotes")
}
options(repos = c("https://satijalab.r-universe.dev", getOption("repos")))
remotes::install_version("SeuratObject", "4.1.4")
remotes::install_version("Seurat", "4.4.0", upgrade = FALSE) # remotes will try to upgrade SeuratObject to v5, we need to tell it no


# Licenses {-}

The code in this analysis is covered by the [MIT license][mit] and the written
content on this website is covered by a [Creative Commons CC-BY][cc] license.


# Citations {-}



# Version Information  {-}

**R version**: `r R.version.string`

**Bioconductor version**: `r BiocManager::version()`


[mit]: https://choosealicense.com/licenses/mit/ "MIT License"
[cc]: https://choosealicense.com/licenses/cc-by-4.0/ "CC-BY License"

